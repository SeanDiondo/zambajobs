{"file_contents":{"client/src/pages/job-seeker-dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { \n  Briefcase, \n  FileText, \n  TrendingUp, \n  Eye, \n  Sparkles, \n  User,\n  GraduationCap,\n  Award,\n  Link as LinkIcon,\n  Download,\n  Upload\n} from \"lucide-react\";\nimport type { Application, JobSeekerProfile } from \"@shared/schema\";\n\n// Extended Job type with AI matching data\ninterface RecommendedJob {\n  id: string;\n  employerId: string;\n  title: string;\n  description: string;\n  requirements: string[] | null;\n  responsibilities: string[] | null;\n  benefits: string[] | null;\n  skills: string[] | null;\n  location: string | null;\n  jobType: string;\n  category: string | null;\n  salaryMin: number | null;\n  salaryMax: number | null;\n  isActive: boolean;\n  isFlagged: boolean;\n  createdAt: Date;\n  requirementDocumentUrl: string | null;\n  aiMatchScore?: number;\n  aiMatchReasoning?: string;\n}\nimport { useAuth } from \"@/contexts/auth-context\";\n\nexport default function JobSeekerDashboard() {\n  const { user } = useAuth();\n  const { data: profile, isLoading: profileLoading } = useQuery<JobSeekerProfile>({\n    queryKey: [\"/api/profile\"],\n  });\n\n  const { data: applications, isLoading: applicationsLoading } = useQuery<Application[]>({\n    queryKey: [\"/api/applications\"],\n  });\n\n  const { data: recommendedJobs, isLoading: jobsLoading } = useQuery<RecommendedJob[]>({\n    queryKey: [\"/api/jobs/recommended\"],\n  });\n\n  const profileCompletion = calculateProfileCompletion(profile);\n\n  return (\n    <div className=\"space-y-6\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Welcome back!</h1>\n          <p className=\"text-muted-foreground\">Here's what's happening with your job search</p>\n        </div>\n\n        {/* Profile Overview Card */}\n        <Card data-testid=\"card-profile-overview\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5\" />\n              My Profile\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-col sm:flex-row gap-6 items-start\">\n              {/* Profile Picture */}\n              <div className=\"flex flex-col items-center gap-2\">\n                <Avatar className=\"h-24 w-24\">\n                  {profile?.profileImage ? (\n                    <AvatarImage \n                      src={`/objects${profile.profileImage}`}\n                      alt={`${user?.firstName} ${user?.lastName}`}\n                      data-testid=\"dashboard-profile-image\"\n                    />\n                  ) : (\n                    <AvatarFallback>\n                      <User className=\"h-12 w-12 text-muted-foreground\" />\n                    </AvatarFallback>\n                  )}\n                </Avatar>\n                {!profile?.profileImage && (\n                  <Link href=\"/profile\">\n                    <Button variant=\"outline\" size=\"sm\" data-testid=\"button-upload-photo\">\n                      <Upload className=\"h-3 w-3 mr-2\" />\n                      Add Photo\n                    </Button>\n                  </Link>\n                )}\n              </div>\n\n              {/* Profile Info */}\n              <div className=\"flex-1 space-y-3\">\n                <div>\n                  <h3 className=\"font-semibold text-lg\" data-testid=\"dashboard-user-name\">\n                    {user?.firstName} {user?.lastName}\n                  </h3>\n                  {profile?.headline && (\n                    <p className=\"text-sm text-muted-foreground\" data-testid=\"dashboard-headline\">\n                      {profile.headline}\n                    </p>\n                  )}\n                </div>\n\n                {/* Resume Section */}\n                <div className=\"space-y-2\">\n                  <h4 className=\"text-sm font-medium\">Resume</h4>\n                  {profile?.resumeUrl ? (\n                    <div className=\"flex items-center gap-2 p-3 bg-muted rounded-md\">\n                      <FileText className=\"h-4 w-4 text-primary\" />\n                      <span className=\"text-sm flex-1\">Resume uploaded</span>\n                      <a \n                        href={`/objects${profile.resumeUrl}`} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        data-testid=\"link-dashboard-resume\"\n                      >\n                        <Button variant=\"outline\" size=\"sm\">\n                          <Download className=\"h-3 w-3 mr-2\" />\n                          View\n                        </Button>\n                      </a>\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center gap-2 p-3 bg-muted/50 rounded-md border border-dashed\">\n                      <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                      <span className=\"text-sm flex-1 text-muted-foreground\">No resume uploaded</span>\n                      <Link href=\"/profile\">\n                        <Button variant=\"outline\" size=\"sm\" data-testid=\"button-upload-resume\">\n                          <Upload className=\"h-3 w-3 mr-2\" />\n                          Upload\n                        </Button>\n                      </Link>\n                    </div>\n                  )}\n                </div>\n\n                <Link href=\"/profile\">\n                  <Button variant=\"outline\" size=\"sm\" data-testid=\"button-edit-profile\">\n                    Edit Profile\n                  </Button>\n                </Link>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid gap-6 lg:grid-cols-3\">\n          {/* Sidebar */}\n          <div className=\"space-y-6\">\n            {/* Profile Completion */}\n            <Card data-testid=\"card-profile-completion\">\n              <CardHeader className=\"pb-4\">\n                <CardTitle className=\"text-lg\">Profile Completion</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className=\"text-sm font-medium\">{profileCompletion}%</span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {profileCompletion === 100 ? \"Complete!\" : \"Keep going\"}\n                    </span>\n                  </div>\n                  <Progress value={profileCompletion} />\n                </div>\n                {profileCompletion < 100 && (\n                  <div className=\"space-y-2\">\n                    <p className=\"text-sm text-muted-foreground\">Complete your profile to:</p>\n                    <ul className=\"space-y-1 text-sm\">\n                      <li className=\"flex items-center gap-2\">\n                        <Sparkles className=\"h-3 w-3 text-primary\" />\n                        Get better job matches\n                      </li>\n                      <li className=\"flex items-center gap-2\">\n                        <Eye className=\"h-3 w-3 text-primary\" />\n                        Increase visibility\n                      </li>\n                      <li className=\"flex items-center gap-2\">\n                        <TrendingUp className=\"h-3 w-3 text-primary\" />\n                        Stand out to employers\n                      </li>\n                    </ul>\n                    <Link href=\"/profile\">\n                      <Button className=\"w-full mt-2\" size=\"sm\" data-testid=\"button-complete-profile\">\n                        Complete Profile\n                      </Button>\n                    </Link>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Quick Stats */}\n            <Card>\n              <CardHeader className=\"pb-4\">\n                <CardTitle className=\"text-lg\">Quick Stats</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                    <span>Applications</span>\n                  </div>\n                  <span className=\"text-sm font-semibold\" data-testid=\"stat-applications\">\n                    {applications?.length || 0}\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Sparkles className=\"h-4 w-4 text-muted-foreground\" />\n                    <span>Recommendations</span>\n                  </div>\n                  <span className=\"text-sm font-semibold\" data-testid=\"stat-recommendations\">\n                    {recommendedJobs?.length || 0}\n                  </span>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Main Content */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            <Tabs defaultValue=\"recommended\" className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"recommended\" data-testid=\"tab-recommended\">\n                  Recommended for You\n                </TabsTrigger>\n                <TabsTrigger value=\"applications\" data-testid=\"tab-applications\">\n                  My Applications\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"recommended\" className=\"space-y-4 mt-6\">\n                {jobsLoading ? (\n                  <div className=\"space-y-4\">\n                    {[1, 2, 3].map((i) => (\n                      <Card key={i}>\n                        <CardHeader>\n                          <Skeleton className=\"h-6 w-3/4\" />\n                          <Skeleton className=\"h-4 w-1/2\" />\n                        </CardHeader>\n                      </Card>\n                    ))}\n                  </div>\n                ) : recommendedJobs && recommendedJobs.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <p className=\"text-sm text-muted-foreground\" data-testid=\"text-recommendations-count\">\n                        Found {recommendedJobs.length} job{recommendedJobs.length !== 1 ? 's' : ''} matching your profile\n                      </p>\n                    </div>\n                    {recommendedJobs.map((job) => (\n                      <Card key={job.id} className=\"hover-elevate\" data-testid={`card-recommended-job-${job.id}`}>\n                        <CardHeader>\n                          <div className=\"flex items-start justify-between gap-4\">\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center flex-wrap gap-2 mb-1\">\n                                <CardTitle>{job.title}</CardTitle>\n                                {job.aiMatchScore !== undefined && (\n                                  <Badge \n                                    variant={job.aiMatchScore >= 70 ? \"default\" : job.aiMatchScore >= 50 ? \"secondary\" : \"outline\"} \n                                    className=\"gap-1\"\n                                    data-testid={`badge-match-score-${job.id}`}\n                                  >\n                                    <Sparkles className=\"h-3 w-3\" />\n                                    {job.aiMatchScore}% Match\n                                  </Badge>\n                                )}\n                              </div>\n                              <CardDescription>{job.location}</CardDescription>\n                            </div>\n                          </div>\n                          \n                          {job.aiMatchReasoning && (\n                            <div className=\"mt-3 p-3 bg-muted/50 rounded-md border-l-4 border-primary\" data-testid={`text-match-reasoning-${job.id}`}>\n                              <div className=\"flex items-start gap-2\">\n                                <Sparkles className=\"h-4 w-4 text-primary mt-0.5 shrink-0\" />\n                                <p className=\"text-sm text-muted-foreground italic\">\n                                  {job.aiMatchReasoning}\n                                </p>\n                              </div>\n                            </div>\n                          )}\n                          \n                          <p className=\"text-sm text-muted-foreground line-clamp-2 mt-2\">\n                            {job.description}\n                          </p>\n                        </CardHeader>\n                        <CardContent className=\"pt-0 flex flex-wrap gap-2\">\n                          <Badge variant=\"secondary\">{job.jobType.replace('_', ' ')}</Badge>\n                          {job.category && <Badge variant=\"outline\">{job.category}</Badge>}\n                        </CardContent>\n                        <CardContent className=\"pt-0\">\n                          <Link href={`/jobs/${job.id}`}>\n                            <Button data-testid={`button-view-details-${job.id}`}>View Details</Button>\n                          </Link>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"flex min-h-[300px] flex-col items-center justify-center text-center p-8\">\n                    <Sparkles className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n                    <h3 className=\"text-lg font-semibold mb-2\">No recommendations yet</h3>\n                    <p className=\"text-sm text-muted-foreground max-w-md mb-4\">\n                      Complete your profile to get personalized job recommendations\n                    </p>\n                    <Link href=\"/profile\">\n                      <Button>Complete Profile</Button>\n                    </Link>\n                  </div>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"applications\" className=\"space-y-4 mt-6\">\n                {applicationsLoading ? (\n                  <div className=\"space-y-4\">\n                    {[1, 2, 3].map((i) => (\n                      <Card key={i}>\n                        <CardHeader>\n                          <Skeleton className=\"h-6 w-3/4\" />\n                          <Skeleton className=\"h-4 w-1/2\" />\n                        </CardHeader>\n                      </Card>\n                    ))}\n                  </div>\n                ) : applications && applications.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    {applications.map((application) => (\n                      <Card key={application.id} className=\"hover-elevate\" data-testid={`card-application-${application.id}`}>\n                        <CardHeader>\n                          <div className=\"flex items-start justify-between gap-4\">\n                            <div className=\"flex-1\">\n                              <CardTitle className=\"line-clamp-1\">Application #{application.id.slice(0, 8)}</CardTitle>\n                              <CardDescription>\n                                Applied {new Date(application.createdAt).toLocaleDateString()}\n                              </CardDescription>\n                            </div>\n                            <Badge \n                              variant={\n                                application.status === \"accepted\" ? \"default\" :\n                                application.status === \"rejected\" ? \"destructive\" :\n                                application.status === \"reviewing\" ? \"secondary\" :\n                                \"outline\"\n                              }\n                              data-testid={`badge-status-${application.id}`}\n                            >\n                              {application.status}\n                            </Badge>\n                          </div>\n                        </CardHeader>\n                      </Card>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"flex min-h-[300px] flex-col items-center justify-center text-center p-8\">\n                    <FileText className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n                    <h3 className=\"text-lg font-semibold mb-2\">No applications yet</h3>\n                    <p className=\"text-sm text-muted-foreground max-w-md mb-4\">\n                      Start applying to jobs to track your applications here\n                    </p>\n                    <Link href=\"/jobs\">\n                      <Button>Browse Jobs</Button>\n                    </Link>\n                  </div>\n                )}\n              </TabsContent>\n            </Tabs>\n          </div>\n        </div>\n    </div>\n  );\n}\n\nfunction calculateProfileCompletion(profile?: JobSeekerProfile): number {\n  if (!profile) return 0;\n  \n  let completed = 0;\n  const total = 7;\n  \n  if (profile.headline) completed++;\n  if (profile.bio) completed++;\n  if (profile.skills && profile.skills.length > 0) completed++;\n  if (profile.resumeUrl) completed++;\n  if (profile.linkedinUrl) completed++;\n  if (profile.location) completed++;\n  if (profile.phoneNumber) completed++;\n  \n  return Math.round((completed / total) * 100);\n}\n","path":null,"size_bytes":17804,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/pages/forgot-password.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Briefcase, Mail, ArrowLeft } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst forgotPasswordSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n});\n\ntype ForgotPasswordForm = z.infer<typeof forgotPasswordSchema>;\n\nexport default function ForgotPassword() {\n  const { toast } = useToast();\n  const [emailSent, setEmailSent] = useState(false);\n\n  const form = useForm<ForgotPasswordForm>({\n    resolver: zodResolver(forgotPasswordSchema),\n    defaultValues: {\n      email: \"\",\n    },\n  });\n\n  const forgotPasswordMutation = useMutation({\n    mutationFn: async (data: ForgotPasswordForm) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/forgot-password\", data);\n      return response;\n    },\n    onSuccess: () => {\n      setEmailSent(true);\n      toast({\n        title: \"Email sent!\",\n        description: \"Please check your email for password reset instructions.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to send password reset email\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ForgotPasswordForm) => {\n    forgotPasswordMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-accent/5 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-md bg-primary/10\">\n            <Briefcase className=\"h-6 w-6 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl font-bold\">Forgot Password</CardTitle>\n          <CardDescription>\n            Enter your email address and we'll send you a link to reset your password\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {emailSent ? (\n            <Alert>\n              <Mail className=\"h-4 w-4\" />\n              <AlertDescription>\n                We've sent a password reset link to your email address. Please check your inbox and follow the instructions.\n              </AlertDescription>\n            </Alert>\n          ) : (\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <Mail className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input\n                            {...field}\n                            type=\"email\"\n                            placeholder=\"you@example.com\"\n                            className=\"pl-10\"\n                            data-testid=\"input-email\"\n                          />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={forgotPasswordMutation.isPending}\n                  data-testid=\"button-submit-forgot-password\"\n                >\n                  {forgotPasswordMutation.isPending ? \"Sending...\" : \"Send Reset Link\"}\n                </Button>\n              </form>\n            </Form>\n          )}\n\n          <div className=\"text-center\">\n            <Link href=\"/login\">\n              <Button variant=\"ghost\" className=\"gap-2\" data-testid=\"link-back-to-login\">\n                <ArrowLeft className=\"h-4 w-4\" />\n                Back to login\n              </Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":4715,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/pages/register.tsx":{"content":"import { Link, useLocation, useSearch } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Briefcase, Mail, Lock, User, Chrome, UserCircle, FileText } from \"lucide-react\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst registerSchema = z.object({\n  firstName: z.string().min(1, \"First name is required\"),\n  lastName: z.string().min(1, \"Last name is required\"),\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n  confirmPassword: z.string(),\n  role: z.enum([\"job_seeker\", \"employer\"]),\n  agreeToTerms: z.boolean().refine((val) => val === true, {\n    message: \"You must agree to the terms to continue\",\n  }),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\nconst JOB_SEEKER_AGREEMENT = `ZambaJobs Job Seeker Sign-Up Agreement\n\nBy creating a Job Seeker account on ZambaJobs, you agree to provide true and accurate personal information, including genuine educational, employment, and identification documents, and to use your real identity without impersonation. Any false or misleading information may result in account suspension or deletion. You also agree to conduct yourself responsibly on the platform by avoiding the upload of falsified documents, refraining from harassment, and not applying to job posts with fraudulent intent or using the platform for illegal, harmful, or inappropriate purposes.\n\nYou understand that ZambaJobs may request additional documents for verification and that any files you upload may undergo automated and manual fraud checks. Your account may be restricted until verification is completed. As a Job Seeker, you agree to communicate professionally with employers, avoid scams, offensive messages, and spam, and comply with employer requirements during the hiring process.\n\nYou are responsible for keeping your login credentials secure, reporting any suspicious activity immediately, and ensuring that your device is safe and protected while accessing your account. You acknowledge that ZambaJobs does not guarantee employment, that employers make the final hiring decisions, and that you should always use your own judgment when interacting with employers.\n\nBy signing up, you confirm that you understand and accept this Job Seeker Agreement and agree to abide by the ZambaJobs Terms of Service and Privacy Policy.`;\n\nconst EMPLOYER_AGREEMENT = `ZambaJobs Employer Sign-Up Agreement\n\nBy creating an Employer account on ZambaJobs, you agree to provide accurate and truthful company information, including valid business details, contact information, and official credentials. You also commit to uploading legitimate company documents required for verification. Any form of misrepresentation, including falsified documents or deceptive company information, may result in account suspension or removal from the platform.\n\nAs an Employer, you agree to post only legitimate and clearly described job openings that provide truthful details such as job responsibilities, salary ranges (if applicable), and job locations. You further agree not to post misleading, inappropriate, illegal, or scam-related job listings. ZambaJobs reserves the right to review, edit, or remove job posts that violate platform guidelines.\n\nYou understand that ZambaJobs may require additional documentation to verify your company's authenticity and that your uploaded documents may undergo automated and manual fraud checks. Your account may be limited, restricted, or disabled if verification fails or appears suspicious.\n\nYou agree to communicate professionally with job seekers and avoid collecting unnecessary or overly sensitive personal information. You also agree not to subject applicants to unsafe, deceptive, or discriminatory hiring practices. Any form of harassment, exploitation, or scam-related behavior may result in the permanent removal of your employer account.\n\nYou are responsible for securing your login credentials, ensuring that only authorized personnel have access to your account, and reporting any suspicious user activity or fraudulent applicants to ZambaJobs immediately. You acknowledge that ZambaJobs is not liable for your hiring decisions and that all agreements or arrangements made between you and job seekers are solely your responsibility.\n\nBy signing up, you confirm that you understand and accept this Employer Agreement and agree to comply with all ZambaJobs platform rules, Terms of Service, and Privacy Policy.`;\n\ntype RegisterForm = z.infer<typeof registerSchema>;\n\nexport default function Register() {\n  const [, setLocation] = useLocation();\n  const searchParams = useSearch();\n  const { toast } = useToast();\n  const [agreementDialogOpen, setAgreementDialogOpen] = useState(false);\n  \n  const urlParams = new URLSearchParams(searchParams);\n  const roleFromUrl = urlParams.get(\"role\") as \"job_seeker\" | \"employer\" | null;\n  const emailFromUrl = urlParams.get(\"email\") || \"\";\n  const firstNameFromUrl = urlParams.get(\"firstName\") || \"\";\n  const lastNameFromUrl = urlParams.get(\"lastName\") || \"\";\n  const fromGoogle = urlParams.get(\"fromGoogle\") === \"true\";\n\n  const form = useForm<RegisterForm>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      firstName: firstNameFromUrl,\n      lastName: lastNameFromUrl,\n      email: emailFromUrl,\n      password: \"\",\n      confirmPassword: \"\",\n      role: roleFromUrl || \"job_seeker\",\n      agreeToTerms: false,\n    },\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: async (data: RegisterForm) => {\n      const { confirmPassword, ...registerData } = data;\n      const response = await apiRequest(\"POST\", \"/api/auth/register\", registerData);\n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      if (data.requiresOTP && data.email) {\n        sessionStorage.setItem(\"pendingVerificationEmail\", data.email);\n        toast({\n          title: \"Account created!\",\n          description: \"Please check your email for your verification code.\",\n        });\n        setLocation(\"/verify-otp\");\n      } else {\n        toast({\n          title: \"Account created!\",\n          description: \"Please check your email.\",\n        });\n        setLocation(\"/login\");\n      }\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Registration failed\",\n        description: error.message || \"An error occurred during registration\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: RegisterForm) => {\n    registerMutation.mutate(data);\n  };\n\n  const handleGoogleSignup = () => {\n    window.location.href = \"/api/auth/google\";\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-accent/5 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-md bg-primary/10\">\n            <Briefcase className=\"h-6 w-6 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl font-bold\">Create an account</CardTitle>\n          <CardDescription>\n            {fromGoogle ? \"Complete your registration to continue\" : \"Join ZambaJobs and start your journey\"}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Button\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={handleGoogleSignup}\n            data-testid=\"button-google-signup\"\n          >\n            <Chrome className=\"mr-2 h-4 w-4\" />\n            Continue with Google\n          </Button>\n\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <Separator />\n            </div>\n            <div className=\"relative flex justify-center text-xs uppercase\">\n              <span className=\"bg-card px-2 text-muted-foreground\">Or continue with</span>\n            </div>\n          </div>\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"firstName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>First Name</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <User className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input\n                            {...field}\n                            placeholder=\"John\"\n                            className=\"pl-10\"\n                            data-testid=\"input-first-name\"\n                          />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"lastName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Last Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          placeholder=\"Doe\"\n                          data-testid=\"input-last-name\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Mail className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                        <Input\n                          {...field}\n                          type=\"email\"\n                          placeholder=\"you@example.com\"\n                          className=\"pl-10\"\n                          data-testid=\"input-email\"\n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"role\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>I am a</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-role\">\n                          <SelectValue placeholder=\"Select your role\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"job_seeker\" data-testid=\"option-job-seeker\">\n                          <div className=\"flex items-center gap-2\">\n                            <UserCircle className=\"h-4 w-4\" />\n                            Job Seeker\n                          </div>\n                        </SelectItem>\n                        <SelectItem value=\"employer\" data-testid=\"option-employer\">\n                          <div className=\"flex items-center gap-2\">\n                            <Briefcase className=\"h-4 w-4\" />\n                            Employer\n                          </div>\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Lock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                        <Input\n                          {...field}\n                          type=\"password\"\n                          placeholder=\"••••••••\"\n                          className=\"pl-10\"\n                          data-testid=\"input-password\"\n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Confirm Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Lock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                        <Input\n                          {...field}\n                          type=\"password\"\n                          placeholder=\"••••••••\"\n                          className=\"pl-10\"\n                          data-testid=\"input-confirm-password\"\n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"agreeToTerms\"\n                render={({ field }) => (\n                  <FormItem className=\"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4\">\n                    <FormControl>\n                      <Checkbox\n                        checked={field.value}\n                        onCheckedChange={field.onChange}\n                        data-testid=\"checkbox-agree-terms\"\n                      />\n                    </FormControl>\n                    <div className=\"space-y-1 leading-none\">\n                      <FormLabel className=\"text-sm font-normal\">\n                        I agree to the{\" \"}\n                        <Dialog open={agreementDialogOpen} onOpenChange={setAgreementDialogOpen}>\n                          <DialogTrigger asChild>\n                            <button\n                              className=\"text-sm font-normal text-primary underline hover:text-primary/80 cursor-pointer bg-transparent border-none p-0\"\n                              type=\"button\"\n                              data-testid=\"link-view-agreement\"\n                            >\n                              {form.watch(\"role\") === \"employer\" ? \"Employer\" : \"Job Seeker\"} Sign-Up Agreement\n                            </button>\n                          </DialogTrigger>\n                          <DialogContent className=\"max-w-2xl max-h-[80vh]\">\n                            <DialogHeader>\n                              <DialogTitle>\n                                <div className=\"flex items-center gap-2\">\n                                  <FileText className=\"h-5 w-5\" />\n                                  {form.watch(\"role\") === \"employer\" ? \"Employer\" : \"Job Seeker\"} Sign-Up Agreement\n                                </div>\n                              </DialogTitle>\n                              <DialogDescription>\n                                Please read and understand the terms before proceeding\n                              </DialogDescription>\n                            </DialogHeader>\n                            <ScrollArea className=\"h-[50vh] pr-4\">\n                              <div className=\"whitespace-pre-wrap text-sm leading-relaxed\">\n                                {form.watch(\"role\") === \"employer\" ? EMPLOYER_AGREEMENT : JOB_SEEKER_AGREEMENT}\n                              </div>\n                            </ScrollArea>\n                            <div className=\"flex justify-end gap-2 pt-4 border-t\">\n                              <Button\n                                variant=\"outline\"\n                                onClick={() => setAgreementDialogOpen(false)}\n                                data-testid=\"button-close-agreement\"\n                              >\n                                Close\n                              </Button>\n                              <Button\n                                onClick={() => {\n                                  form.setValue(\"agreeToTerms\", true);\n                                  setAgreementDialogOpen(false);\n                                }}\n                                data-testid=\"button-accept-agreement\"\n                              >\n                                I Accept\n                              </Button>\n                            </div>\n                          </DialogContent>\n                        </Dialog>\n                      </FormLabel>\n                      <FormMessage />\n                    </div>\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={registerMutation.isPending}\n                data-testid=\"button-submit-register\"\n              >\n                {registerMutation.isPending ? \"Creating account...\" : \"Create Account\"}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"text-center text-sm text-muted-foreground\">\n            Already have an account?{\" \"}\n            <Link href=\"/login\">\n              <Button variant=\"ghost\" className=\"px-1\" data-testid=\"link-login\">\n                Log in\n              </Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":19042,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { \n  hashPassword, \n  comparePassword, \n  generateVerificationToken,\n  generateJWT,\n  getUserId,\n  isAuthenticated,\n  isAdmin,\n  isEmployer,\n  isJobSeeker\n} from \"./auth\";\nimport {\n  sendOTPEmail,\n  sendPasswordResetEmail,\n  sendApplicationStatusEmail,\n  sendFraudAlertEmail,\n  generateOTP,\n} from \"./email\";\nimport {\n  analyzeUserProfileForFraud,\n  analyzeJobPostingForFraud,\n  calculateJobMatch,\n  calculateJobMatchWithReasoning,\n  findMatchingCandidates,\n} from \"./ai\";\nimport { ObjectStorageService, ObjectNotFoundError } from \"./objectStorage\";\nimport { ObjectPermission } from \"./objectAcl\";\nimport { insertUserSchema, insertJobSchema, insertApplicationSchema, insertContactMessageSchema, users, type User, type JobSeekerProfile } from \"@shared/schema\";\nimport { ActivityLogger } from \"./logger\";\nimport { createAdminRouter } from \"./routes/admin\";\nimport { setupAuth, isAuthenticated as isReplitAuthenticated } from \"./replitAuth\";\nimport { setupGoogleAuth } from \"./googleAuth\";\n\nconst ADMIN_EMAIL = process.env.ADMIN_EMAIL || \"admin@zambajobs.com\";\n\n// Type predicate to ensure required user fields are present\ntype UserWithCoreFields = typeof users.$inferSelect & {\n  email: string;\n  role: 'job_seeker' | 'employer' | 'admin';\n  firstName: string;\n  lastName: string;\n};\n\nfunction requireUserCoreFields(user: typeof users.$inferSelect | undefined): asserts user is UserWithCoreFields {\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n  if (!user.email) {\n    throw new Error(\"User email is required\");\n  }\n  if (!user.role) {\n    throw new Error(\"User role is required\");\n  }\n  if (!user.firstName) {\n    throw new Error(\"User first name is required\");\n  }\n  if (!user.lastName) {\n    throw new Error(\"User last name is required\");\n  }\n}\n\n// Middleware to prevent caching of authenticated pages\nfunction noCacheMiddleware(req: any, res: any, next: any) {\n  res.set({\n    'Cache-Control': 'no-store, no-cache, must-revalidate, private',\n    'Pragma': 'no-cache',\n    'Expires': '0'\n  });\n  next();\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Set up Replit Auth (includes session setup)\n  await setupAuth(app);\n  \n  // Set up direct Google OAuth\n  await setupGoogleAuth(app);\n\n  // Apply no-cache headers to all API routes to prevent back button showing cached authenticated content\n  app.use('/api', noCacheMiddleware);\n\n  // Unified auth endpoint - works with both Replit Auth (session) and legacy (JWT)\n  app.get(\"/api/auth/user\", async (req, res) => {\n    try {\n      // Try Replit Auth session first\n      if (req.isAuthenticated?.() && (req.user as any)?.claims?.sub) {\n        const userId = (req.user as any).claims.sub;\n        const user = await storage.getUser(userId);\n        if (user) {\n          const { password, ...safeUser } = user;\n          return res.json({ ...safeUser, authMode: \"replit\" });\n        }\n      }\n      \n      // Fall back to legacy JWT\n      const authHeader = req.headers.authorization;\n      if (authHeader?.startsWith(\"Bearer \")) {\n        try {\n          const userId = getUserId(req);\n          const user = await storage.getUser(userId);\n          if (user) {\n            const { password, ...safeUser } = user;\n            return res.json({ ...safeUser, authMode: \"jwt\" });\n          }\n        } catch (error) {\n          // JWT invalid or expired\n        }\n      }\n      \n      return res.status(401).json({ message: \"Unauthorized\" });\n    } catch (error: any) {\n      console.error(\"Get user error:\", error);\n      res.status(500).json({ message: \"Failed to get user\" });\n    }\n  });\n\n  // Onboarding completion endpoint (for new Replit Auth users)\n  app.post(\"/api/auth/complete-onboarding\", isReplitAuthenticated, async (req, res) => {\n    try {\n      const userId = (req.user as any).claims.sub;\n      const { role } = req.body;\n      \n      if (!role || ![\"job_seeker\", \"employer\", \"admin\"].includes(role)) {\n        return res.status(400).json({ message: \"Valid role is required\" });\n      }\n      \n      // Update user with role\n      const user = await storage.updateUser(userId, { role });\n      \n      // Create appropriate profile\n      if (role === \"job_seeker\") {\n        await storage.createJobSeekerProfile({ userId });\n      } else if (role === \"employer\") {\n        await storage.createEmployerProfile({ userId, companyName: \"\" });\n      }\n      \n      const { password, ...safeUser } = user;\n      res.json({ user: safeUser });\n    } catch (error: any) {\n      console.error(\"Onboarding completion error:\", error);\n      res.status(500).json({ message: \"Failed to complete onboarding\" });\n    }\n  });\n\n  // Auth routes\n  app.post(\"/api/auth/register\", async (req, res) => {\n    try {\n      // Strip out agreeToTerms (frontend validation only, not stored in DB)\n      const { agreeToTerms, ...registrationData } = req.body;\n      const validatedData = insertUserSchema.parse(registrationData);\n      \n      if (!validatedData.email) {\n        return res.status(400).json({ message: \"Email is required\" });\n      }\n      \n      const existingUser = await storage.getUserByEmail(validatedData.email);\n      \n      if (existingUser) {\n        return res.status(400).json({ message: \"Email already registered\" });\n      }\n\n      if (!validatedData.password) {\n        return res.status(400).json({ message: \"Password is required\" });\n      }\n\n      const hashedPassword = await hashPassword(validatedData.password);\n      const otp = generateOTP();\n      const otpExpiry = new Date(Date.now() + 10 * 60 * 1000); // 10 minutes\n      \n      // Create user with OTP (bypassing schema validation for internal fields)\n      const user = await storage.createUser({\n        email: validatedData.email,\n        password: hashedPassword,\n        firstName: validatedData.firstName,\n        lastName: validatedData.lastName,\n        profileImageUrl: validatedData.profileImageUrl,\n        role: validatedData.role,\n        otp,\n        otpExpiry,\n        otpAttempts: 0,\n      } as any);\n\n      // Create profile based on role\n      if (user.role === \"job_seeker\") {\n        await storage.createJobSeekerProfile({\n          userId: user.id,\n        });\n      } else if (user.role === \"employer\") {\n        await storage.createEmployerProfile({\n          userId: user.id,\n          companyName: \"\", // Will be filled in profile setup\n        });\n      }\n\n      // Send OTP email\n      if (!user.email) {\n        return res.status(500).json({ message: \"User email is missing\" });\n      }\n      await sendOTPEmail(user.email, otp, user.firstName || undefined);\n\n      res.json({ \n        message: \"Registration successful. Please check your email for your verification code.\",\n        email: user.email,\n        requiresOTP: true\n      });\n    } catch (error: any) {\n      console.error(\"Registration error:\", error);\n      res.status(400).json({ message: error.message || \"Registration failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/verify-otp\", async (req, res) => {\n    try {\n      const { email, otp } = req.body;\n\n      if (!email || !otp) {\n        return res.status(400).json({ message: \"Email and OTP are required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Check if already verified\n      if (user.isEmailVerified) {\n        return res.status(400).json({ message: \"Email already verified\" });\n      }\n\n      // Check OTP lockout (5 failed attempts)\n      const attempts = user.otpAttempts ?? 0;\n      if (attempts >= 5) {\n        return res.status(429).json({ message: \"Too many failed attempts. Please request a new code.\" });\n      }\n\n      // Check if OTP exists and not expired\n      if (!user.otp || !user.otpExpiry) {\n        return res.status(400).json({ message: \"No verification code found. Please request a new one.\" });\n      }\n\n      if (new Date() > user.otpExpiry) {\n        return res.status(400).json({ message: \"Verification code expired. Please request a new one.\" });\n      }\n\n      // Verify OTP\n      if (user.otp !== otp) {\n        await storage.updateUser(user.id, { \n          otpAttempts: attempts + 1 \n        });\n        return res.status(400).json({ message: \"Invalid verification code\" });\n      }\n\n      // OTP is valid - verify email and clear OTP and rate limiting fields\n      await storage.updateUser(user.id, {\n        isEmailVerified: true,\n        otp: null,\n        otpExpiry: null,\n        otpAttempts: 0,\n        lastOtpResendAt: null,\n        otpResendCount: 0,\n        otpResendHourStart: null,\n      });\n\n      // Set session and generate JWT\n      if (!user.email) {\n        return res.status(500).json({ message: \"User email is missing\" });\n      }\n      \n      if (!user.role) {\n        return res.status(500).json({ message: \"User role is missing\" });\n      }\n      \n      req.session.userId = user.id;\n      req.session.userRole = user.role;\n      req.session.userEmail = user.email;\n\n      const token = generateJWT({\n        userId: user.id,\n        email: user.email,\n        role: user.role,\n      });\n\n      res.json({ \n        message: \"Email verified successfully\",\n        user: {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          role: user.role,\n        },\n        token,\n      });\n    } catch (error: any) {\n      console.error(\"OTP verification error:\", error);\n      res.status(500).json({ message: \"Verification failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/resend-otp\", async (req, res) => {\n    try {\n      const { email } = req.body;\n\n      if (!email) {\n        return res.status(400).json({ message: \"Email is required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      if (!user || !user.email) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Check if already verified\n      if (user.isEmailVerified) {\n        return res.status(400).json({ message: \"Email already verified\" });\n      }\n\n      const now = new Date();\n\n      // Rate limit: 1 resend per minute\n      if (user.lastOtpResendAt) {\n        const timeSinceLastResend = Math.max(0, now.getTime() - user.lastOtpResendAt.getTime());\n        if (timeSinceLastResend < 60 * 1000) {\n          const secondsRemaining = Math.ceil((60 * 1000 - timeSinceLastResend) / 1000);\n          return res.status(429).json({ \n            message: `Please wait ${secondsRemaining} seconds before requesting another code` \n          });\n        }\n      }\n\n      // Rate limit: 5 resends per hour\n      let resendCount = user.otpResendCount ?? 0;\n      let hourStart = user.otpResendHourStart;\n\n      // Reset counter if we're in a new hour\n      if (!hourStart || now.getTime() - hourStart.getTime() >= 60 * 60 * 1000) {\n        resendCount = 0;\n        hourStart = now;\n      }\n\n      if (resendCount >= 5) {\n        const minutesRemaining = Math.ceil((60 * 60 * 1000 - (now.getTime() - hourStart!.getTime())) / (60 * 1000));\n        return res.status(429).json({ \n          message: `Too many resend requests. Please try again in ${minutesRemaining} minutes` \n        });\n      }\n\n      // Generate new OTP\n      const otp = generateOTP();\n      const otpExpiry = new Date(Date.now() + 10 * 60 * 1000); // 10 minutes\n\n      await storage.updateUser(user.id, {\n        otp,\n        otpExpiry,\n        otpAttempts: 0,\n        lastOtpResendAt: now,\n        otpResendCount: resendCount + 1,\n        otpResendHourStart: hourStart,\n      });\n\n      // Send new OTP\n      await sendOTPEmail(user.email, otp, user.firstName || undefined);\n\n      res.json({ message: \"New verification code sent to your email\" });\n    } catch (error: any) {\n      console.error(\"Resend OTP error:\", error);\n      res.status(500).json({ message: \"Failed to resend verification code\" });\n    }\n  });\n\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n      \n      const user = await storage.getUserByEmail(email);\n      if (!user || !user.password) {\n        return res.status(401).json({ message: \"Invalid email or password\" });\n      }\n\n      const isValid = await comparePassword(password, user.password);\n      if (!isValid) {\n        return res.status(401).json({ message: \"Invalid email or password\" });\n      }\n\n      if (!user.isEmailVerified) {\n        return res.status(403).json({ message: \"Please verify your email before logging in\" });\n      }\n\n      // Ensure user has core fields for authentication\n      requireUserCoreFields(user);\n\n      // Set session for backward compatibility\n      req.session.userId = user.id;\n      req.session.userRole = user.role;\n      req.session.userEmail = user.email;\n\n      // Generate JWT token\n      const token = generateJWT({\n        userId: user.id,\n        email: user.email,\n        role: user.role,\n      });\n\n      res.json({ \n        user: {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          role: user.role,\n        },\n        token,\n      });\n    } catch (error: any) {\n      console.error(\"Login error:\", error);\n      res.status(400).json({ message: error.message || \"Login failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        console.error('Session destroy error:', err);\n        return res.status(500).json({ message: 'Logout failed' });\n      }\n      \n      // Clear the session cookie to ensure complete logout\n      // Must match the exact cookie options used when creating the session\n      res.clearCookie('connect.sid', {\n        path: '/',\n        httpOnly: true,\n        secure: true,\n        sameSite: 'lax'\n      });\n      \n      // Set cache-control headers to prevent browser caching after logout\n      res.set({\n        'Cache-Control': 'no-store, no-cache, must-revalidate, private',\n        'Pragma': 'no-cache',\n        'Expires': '0'\n      });\n      \n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  app.get(\"/api/auth/me\", isAuthenticated, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      const { password, emailVerificationToken, passwordResetToken, ...safeUser } = user;\n      res.json(safeUser);\n    } catch (error: any) {\n      console.error(\"Get user error:\", error);\n      res.status(500).json({ message: \"Failed to get user\" });\n    }\n  });\n\n  app.post(\"/api/auth/forgot-password\", async (req, res) => {\n    try {\n      const { email } = req.body;\n      const user = await storage.getUserByEmail(email);\n      \n      if (!user) {\n        return res.json({ message: \"If the email exists, a reset link will be sent\" });\n      }\n\n      const resetToken = generateVerificationToken();\n      const resetExpiry = new Date(Date.now() + 60 * 60 * 1000); // 1 hour\n\n      await storage.updateUser(user.id, {\n        passwordResetToken: resetToken,\n        passwordResetExpiry: resetExpiry,\n      });\n\n      await sendPasswordResetEmail(email, resetToken, user.firstName || undefined);\n      \n      res.json({ message: \"If the email exists, a reset link will be sent\" });\n    } catch (error: any) {\n      console.error(\"Forgot password error:\", error);\n      res.status(500).json({ message: \"Failed to process request\" });\n    }\n  });\n\n  app.get(\"/api/auth/verify-email\", async (req, res) => {\n    try {\n      const { token } = req.query;\n      \n      if (!token || typeof token !== 'string') {\n        return res.status(400).json({ message: \"Invalid verification link\" });\n      }\n\n      const user = await storage.getUserByVerificationToken(token);\n      \n      if (!user) {\n        return res.status(400).json({ message: \"Invalid or expired verification link\" });\n      }\n\n      // Check if token is expired\n      if (user.emailVerificationTokenExpiry && user.emailVerificationTokenExpiry < new Date()) {\n        return res.status(400).json({ message: \"Verification link has expired\" });\n      }\n\n      // Check if already verified (idempotent)\n      if (user.isEmailVerified) {\n        return res.json({ message: \"Email already verified. You can now log in.\" });\n      }\n\n      // Mark user as verified and clear token\n      await storage.updateUser(user.id, {\n        isEmailVerified: true,\n        emailVerificationToken: null,\n        emailVerificationTokenExpiry: null,\n      });\n\n      res.json({ message: \"Email verified successfully! You can now log in.\" });\n    } catch (error: any) {\n      console.error(\"Email verification error:\", error);\n      res.status(500).json({ message: \"Failed to verify email\" });\n    }\n  });\n\n  // Job Seeker Profile routes\n  app.get(\"/api/profile\", isAuthenticated, async (req, res) => {\n    try {\n      const user = await storage.getUser(getUserId(req));\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      if (user.role === \"job_seeker\") {\n        const profile = await storage.getJobSeekerProfile(user.id);\n        const workExp = profile ? await storage.getWorkExperience(profile.id) : [];\n        const edu = profile ? await storage.getEducation(profile.id) : [];\n        const certs = profile ? await storage.getCertifications(profile.id) : [];\n        \n        res.json({\n          ...profile,\n          workExperience: workExp,\n          education: edu,\n          certifications: certs,\n        });\n      } else if (user.role === \"employer\") {\n        const profile = await storage.getEmployerProfile(user.id);\n        res.json(profile);\n      } else {\n        res.json({ message: \"No profile for this role\" });\n      }\n    } catch (error: any) {\n      console.error(\"Get profile error:\", error);\n      res.status(500).json({ message: \"Failed to get profile\" });\n    }\n  });\n\n  app.put(\"/api/profile\", isAuthenticated, async (req, res) => {\n    try {\n      const user = await storage.getUser(getUserId(req));\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      if (user.role === \"job_seeker\") {\n        const profile = await storage.getJobSeekerProfile(user.id);\n        if (!profile) {\n          return res.status(404).json({ message: \"Profile not found\" });\n        }\n\n        // Temporary debug logging for resume upload issue\n        console.log(\"Profile update - resumeUrl in body:\", req.body.resumeUrl ? \"YES\" : \"NO\");\n        if (req.body.resumeUrl) {\n          console.log(\"Resume path:\", req.body.resumeUrl);\n        }\n\n        // Verify and set ACL for profile image if provided\n        if (req.body.profileImage) {\n          let imagePath = req.body.profileImage;\n          \n          // Normalize path - remove any traversal attempts\n          imagePath = imagePath.replace(/\\.\\./g, '').replace(/\\/+/g, '/');\n          \n          // Strict validation - must match exact pattern\n          const pathRegex = new RegExp(`^/users/${user.id}/profile-\\\\d+-[a-z0-9]+\\\\.(jpg|jpeg|png|webp)$`);\n          if (!pathRegex.test(imagePath)) {\n            return res.status(403).json({ message: \"Invalid image path format\" });\n          }\n\n          // Set ACL policy for uploaded image\n          try {\n            const objectStorageService = new ObjectStorageService();\n            // ACL methods expect paths starting with /objects/\n            await objectStorageService.trySetObjectEntityAclPolicy(`/objects${imagePath}`, {\n              owner: user.id,\n              visibility: \"private\",\n            });\n          } catch (error) {\n            console.error(\"Failed to set ACL for profile image:\", error);\n            // Continue anyway - image is uploaded, just might not be accessible yet\n          }\n        }\n\n        // Verify and set ACL for resume if provided\n        if (req.body.resumeUrl) {\n          let resumePath = req.body.resumeUrl;\n          \n          // Normalize path - remove any traversal attempts\n          resumePath = resumePath.replace(/\\.\\./g, '').replace(/\\/+/g, '/');\n          \n          // Strict validation - must match exact pattern\n          const pathRegex = new RegExp(`^/users/${user.id}/resume-\\\\d+-[a-z0-9]+\\\\.(pdf|doc|docx)$`);\n          if (!pathRegex.test(resumePath)) {\n            console.error(\"Invalid resume path format:\", resumePath);\n            return res.status(403).json({ message: \"Invalid resume path format\" });\n          }\n\n          // Set ACL policy for uploaded resume\n          try {\n            const objectStorageService = new ObjectStorageService();\n            // ACL methods expect paths starting with /objects/\n            await objectStorageService.trySetObjectEntityAclPolicy(`/objects${resumePath}`, {\n              owner: user.id,\n              visibility: \"private\",\n            });\n          } catch (error) {\n            console.error(\"Failed to set ACL for resume:\", error);\n            // Continue anyway - resume is uploaded, just might not be accessible yet\n          }\n        }\n\n        const updated = await storage.updateJobSeekerProfile(profile.id, req.body);\n        \n        // Run fraud detection analysis on profile update\n        // Note: Skip image analysis for now (internal paths not accessible to OpenAI API)\n        const fraudResult = await analyzeUserProfileForFraud(user, updated, undefined);\n        if (fraudResult.isFraudulent && fraudResult.confidence >= 70) {\n          await storage.createFraudAlert({\n            entityType: \"user\",\n            entityId: user.id,\n            alertType: fraudResult.alertType,\n            description: fraudResult.reasons.join(\"; \"),\n            aiConfidence: fraudResult.confidence,\n          });\n          await sendFraudAlertEmail(\n            fraudResult.alertType,\n            fraudResult.reasons.join(\"; \"),\n            \"user\",\n            user.id,\n            fraudResult.confidence\n          );\n        }\n        \n        res.json(updated);\n      } else if (user.role === \"employer\") {\n        const profile = await storage.getEmployerProfile(user.id);\n        if (!profile) {\n          return res.status(404).json({ message: \"Profile not found\" });\n        }\n\n        const updated = await storage.updateEmployerProfile(profile.id, req.body);\n        res.json(updated);\n      }\n    } catch (error: any) {\n      console.error(\"Update profile error:\", error);\n      res.status(500).json({ message: \"Failed to update profile\" });\n    }\n  });\n\n  // Work Experience routes\n  app.post(\"/api/profile/work-experience\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      const profile = await storage.getJobSeekerProfile(userId);\n      if (!profile) {\n        return res.status(404).json({ message: \"Profile not found\" });\n      }\n\n      const workExp = await storage.createWorkExperience({\n        ...req.body,\n        profileId: profile.id,\n      });\n      res.json(workExp);\n    } catch (error: any) {\n      console.error(\"Create work experience error:\", error);\n      res.status(500).json({ message: \"Failed to create work experience\" });\n    }\n  });\n\n  app.delete(\"/api/profile/work-experience/:id\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      await storage.deleteWorkExperience(req.params.id);\n      res.json({ message: \"Work experience deleted\" });\n    } catch (error: any) {\n      console.error(\"Delete work experience error:\", error);\n      res.status(500).json({ message: \"Failed to delete work experience\" });\n    }\n  });\n\n  // Education routes\n  app.post(\"/api/profile/education\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      const profile = await storage.getJobSeekerProfile(userId);\n      if (!profile) {\n        return res.status(404).json({ message: \"Profile not found\" });\n      }\n\n      const education = await storage.createEducation({\n        ...req.body,\n        profileId: profile.id,\n      });\n      res.json(education);\n    } catch (error: any) {\n      console.error(\"Create education error:\", error);\n      res.status(500).json({ message: \"Failed to create education\" });\n    }\n  });\n\n  app.delete(\"/api/profile/education/:id\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      await storage.deleteEducation(req.params.id);\n      res.json({ message: \"Education deleted\" });\n    } catch (error: any) {\n      console.error(\"Delete education error:\", error);\n      res.status(500).json({ message: \"Failed to delete education\" });\n    }\n  });\n\n  // Certifications routes\n  app.post(\"/api/profile/certifications\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      const profile = await storage.getJobSeekerProfile(userId);\n      if (!profile) {\n        return res.status(404).json({ message: \"Profile not found\" });\n      }\n\n      const certification = await storage.createCertification({\n        ...req.body,\n        profileId: profile.id,\n      });\n      res.json(certification);\n    } catch (error: any) {\n      console.error(\"Create certification error:\", error);\n      res.status(500).json({ message: \"Failed to create certification\" });\n    }\n  });\n\n  app.delete(\"/api/profile/certifications/:id\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      await storage.deleteCertification(req.params.id);\n      res.json({ message: \"Certification deleted\" });\n    } catch (error: any) {\n      console.error(\"Delete certification error:\", error);\n      res.status(500).json({ message: \"Failed to delete certification\" });\n    }\n  });\n\n  // Jobs routes\n  app.get(\"/api/jobs\", async (req, res) => {\n    try {\n      const { search, location, jobType, category } = req.query;\n      \n      const jobs = await storage.getAllJobs({ isActive: true });\n      let filteredJobs = jobs.filter(j => !j.isFlagged);\n      \n      // Apply search filter (search in title and description)\n      if (search && typeof search === 'string' && search.trim() !== '') {\n        const searchLower = search.toLowerCase().trim();\n        filteredJobs = filteredJobs.filter(job => \n          job.title?.toLowerCase().includes(searchLower) ||\n          job.description?.toLowerCase().includes(searchLower)\n        );\n      }\n      \n      // Apply location filter\n      if (location && typeof location === 'string' && location.trim() !== '') {\n        const locationLower = location.toLowerCase().trim();\n        filteredJobs = filteredJobs.filter(job => \n          job.location?.toLowerCase().includes(locationLower)\n        );\n      }\n      \n      // Apply job type filter\n      if (jobType && typeof jobType === 'string' && jobType !== 'all') {\n        filteredJobs = filteredJobs.filter(job => \n          job.jobType === jobType\n        );\n      }\n      \n      // Apply category filter\n      if (category && typeof category === 'string' && category !== 'all') {\n        filteredJobs = filteredJobs.filter(job => \n          job.category === category\n        );\n      }\n      \n      res.json(filteredJobs);\n    } catch (error: any) {\n      console.error(\"Get jobs error:\", error);\n      res.status(500).json({ message: \"Failed to get jobs\" });\n    }\n  });\n\n  // IMPORTANT: Specific routes must come before dynamic :id routes\n  app.get(\"/api/jobs/recommended\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      const profile = await storage.getJobSeekerProfile(getUserId(req));\n      if (!profile) {\n        console.log(\"[Recommendations] No profile found for user\");\n        return res.json([]);\n      }\n\n      console.log(\"[Recommendations] Profile found:\", { skills: profile.skills, headline: profile.headline });\n\n      // Fetch complete profile data for enhanced matching (only once per request)\n      const [workExp, education, certifications] = await Promise.all([\n        storage.getWorkExperience(profile.id),\n        storage.getEducation(profile.id),\n        storage.getCertifications(profile.id)\n      ]);\n\n      console.log(\"[Recommendations] Profile data:\", { workExp: workExp.length, education: education.length, certifications: certifications.length });\n\n      const allJobs = await storage.getAllJobs({ isActive: true });\n      const activeJobs = allJobs.filter(j => !j.isFlagged);\n      \n      console.log(\"[Recommendations] Found\", activeJobs.length, \"active jobs to match\");\n      \n      // Prepare profile data once for all comparisons\n      const workExpData = workExp.map(w => ({ \n        companyName: w.companyName, \n        position: w.position, \n        description: w.description || undefined \n      }));\n      const educationData = education.map(e => ({ \n        institution: e.institution, \n        degree: e.degree, \n        fieldOfStudy: e.fieldOfStudy || undefined \n      }));\n      const certData = certifications.map(c => ({ \n        name: c.name, \n        issuer: c.issuer \n      }));\n      \n      // Process ALL jobs with concurrency limit for API calls (batch of 5)\n      const BATCH_SIZE = 5;\n      const jobsWithScores: Array<any> = [];\n      \n      for (let i = 0; i < activeJobs.length; i += BATCH_SIZE) {\n        const batch = activeJobs.slice(i, i + BATCH_SIZE);\n        const batchResults = await Promise.all(\n          batch.map(async (job) => {\n            const result = await calculateJobMatchWithReasoning(\n              profile, \n              job,\n              workExpData,\n              educationData,\n              certData\n            );\n            return { \n              ...job, \n              aiMatchScore: result.matchScore,\n              aiMatchReasoning: result.reasoning\n            };\n          })\n        );\n        jobsWithScores.push(...batchResults);\n      }\n\n      // Return ALL jobs that meet minimum threshold (30+), sorted by score\n      console.log(\"[Recommendations] Job scores:\", jobsWithScores.map(j => ({ title: j.title, score: j.aiMatchScore })));\n      \n      const recommended = jobsWithScores\n        .filter(j => j.aiMatchScore >= 30)\n        .sort((a, b) => b.aiMatchScore - a.aiMatchScore);\n\n      console.log(\"[Recommendations] Final recommendations:\", recommended.length, \"jobs\");\n      res.json(recommended);\n    } catch (error: any) {\n      console.error(\"Get recommended jobs error:\", error);\n      res.status(500).json({ message: \"Failed to get recommended jobs\" });\n    }\n  });\n\n  app.get(\"/api/jobs/:id\", async (req, res) => {\n    try {\n      const job = await storage.getJob(req.params.id);\n      if (!job) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n      res.json(job);\n    } catch (error: any) {\n      console.error(\"Get job error:\", error);\n      res.status(500).json({ message: \"Failed to get job\" });\n    }\n  });\n\n  app.post(\"/api/jobs\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const validatedData = insertJobSchema.parse(req.body);\n      const jobData = {\n        ...validatedData,\n        employerId: getUserId(req),\n        salaryCurrency: \"PHP\", // Default to Philippine Peso\n      };\n      const job = await storage.createJob(jobData);\n\n      // Run fraud detection on new job posting\n      const fraudResult = await analyzeJobPostingForFraud(job);\n      if (fraudResult.isFraudulent && fraudResult.confidence >= 70) {\n        await storage.updateJob(job.id, { isFlagged: true });\n        await storage.createFraudAlert({\n          entityType: \"job\",\n          entityId: job.id,\n          alertType: fraudResult.alertType,\n          description: fraudResult.reasons.join(\"; \"),\n          aiConfidence: fraudResult.confidence,\n        });\n        await sendFraudAlertEmail(\n          fraudResult.alertType,\n          fraudResult.reasons.join(\"; \"),\n          \"job\",\n          job.id,\n          fraudResult.confidence\n        );\n      }\n\n      res.json(job);\n    } catch (error: any) {\n      console.error(\"Create job error:\", error);\n      res.status(400).json({ message: error.message || \"Failed to create job\" });\n    }\n  });\n\n  app.put(\"/api/jobs/:id\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      // Verify the job exists and belongs to this employer\n      const existingJob = await storage.getJob(req.params.id);\n      if (!existingJob) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n      if (existingJob.employerId !== getUserId(req)) {\n        return res.status(403).json({ message: \"Unauthorized: You can only edit your own jobs\" });\n      }\n\n      // Validate and update the job\n      const validatedData = insertJobSchema.partial().parse(req.body);\n      const updatedJob = await storage.updateJob(req.params.id, validatedData);\n\n      // Run fraud detection on updated job posting\n      const fraudResult = await analyzeJobPostingForFraud(updatedJob);\n      if (fraudResult.isFraudulent && fraudResult.confidence >= 70) {\n        await storage.updateJob(updatedJob.id, { isFlagged: true });\n        await storage.createFraudAlert({\n          entityType: \"job\",\n          entityId: updatedJob.id,\n          alertType: fraudResult.alertType,\n          description: fraudResult.reasons.join(\"; \"),\n          aiConfidence: fraudResult.confidence,\n        });\n        await sendFraudAlertEmail(\n          fraudResult.alertType,\n          fraudResult.reasons.join(\"; \"),\n          \"job\",\n          updatedJob.id,\n          fraudResult.confidence\n        );\n      }\n\n      res.json(updatedJob);\n    } catch (error: any) {\n      console.error(\"Update job error:\", error);\n      res.status(400).json({ message: error.message || \"Failed to update job\" });\n    }\n  });\n\n  app.delete(\"/api/jobs/:id\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      // Verify the job exists and belongs to this employer\n      const existingJob = await storage.getJob(req.params.id);\n      if (!existingJob) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n      if (existingJob.employerId !== getUserId(req)) {\n        return res.status(403).json({ message: \"Unauthorized: You can only delete your own jobs\" });\n      }\n\n      await storage.deleteJob(req.params.id);\n      res.json({ message: \"Job deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Delete job error:\", error);\n      res.status(500).json({ message: \"Failed to delete job\" });\n    }\n  });\n\n  // Admin delete job (no ownership check)\n  app.delete(\"/api/admin/jobs/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const existingJob = await storage.getJob(req.params.id);\n      if (!existingJob) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n\n      await storage.deleteJob(req.params.id);\n      res.json({ message: \"Job deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Admin delete job error:\", error);\n      res.status(500).json({ message: \"Failed to delete job\" });\n    }\n  });\n\n  // Applications routes\n  app.get(\"/api/applications\", isAuthenticated, async (req, res) => {\n    try {\n      const applications = await storage.getApplicationsBySeeker(getUserId(req));\n      res.json(applications);\n    } catch (error: any) {\n      console.error(\"Get applications error:\", error);\n      res.status(500).json({ message: \"Failed to get applications\" });\n    }\n  });\n\n  app.post(\"/api/jobs/:id/apply\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      const job = await storage.getJob(req.params.id);\n      if (!job) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n\n      const profile = await storage.getJobSeekerProfile(getUserId(req));\n      if (!profile) {\n        return res.status(400).json({ message: \"Please complete your profile before applying\" });\n      }\n\n      // Defensive backend check: Require resume to be uploaded\n      if (!profile.resumeUrl) {\n        return res.status(400).json({ message: \"Please upload your resume before applying\" });\n      }\n\n      // Fetch complete profile data for enhanced matching\n      const workExp = await storage.getWorkExperience(profile.id);\n      const education = await storage.getEducation(profile.id);\n      const certifications = await storage.getCertifications(profile.id);\n\n      // Calculate match score with complete profile data\n      const matchScore = await calculateJobMatch(\n        profile,\n        job,\n        workExp.map(w => ({ companyName: w.companyName, position: w.position, description: w.description || undefined })),\n        education.map(e => ({ institution: e.institution, degree: e.degree, fieldOfStudy: e.fieldOfStudy || undefined })),\n        certifications.map(c => ({ name: c.name, issuer: c.issuer }))\n      );\n\n      // Create application with AI match score (bypassing schema validation for internal fields)\n      const application = await storage.createApplication({\n        jobId: req.params.id,\n        seekerId: getUserId(req),\n        coverLetter: req.body.coverLetter || null,\n        aiMatchScore: matchScore,\n      } as any);\n\n      res.json(application);\n    } catch (error: any) {\n      console.error(\"Apply error:\", error);\n      res.status(400).json({ message: error.message || \"Failed to apply\" });\n    }\n  });\n\n  // Employer routes\n  app.get(\"/api/employer/jobs\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const jobs = await storage.getJobsByEmployer(getUserId(req));\n      res.json(jobs);\n    } catch (error: any) {\n      console.error(\"Get employer jobs error:\", error);\n      res.status(500).json({ message: \"Failed to get jobs\" });\n    }\n  });\n\n  app.get(\"/api/employer/jobs/:id/applications\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      // Verify the job belongs to this employer\n      const job = await storage.getJob(req.params.id);\n      if (!job) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n      if (job.employerId !== getUserId(req)) {\n        return res.status(403).json({ message: \"Unauthorized\" });\n      }\n\n      const applications = await storage.getApplicationsByJob(req.params.id);\n      \n      // Enrich applications with user, profile, and portfolio data\n      const enrichedApplications = await Promise.all(\n        applications.map(async (app) => {\n          const user = await storage.getUser(app.seekerId);\n          const profile = await storage.getJobSeekerProfile(app.seekerId);\n          \n          // Fetch work experience and education\n          const workExperience = profile ? await storage.getWorkExperience(profile.id) : [];\n          const education = profile ? await storage.getEducation(profile.id) : [];\n          \n          return {\n            ...app,\n            applicant: {\n              id: user?.id,\n              firstName: user?.firstName,\n              lastName: user?.lastName,\n              email: user?.email,\n              profileImage: user?.profileImageUrl || profile?.profileImage,\n              headline: profile?.headline,\n              location: profile?.location,\n              phoneNumber: profile?.phoneNumber,\n              resumeUrl: profile?.resumeUrl,\n              skills: profile?.skills,\n              workExperience,\n              education,\n            }\n          };\n        })\n      );\n      \n      res.json(enrichedApplications);\n    } catch (error: any) {\n      console.error(\"Get job applications error:\", error);\n      res.status(500).json({ message: \"Failed to get applications\" });\n    }\n  });\n\n  // Get job seeker portfolio for employer to view\n  app.get(\"/api/employer/applicant/:userId\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const { userId } = req.params;\n      \n      // Get user basic info\n      const user = await storage.getUser(userId);\n      if (!user || user.role !== 'job_seeker') {\n        return res.status(404).json({ message: \"Job seeker not found\" });\n      }\n      \n      // Get profile\n      const profile = await storage.getJobSeekerProfile(userId);\n      if (!profile) {\n        return res.status(404).json({ message: \"Profile not found\" });\n      }\n      \n      // Get work experience, education, and certifications\n      const [workExperience, education, certifications] = await Promise.all([\n        storage.getWorkExperience(profile.id),\n        storage.getEducation(profile.id),\n        storage.getCertifications(profile.id)\n      ]);\n      \n      // Return comprehensive portfolio\n      res.json({\n        id: user.id,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        email: user.email,\n        profileImage: user.profileImageUrl || profile.profileImage,\n        headline: profile.headline,\n        bio: profile.bio,\n        location: profile.location,\n        phoneNumber: profile.phoneNumber,\n        linkedinUrl: profile.linkedinUrl,\n        portfolioUrl: profile.portfolioUrl,\n        resumeUrl: profile.resumeUrl,\n        skills: profile.skills || [],\n        workExperience,\n        education,\n        certifications\n      });\n    } catch (error: any) {\n      console.error(\"Get applicant portfolio error:\", error);\n      res.status(500).json({ message: \"Failed to fetch applicant portfolio\" });\n    }\n  });\n\n  // Update application status (employer only)\n  app.put(\"/api/applications/:id\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { status } = req.body;\n      \n      // Validate status\n      const validStatuses = [\"applied\", \"reviewing\", \"shortlisted\", \"rejected\", \"accepted\"];\n      if (!status || !validStatuses.includes(status)) {\n        return res.status(400).json({ message: \"Invalid status\" });\n      }\n      \n      // Get the application\n      const application = await storage.getApplication(id);\n      if (!application) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n      \n      // Verify the job belongs to this employer\n      const job = await storage.getJob(application.jobId);\n      if (!job || job.employerId !== getUserId(req)) {\n        return res.status(403).json({ message: \"Unauthorized\" });\n      }\n      \n      // Update application status\n      const updatedApplication = await storage.updateApplication(id, { status });\n      res.json(updatedApplication);\n    } catch (error: any) {\n      console.error(\"Update application status error:\", error);\n      res.status(500).json({ message: \"Failed to update application status\" });\n    }\n  });\n\n  app.get(\"/api/employer/candidates\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const employerId = getUserId(req);\n      const jobs = await storage.getJobsByEmployer(employerId);\n      \n      // Only process active jobs\n      const activeJobs = jobs.filter(j => j.isActive && !j.isFlagged);\n      \n      if (activeJobs.length === 0) {\n        return res.json([]);\n      }\n\n      // Get all job seekers with their complete profiles\n      const allUsers = await storage.getAllUsers();\n      const jobSeekers = allUsers.filter(u => u.role === \"job_seeker\");\n      \n      // Build candidate data with profiles\n      const candidatesData = await Promise.all(\n        jobSeekers.map(async (user) => {\n          const profile = await storage.getJobSeekerProfile(user.id);\n          if (!profile) return null;\n          \n          const workExperience = await storage.getWorkExperience(profile.id);\n          const education = await storage.getEducation(profile.id);\n          const certifications = await storage.getCertifications(profile.id);\n          \n          return {\n            user,\n            profile,\n            workExperience,\n            education,\n            certifications\n          };\n        })\n      );\n      \n      const validCandidates = candidatesData.filter(Boolean) as Array<{\n        user: User;\n        profile: JobSeekerProfile;\n        workExperience: any[];\n        education: any[];\n        certifications: any[];\n      }>;\n\n      // Find matches for all jobs\n      const allMatches = await Promise.all(\n        activeJobs.map(async (job) => {\n          const matches = await findMatchingCandidates(job, validCandidates);\n          return matches.map(m => ({ ...m, jobId: job.id, jobTitle: job.title }));\n        })\n      );\n\n      // Flatten and deduplicate by userId, keeping highest match score\n      const candidateMap = new Map<string, any>();\n      allMatches.flat().forEach(match => {\n        const existing = candidateMap.get(match.userId);\n        if (!existing || match.matchScore > existing.matchScore) {\n          candidateMap.set(match.userId, match);\n        }\n      });\n\n      // Build response with user details\n      const recommendations = await Promise.all(\n        Array.from(candidateMap.values()).map(async (match) => {\n          const user = validCandidates.find(c => c.user.id === match.userId)?.user;\n          const profile = validCandidates.find(c => c.user.id === match.userId)?.profile;\n          \n          if (!user || !profile) return null;\n          \n          return {\n            id: user.id,\n            firstName: user.firstName,\n            lastName: user.lastName,\n            email: user.email,\n            headline: profile.headline,\n            matchScore: Math.round(match.matchScore),\n            jobId: match.jobId,\n            jobTitle: match.jobTitle\n          };\n        })\n      );\n\n      const validRecommendations = recommendations.filter(Boolean);\n      res.json(validRecommendations);\n    } catch (error: any) {\n      console.error(\"Get candidates error:\", error);\n      res.status(500).json({ message: \"Failed to get candidates\" });\n    }\n  });\n\n  // Admin routes\n  app.get(\"/api/admin/fraud-alerts\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const alerts = await storage.getAllFraudAlerts();\n      \n      // Enrich alerts with entity and reviewer information\n      const enrichedAlerts = await Promise.all(\n        alerts.map(async (alert) => {\n          let entityInfo = null;\n          \n          // Get entity information based on type\n          if (alert.entityType === 'user') {\n            const user = await storage.getUser(alert.entityId);\n            if (user) {\n              entityInfo = {\n                name: `${user.firstName} ${user.lastName}`,\n                email: user.email,\n                role: user.role\n              };\n            }\n          } else if (alert.entityType === 'job') {\n            const job = await storage.getJob(alert.entityId);\n            if (job) {\n              const employer = await storage.getUser(job.employerId);\n              entityInfo = {\n                title: job.title,\n                company: job.companyName,\n                employerName: employer ? `${employer.firstName} ${employer.lastName}` : 'Unknown'\n              };\n            }\n          }\n          \n          // Get reviewer information\n          let reviewerInfo = null;\n          if (alert.reviewedBy) {\n            const reviewer = await storage.getUser(alert.reviewedBy);\n            if (reviewer) {\n              reviewerInfo = {\n                name: `${reviewer.firstName} ${reviewer.lastName}`,\n                email: reviewer.email\n              };\n            }\n          }\n          \n          return {\n            ...alert,\n            entityInfo,\n            reviewerInfo\n          };\n        })\n      );\n      \n      res.json(enrichedAlerts);\n    } catch (error: any) {\n      console.error(\"Get fraud alerts error:\", error);\n      res.status(500).json({ message: \"Failed to get fraud alerts\" });\n    }\n  });\n\n  app.get(\"/api/admin/fraud-alerts/:id/details\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const alert = await storage.getFraudAlert(req.params.id);\n      if (!alert) {\n        return res.status(404).json({ message: \"Alert not found\" });\n      }\n\n      let details = null;\n      if (alert.entityType === 'user') {\n        details = await storage.getUser(alert.entityId);\n        if (details) {\n          const { password, ...safeUser } = details as any;\n          details = safeUser;\n        }\n      } else if (alert.entityType === 'job') {\n        details = await storage.getJob(alert.entityId);\n      }\n\n      res.json({ alert, details });\n    } catch (error: any) {\n      console.error(\"Get fraud alert details error:\", error);\n      res.status(500).json({ message: \"Failed to get fraud alert details\" });\n    }\n  });\n\n  app.put(\"/api/admin/fraud-alerts/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { status, reviewNotes } = req.body;\n      const updated = await storage.updateFraudAlert(req.params.id, {\n        status,\n        reviewNotes,\n        reviewedBy: getUserId(req),\n        reviewedAt: new Date(),\n      });\n      res.json(updated);\n    } catch (error: any) {\n      console.error(\"Update fraud alert error:\", error);\n      res.status(500).json({ message: \"Failed to update fraud alert\" });\n    }\n  });\n\n  app.get(\"/api/admin/users\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const usersWithStats = await storage.getUsersWithStats();\n      res.json(usersWithStats);\n    } catch (error: any) {\n      console.error(\"Get users error:\", error);\n      res.status(500).json({ message: \"Failed to get users\" });\n    }\n  });\n\n  app.put(\"/api/admin/users/:id/flag\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { isFlagged } = req.body;\n      const updated = await storage.updateUser(req.params.id, { isFlagged });\n      res.json(updated);\n    } catch (error: any) {\n      console.error(\"Flag user error:\", error);\n      res.status(500).json({ message: \"Failed to flag user\" });\n    }\n  });\n\n  // Admin jobs endpoint with fraud alert information\n  app.get(\"/api/admin/jobs\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const jobs = await storage.getAllJobs();\n      const fraudAlerts = await storage.getAllFraudAlerts();\n      const employers = await storage.getAllUsers();\n      \n      // Get employer profiles for company names\n      const employerProfilesPromises = employers\n        .filter(e => e.role === 'employer')\n        .map(e => storage.getEmployerProfile(e.id));\n      const employerProfiles = await Promise.all(employerProfilesPromises);\n      \n      // Enrich jobs with employer info and fraud alert details\n      const jobsWithDetails = jobs.map(job => {\n        const employer = employers.find(e => e.id === job.employerId);\n        const employerProfile = employerProfiles.find(p => p?.userId === job.employerId);\n        \n        // Use job's companyName if exists, then employer profile companyName, then employer name as fallback\n        const companyName = (job as any).companyName \n          || employerProfile?.companyName \n          || (employer?.firstName && employer?.lastName ? `${employer.firstName} ${employer.lastName}` : 'Unknown Employer');\n        \n        const jobData: any = {\n          ...job,\n          companyName,\n        };\n        \n        // Add fraud alert info for flagged jobs\n        if (job.isFlagged) {\n          const jobAlerts = fraudAlerts.filter(\n            alert => alert.entityType === 'job' && alert.entityId === job.id\n          );\n          if (jobAlerts.length > 0) {\n            const latestAlert = jobAlerts.sort((a, b) => \n              new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n            )[0];\n            jobData.fraudAlertReason = latestAlert.description;\n            jobData.fraudAlertType = latestAlert.alertType;\n            jobData.fraudAlertConfidence = latestAlert.aiConfidence;\n            jobData.fraudAlertStatus = latestAlert.status;\n          } else {\n            // Manual flag - no AI alert exists\n            jobData.fraudAlertReason = \"Manually flagged by administrator\";\n            jobData.fraudAlertType = \"Manual Review\";\n            jobData.fraudAlertConfidence = null;\n            jobData.fraudAlertStatus = \"manual\";\n          }\n        }\n        \n        return jobData;\n      });\n      \n      res.json(jobsWithDetails);\n    } catch (error: any) {\n      console.error(\"Get admin jobs error:\", error);\n      res.status(500).json({ message: \"Failed to get jobs\" });\n    }\n  });\n\n  // Admin flag job endpoint\n  app.put(\"/api/admin/jobs/:id/flag\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { isFlagged } = req.body;\n      const updated = await storage.updateJob(req.params.id, { isFlagged });\n      res.json(updated);\n    } catch (error: any) {\n      console.error(\"Flag job error:\", error);\n      res.status(500).json({ message: \"Failed to flag job\" });\n    }\n  });\n\n  app.get(\"/api/admin/stats\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const users = await storage.getAllUsers();\n      const jobs = await storage.getAllJobs();\n      const applications = await storage.getAllApplications();\n      const pendingAlerts = await storage.getPendingFraudAlerts();\n      const allAlerts = await storage.getAllFraudAlerts();\n      \n      // Calculate detailed statistics\n      const jobSeekers = users.filter(u => u.role === 'job_seeker').length;\n      const employers = users.filter(u => u.role === 'employer').length;\n      const flaggedUsers = users.filter(u => u.isFlagged).length;\n      const verifiedUsers = users.filter(u => u.isEmailVerified).length;\n      \n      const activeJobs = jobs.filter(j => j.isActive && !j.isFlagged).length;\n      const flaggedJobs = jobs.filter(j => j.isFlagged).length;\n      \n      const pendingApplications = applications.filter(a => a.status === 'applied').length;\n      const confirmedFraudAlerts = allAlerts.filter(a => a.status === 'confirmed').length;\n      \n      res.json({\n        totalUsers: users.length,\n        jobSeekers,\n        employers,\n        flaggedUsers,\n        verifiedUsers,\n        activeJobs,\n        flaggedJobs,\n        totalApplications: applications.length,\n        pendingApplications,\n        pendingFraudAlerts: pendingAlerts.length,\n        confirmedFraudAlerts,\n        flaggedContent: flaggedJobs + flaggedUsers,\n      });\n    } catch (error: any) {\n      console.error(\"Get stats error:\", error);\n      res.status(500).json({ message: \"Failed to get stats\" });\n    }\n  });\n\n  // Analytics endpoints\n  app.get(\"/api/analytics/admin\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const users = await storage.getAllUsers();\n      const jobs = await storage.getAllJobs();\n      const applications = await storage.getAllApplications();\n      const fraudAlerts = await storage.getAllFraudAlerts();\n\n      // Time-series data for graphs (last 30 days)\n      const now = new Date();\n      const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n      \n      // Group users by registration date\n      const usersByDate = new Map<string, number>();\n      users.forEach(user => {\n        if (user.createdAt) {\n          const date = new Date(user.createdAt).toISOString().split('T')[0];\n          usersByDate.set(date, (usersByDate.get(date) || 0) + 1);\n        }\n      });\n\n      // Group jobs by posting date\n      const jobsByDate = new Map<string, number>();\n      jobs.forEach(job => {\n        if (job.createdAt) {\n          const date = new Date(job.createdAt).toISOString().split('T')[0];\n          jobsByDate.set(date, (jobsByDate.get(date) || 0) + 1);\n        }\n      });\n\n      // Group applications by date\n      const applicationsByDate = new Map<string, number>();\n      applications.forEach(app => {\n        if (app.createdAt) {\n          const date = new Date(app.createdAt).toISOString().split('T')[0];\n          applicationsByDate.set(date, (applicationsByDate.get(date) || 0) + 1);\n        }\n      });\n\n      // Generate last 30 days array\n      const last30Days = Array.from({ length: 30 }, (_, i) => {\n        const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);\n        return date.toISOString().split('T')[0];\n      }).reverse();\n\n      const userTrend = last30Days.map(date => ({\n        date,\n        count: usersByDate.get(date) || 0\n      }));\n\n      const jobTrend = last30Days.map(date => ({\n        date,\n        count: jobsByDate.get(date) || 0\n      }));\n\n      const applicationTrend = last30Days.map(date => ({\n        date,\n        count: applicationsByDate.get(date) || 0\n      }));\n\n      // User breakdown by role\n      const usersByRole = {\n        job_seeker: users.filter(u => u.role === 'job_seeker').length,\n        employer: users.filter(u => u.role === 'employer').length,\n        admin: users.filter(u => u.role === 'admin').length\n      };\n\n      // Application status breakdown\n      const applicationsByStatus = {\n        applied: applications.filter(a => a.status === 'applied').length,\n        reviewing: applications.filter(a => a.status === 'reviewing').length,\n        shortlisted: applications.filter(a => a.status === 'shortlisted').length,\n        rejected: applications.filter(a => a.status === 'rejected').length,\n        accepted: applications.filter(a => a.status === 'accepted').length\n      };\n\n      // Fraud alerts breakdown\n      const fraudAlertsByStatus = {\n        pending: fraudAlerts.filter(a => a.status === 'pending').length,\n        reviewed: fraudAlerts.filter(a => a.status === 'reviewed').length,\n        confirmed: fraudAlerts.filter(a => a.status === 'confirmed').length,\n        dismissed: fraudAlerts.filter(a => a.status === 'dismissed').length\n      };\n\n      // Top job categories\n      const jobsByCategory = new Map<string, number>();\n      jobs.forEach(job => {\n        if (job.category) {\n          jobsByCategory.set(job.category, (jobsByCategory.get(job.category) || 0) + 1);\n        }\n      });\n\n      const topCategories = Array.from(jobsByCategory.entries())\n        .map(([category, count]) => ({ category, count }))\n        .sort((a, b) => b.count - a.count)\n        .slice(0, 10);\n\n      res.json({\n        overview: {\n          totalUsers: users.length,\n          totalJobs: jobs.length,\n          totalApplications: applications.length,\n          totalFraudAlerts: fraudAlerts.length,\n          activeJobs: jobs.filter(j => j.isActive).length,\n          flaggedUsers: users.filter(u => u.isFlagged).length,\n          verifiedUsers: users.filter(u => u.isEmailVerified).length\n        },\n        trends: {\n          users: userTrend,\n          jobs: jobTrend,\n          applications: applicationTrend\n        },\n        breakdown: {\n          usersByRole,\n          applicationsByStatus,\n          fraudAlertsByStatus,\n          topCategories\n        }\n      });\n    } catch (error: any) {\n      console.error(\"Get admin analytics error:\", error);\n      res.status(500).json({ message: \"Failed to get analytics\" });\n    }\n  });\n\n  app.get(\"/api/analytics/employer\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const employerId = getUserId(req);\n      if (!employerId) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      const jobs = await storage.getJobsByEmployer(employerId);\n      const allApplications = await storage.getAllApplications();\n      \n      // Filter applications for THIS employer's jobs only\n      const jobIds = new Set(jobs.map(j => j.id));\n      const applications = allApplications.filter(a => jobIds.has(a.jobId));\n\n      // Applications over time (last 30 days)\n      const now = new Date();\n      const last30Days = Array.from({ length: 30 }, (_, i) => {\n        const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);\n        return date.toISOString().split('T')[0];\n      }).reverse();\n\n      const applicationsByDate = new Map<string, number>();\n      applications.forEach(app => {\n        if (app.createdAt) {\n          const date = new Date(app.createdAt).toISOString().split('T')[0];\n          applicationsByDate.set(date, (applicationsByDate.get(date) || 0) + 1);\n        }\n      });\n\n      const applicationTrend = last30Days.map(date => ({\n        date,\n        count: applicationsByDate.get(date) || 0\n      }));\n\n      // Applications per job\n      const applicationsByJob = jobs.map(job => {\n        const jobApps = applications.filter(a => a.jobId === job.id);\n        return {\n          jobTitle: job.title,\n          count: jobApps.length,\n          avgMatchScore: jobApps.length > 0 \n            ? Math.round(jobApps.reduce((sum, a) => sum + (a.aiMatchScore || 0), 0) / jobApps.length)\n            : 0\n        };\n      }).sort((a, b) => b.count - a.count);\n\n      // Application status breakdown\n      const applicationsByStatus = {\n        applied: applications.filter(a => a.status === 'applied').length,\n        reviewing: applications.filter(a => a.status === 'reviewing').length,\n        shortlisted: applications.filter(a => a.status === 'shortlisted').length,\n        rejected: applications.filter(a => a.status === 'rejected').length,\n        accepted: applications.filter(a => a.status === 'accepted').length\n      };\n\n      // Match score distribution\n      const matchScoreRanges = {\n        '90-100': applications.filter(a => a.aiMatchScore && a.aiMatchScore >= 90).length,\n        '70-89': applications.filter(a => a.aiMatchScore && a.aiMatchScore >= 70 && a.aiMatchScore < 90).length,\n        '50-69': applications.filter(a => a.aiMatchScore && a.aiMatchScore >= 50 && a.aiMatchScore < 70).length,\n        'Below 50': applications.filter(a => a.aiMatchScore && a.aiMatchScore < 50).length\n      };\n\n      res.json({\n        overview: {\n          totalJobs: jobs.length,\n          activeJobs: jobs.filter(j => j.isActive).length,\n          totalApplications: applications.length,\n          avgMatchScore: applications.length > 0\n            ? Math.round(applications.reduce((sum, a) => sum + (a.aiMatchScore || 0), 0) / applications.length)\n            : 0\n        },\n        trends: {\n          applications: applicationTrend\n        },\n        breakdown: {\n          applicationsByJob: applicationsByJob.slice(0, 10),\n          applicationsByStatus,\n          matchScoreRanges\n        }\n      });\n    } catch (error: any) {\n      console.error(\"Get employer analytics error:\", error);\n      res.status(500).json({ message: \"Failed to get analytics\" });\n    }\n  });\n\n  app.get(\"/api/analytics/job-seeker\", isAuthenticated, isJobSeeker, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      if (!userId) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      const profile = await storage.getJobSeekerProfile(userId);\n      \n      if (!profile) {\n        return res.status(404).json({ message: \"Profile not found\" });\n      }\n\n      // Get applications for THIS job seeker only\n      const applications = await storage.getApplicationsBySeeker(profile.id);\n\n      // Applications over time (last 30 days)\n      const now = new Date();\n      const last30Days = Array.from({ length: 30 }, (_, i) => {\n        const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);\n        return date.toISOString().split('T')[0];\n      }).reverse();\n\n      const applicationsByDate = new Map<string, number>();\n      applications.forEach((app: typeof applications[0]) => {\n        if (app.createdAt) {\n          const date = new Date(app.createdAt).toISOString().split('T')[0];\n          applicationsByDate.set(date, (applicationsByDate.get(date) || 0) + 1);\n        }\n      });\n\n      const applicationTrend = last30Days.map(date => ({\n        date,\n        count: applicationsByDate.get(date) || 0\n      }));\n\n      // Application status breakdown\n      const applicationsByStatus = {\n        applied: applications.filter((a: typeof applications[0]) => a.status === 'applied').length,\n        reviewing: applications.filter((a: typeof applications[0]) => a.status === 'reviewing').length,\n        shortlisted: applications.filter((a: typeof applications[0]) => a.status === 'shortlisted').length,\n        rejected: applications.filter((a: typeof applications[0]) => a.status === 'rejected').length,\n        accepted: applications.filter((a: typeof applications[0]) => a.status === 'accepted').length\n      };\n\n      // Match score distribution\n      const matchScoreRanges = {\n        '90-100': applications.filter((a: typeof applications[0]) => a.aiMatchScore && a.aiMatchScore >= 90).length,\n        '70-89': applications.filter((a: typeof applications[0]) => a.aiMatchScore && a.aiMatchScore >= 70 && a.aiMatchScore < 90).length,\n        '50-69': applications.filter((a: typeof applications[0]) => a.aiMatchScore && a.aiMatchScore >= 50 && a.aiMatchScore < 70).length,\n        'Below 50': applications.filter((a: typeof applications[0]) => a.aiMatchScore && a.aiMatchScore < 50).length\n      };\n\n      // Get job details for top applications\n      const jobsPromises = applications\n        .sort((a: typeof applications[0], b: typeof applications[0]) => (b.aiMatchScore || 0) - (a.aiMatchScore || 0))\n        .slice(0, 10)\n        .map(async (app: typeof applications[0]) => {\n          const job = await storage.getJob(app.jobId);\n          let companyName = 'Unknown';\n          if (job?.employerId) {\n            const employer = await storage.getEmployerProfile(job.employerId);\n            companyName = employer?.companyName || 'Unknown';\n          }\n          return {\n            jobTitle: job?.title || 'Unknown',\n            company: companyName,\n            matchScore: Math.round(app.aiMatchScore || 0),\n            status: app.status,\n            appliedAt: app.createdAt\n          };\n        });\n\n      const topApplications = await Promise.all(jobsPromises);\n\n      res.json({\n        overview: {\n          totalApplications: applications.length,\n          avgMatchScore: applications.length > 0\n            ? Math.round(applications.reduce((sum: number, a: typeof applications[0]) => sum + (a.aiMatchScore || 0), 0) / applications.length)\n            : 0,\n          responseRate: applications.length > 0\n            ? Math.round((applications.filter((a: typeof applications[0]) => a.status !== 'applied').length / applications.length) * 100)\n            : 0\n        },\n        trends: {\n          applications: applicationTrend\n        },\n        breakdown: {\n          applicationsByStatus,\n          matchScoreRanges,\n          topApplications\n        }\n      });\n    } catch (error: any) {\n      console.error(\"Get job seeker analytics error:\", error);\n      res.status(500).json({ message: \"Failed to get analytics\" });\n    }\n  });\n\n  // Mount admin router for activity logs, contacts, and search\n  const adminRouter = createAdminRouter();\n  app.use(\"/api/admin\", isAuthenticated, isAdmin, adminRouter);\n\n  // Public contact form submission endpoint\n  app.post(\"/api/contact\", async (req, res) => {\n    try {\n      const validated = insertContactMessageSchema.parse(req.body);\n      const message = await storage.createContactMessage(validated);\n      \n      // Log the contact message submission\n      await ActivityLogger.logSystemEvent(\n        `New contact message from ${validated.email}`,\n        { messageId: message.id, subject: validated.subject }\n      );\n      \n      res.status(201).json({ message: \"Message sent successfully\" });\n    } catch (error: any) {\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Contact form error:\", error);\n      res.status(500).json({ message: \"Failed to send message\" });\n    }\n  });\n\n  // Object Storage routes - Secure user-scoped uploads\n  app.post(\"/api/objects/upload\", isAuthenticated, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      if (!userId) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      // Validate file metadata from request\n      const { contentType, fileSize } = req.body;\n      \n      // Enforce file constraints\n      const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB\n      const ALLOWED_TYPES = ['image/jpeg', 'image/png', 'image/webp', 'image/jpg'];\n      \n      if (!contentType || !ALLOWED_TYPES.includes(contentType)) {\n        return res.status(400).json({ message: \"Invalid file type. Only JPEG, PNG, and WebP images allowed.\" });\n      }\n      \n      if (!fileSize || fileSize > MAX_FILE_SIZE) {\n        return res.status(400).json({ message: `File size must be under ${MAX_FILE_SIZE / 1024 / 1024}MB` });\n      }\n\n      // Generate user-scoped path - server-controlled to prevent traversal\n      const timestamp = Date.now();\n      const randomId = Math.random().toString(36).substring(2, 15);\n      const extension = contentType.split('/')[1].replace(/[^a-z0-9]/gi, ''); // Sanitize extension\n      \n      // Server-controlled path - no user input\n      const userScopedPath = `/users/${userId}/profile-${timestamp}-${randomId}.${extension}`;\n\n      const objectStorageService = new ObjectStorageService();\n      const uploadURL = await objectStorageService.getObjectEntityUploadURL(userScopedPath);\n      \n      // Defensive check - ensure we got a valid URL\n      if (!uploadURL) {\n        console.error(\"ObjectStorageService returned falsy uploadURL\");\n        return res.status(500).json({ message: \"Failed to generate upload URL - object storage misconfigured\" });\n      }\n      \n      res.json({ \n        uploadURL,\n        objectPath: userScopedPath,\n        expectedContentType: contentType, // Return expected type for client-side check\n        expectedSize: fileSize\n      });\n    } catch (error: any) {\n      console.error(\"Get upload URL error:\", error);\n      res.status(500).json({ message: \"Failed to get upload URL\" });\n    }\n  });\n\n  // Resume upload endpoint - supports PDF files\n  // SECURITY NOTE: This uses presigned URLs which means the actual file upload\n  // goes directly to GCS. While we validate the client's claimed contentType and fileSize,\n  // a malicious user could lie and upload different content. For production use, consider:\n  // 1. Implementing server-side proxy upload with actual byte validation\n  // 2. Using GCS Cloud Functions to validate files post-upload\n  // 3. Rate limiting per user to prevent abuse\n  app.post(\"/api/objects/upload-resume\", isAuthenticated, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      if (!userId) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      // Validate file metadata from client claim\n      const { contentType, fileSize } = req.body;\n      \n      // Strict validation of claimed file properties\n      const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB for documents\n      const ALLOWED_TYPES = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n      \n      // Validate contentType\n      if (!contentType || typeof contentType !== 'string') {\n        return res.status(400).json({ message: \"Content type is required\" });\n      }\n      \n      if (!ALLOWED_TYPES.includes(contentType)) {\n        return res.status(400).json({ \n          message: \"Invalid file type. Only PDF and Word documents (.pdf, .doc, .docx) are allowed.\" \n        });\n      }\n      \n      // Validate fileSize\n      if (!fileSize || typeof fileSize !== 'number' || fileSize <= 0) {\n        return res.status(400).json({ message: \"Valid file size is required\" });\n      }\n      \n      if (fileSize > MAX_FILE_SIZE) {\n        return res.status(400).json({ \n          message: `File size must be under ${MAX_FILE_SIZE / 1024 / 1024}MB` \n        });\n      }\n\n      // Generate user-scoped path with sanitized extension\n      const timestamp = Date.now();\n      const randomId = Math.random().toString(36).substring(2, 15);\n      \n      // Strictly map contentType to extension (no user input)\n      const extensionMap: Record<string, string> = {\n        'application/pdf': 'pdf',\n        'application/msword': 'doc',\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'docx'\n      };\n      const extension = extensionMap[contentType];\n      \n      if (!extension) {\n        return res.status(400).json({ message: \"Unsupported content type\" });\n      }\n      \n      // Server-controlled path - no user input\n      const userScopedPath = `/users/${userId}/resume-${timestamp}-${randomId}.${extension}`;\n\n      const objectStorageService = new ObjectStorageService();\n      const uploadURL = await objectStorageService.getObjectEntityUploadURL(userScopedPath);\n      \n      // Defensive check - ensure we got a valid URL\n      if (!uploadURL) {\n        console.error(\"ObjectStorageService returned falsy uploadURL for resume\");\n        return res.status(500).json({ message: \"Failed to generate upload URL - object storage misconfigured\" });\n      }\n      \n      res.json({ \n        uploadURL,\n        objectPath: userScopedPath,\n        expectedContentType: contentType,\n        expectedSize: fileSize\n      });\n    } catch (error: any) {\n      console.error(\"Get resume upload URL error:\", error);\n      res.status(500).json({ message: \"Failed to get upload URL\" });\n    }\n  });\n\n  // Requirement document upload endpoint - supports PDF, DOC, DOCX files for job postings\n  app.post(\"/api/objects/upload-document\", isAuthenticated, isEmployer, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      if (!userId) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      // Validate file metadata from client claim\n      const { contentType, fileSize } = req.body;\n      \n      // Strict validation of claimed file properties\n      const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB for documents\n      const ALLOWED_TYPES = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n      \n      // Validate contentType\n      if (!contentType || typeof contentType !== 'string') {\n        return res.status(400).json({ message: \"Content type is required\" });\n      }\n      \n      if (!ALLOWED_TYPES.includes(contentType)) {\n        return res.status(400).json({ \n          message: \"Invalid file type. Only PDF and Word documents (.pdf, .doc, .docx) are allowed.\" \n        });\n      }\n      \n      // Validate fileSize\n      if (!fileSize || typeof fileSize !== 'number' || fileSize <= 0) {\n        return res.status(400).json({ message: \"Valid file size is required\" });\n      }\n      \n      if (fileSize > MAX_FILE_SIZE) {\n        return res.status(400).json({ \n          message: `File size must be under ${MAX_FILE_SIZE / 1024 / 1024}MB` \n        });\n      }\n\n      // Generate user-scoped path with sanitized extension\n      const timestamp = Date.now();\n      const randomId = Math.random().toString(36).substring(2, 15);\n      \n      // Strictly map contentType to extension (no user input)\n      const extensionMap: Record<string, string> = {\n        'application/pdf': 'pdf',\n        'application/msword': 'doc',\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'docx'\n      };\n      const extension = extensionMap[contentType];\n      \n      if (!extension) {\n        return res.status(400).json({ message: \"Unsupported content type\" });\n      }\n      \n      // Server-controlled path for requirement documents\n      const userScopedPath = `/users/${userId}/requirement-${timestamp}-${randomId}.${extension}`;\n\n      const objectStorageService = new ObjectStorageService();\n      const uploadURL = await objectStorageService.getObjectEntityUploadURL(userScopedPath);\n      \n      // Defensive check - ensure we got a valid URL\n      if (!uploadURL) {\n        console.error(\"ObjectStorageService returned falsy uploadURL for requirement document\");\n        return res.status(500).json({ message: \"Failed to generate upload URL - object storage misconfigured\" });\n      }\n      \n      res.json({ \n        uploadURL,\n        objectPath: userScopedPath,\n        expectedContentType: contentType,\n        expectedSize: fileSize\n      });\n    } catch (error: any) {\n      console.error(\"Get requirement document upload URL error:\", error);\n      res.status(500).json({ message: \"Failed to get upload URL\" });\n    }\n  });\n\n  app.put(\"/api/resume\", isAuthenticated, async (req, res) => {\n    try {\n      if (!req.body.resumeUrl) {\n        return res.status(400).json({ error: \"resumeUrl is required\" });\n      }\n\n      const objectStorageService = new ObjectStorageService();\n      const objectPath = await objectStorageService.trySetObjectEntityAclPolicy(\n        req.body.resumeUrl,\n        {\n          owner: getUserId(req),\n          visibility: \"private\",\n        },\n      );\n\n      const profile = await storage.getJobSeekerProfile(getUserId(req));\n      if (profile) {\n        await storage.updateJobSeekerProfile(profile.id, {\n          resumeUrl: objectPath,\n        });\n      }\n\n      res.status(200).json({ objectPath });\n    } catch (error: any) {\n      console.error(\"Error setting resume:\", error);\n      res.status(500).json({ error: \"Internal server error\" });\n    }\n  });\n\n  app.get(\"/objects/:objectPath(*)\", isAuthenticated, async (req, res) => {\n    try {\n      const userId = getUserId(req);\n      const objectStorageService = new ObjectStorageService();\n      const objectFile = await objectStorageService.getObjectEntityFile(req.path);\n      \n      const canAccess = await objectStorageService.canAccessObjectEntity({\n        objectFile,\n        userId: userId,\n        requestedPermission: ObjectPermission.READ,\n      });\n      \n      if (!canAccess) {\n        // Special case: Allow employers to view resumes of applicants who applied to their jobs\n        const user = await storage.getUser(userId);\n        if (user?.role === 'employer' && req.path.includes('/resume')) {\n          // Extract the user ID from the path (e.g., /users/123/resume-...)\n          const pathMatch = req.path.match(/\\/users\\/([^\\/]+)\\//);\n          if (pathMatch) {\n            const resumeOwnerId = pathMatch[1];\n            \n            // Check if the resume owner has applied to any of the employer's jobs\n            const employerJobs = await storage.getJobsByEmployer(userId);\n            for (const job of employerJobs) {\n              const applications = await storage.getApplicationsByJob(job.id);\n              const hasApplied = applications.some(app => app.seekerId === resumeOwnerId);\n              if (hasApplied) {\n                // Employer can access this resume because the user applied to their job\n                objectStorageService.downloadObject(objectFile, res);\n                return;\n              }\n            }\n          }\n        }\n        \n        // Also allow admins to view any document\n        if (user?.role === 'admin') {\n          objectStorageService.downloadObject(objectFile, res);\n          return;\n        }\n        \n        return res.sendStatus(401);\n      }\n      \n      objectStorageService.downloadObject(objectFile, res);\n    } catch (error) {\n      console.error(\"Error accessing object:\", error);\n      if (error instanceof ObjectNotFoundError) {\n        return res.sendStatus(404);\n      }\n      return res.sendStatus(500);\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","path":null,"size_bytes":79068,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"server/storage.ts":{"content":"import {\n  users,\n  jobSeekerProfiles,\n  workExperience,\n  education,\n  certifications,\n  employerProfiles,\n  jobs,\n  applications,\n  fraudAlerts,\n  activityLogs,\n  contactMessages,\n  type User,\n  type UpsertUser,\n  type InsertUser,\n  type JobSeekerProfile,\n  type InsertJobSeekerProfile,\n  type WorkExperience,\n  type InsertWorkExperience,\n  type Education,\n  type InsertEducation,\n  type Certification,\n  type InsertCertification,\n  type EmployerProfile,\n  type InsertEmployerProfile,\n  type Job,\n  type InsertJob,\n  type Application,\n  type InsertApplication,\n  type FraudAlert,\n  type InsertFraudAlert,\n  type ActivityLog,\n  type InsertActivityLog,\n  type ContactMessage,\n  type InsertContactMessage,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc, sql, ilike, or } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByVerificationToken(token: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  updateUser(id: string, data: Partial<User>): Promise<User>;\n  \n  // Job Seeker Profile operations\n  getJobSeekerProfile(userId: string): Promise<JobSeekerProfile | undefined>;\n  createJobSeekerProfile(profile: InsertJobSeekerProfile): Promise<JobSeekerProfile>;\n  updateJobSeekerProfile(id: string, data: Partial<JobSeekerProfile>): Promise<JobSeekerProfile>;\n  \n  // Work Experience operations\n  getWorkExperience(profileId: string): Promise<WorkExperience[]>;\n  createWorkExperience(experience: InsertWorkExperience): Promise<WorkExperience>;\n  deleteWorkExperience(id: string): Promise<void>;\n  \n  // Education operations\n  getEducation(profileId: string): Promise<Education[]>;\n  createEducation(edu: InsertEducation): Promise<Education>;\n  deleteEducation(id: string): Promise<void>;\n  \n  // Certification operations\n  getCertifications(profileId: string): Promise<Certification[]>;\n  createCertification(cert: InsertCertification): Promise<Certification>;\n  deleteCertification(id: string): Promise<void>;\n  \n  // Employer Profile operations\n  getEmployerProfile(userId: string): Promise<EmployerProfile | undefined>;\n  createEmployerProfile(profile: InsertEmployerProfile): Promise<EmployerProfile>;\n  updateEmployerProfile(id: string, data: Partial<EmployerProfile>): Promise<EmployerProfile>;\n  \n  // Job operations\n  getAllJobs(filters?: any): Promise<Job[]>;\n  getJob(id: string): Promise<Job | undefined>;\n  getJobsByEmployer(employerId: string): Promise<Job[]>;\n  createJob(job: InsertJob): Promise<Job>;\n  updateJob(id: string, data: Partial<Job>): Promise<Job>;\n  deleteJob(id: string): Promise<void>;\n  \n  // Application operations\n  getAllApplications(): Promise<Application[]>;\n  getApplication(id: string): Promise<Application | undefined>;\n  getApplicationsBySeeker(seekerId: string): Promise<Application[]>;\n  getApplicationsByJob(jobId: string): Promise<Application[]>;\n  createApplication(application: InsertApplication): Promise<Application>;\n  updateApplication(id: string, data: Partial<Application>): Promise<Application>;\n  \n  // Fraud Alert operations\n  getAllFraudAlerts(): Promise<FraudAlert[]>;\n  getFraudAlert(id: string): Promise<FraudAlert | null>;\n  getPendingFraudAlerts(): Promise<FraudAlert[]>;\n  createFraudAlert(alert: InsertFraudAlert): Promise<FraudAlert>;\n  updateFraudAlert(id: string, data: Partial<FraudAlert>): Promise<FraudAlert>;\n  \n  // Admin operations\n  getAllUsers(): Promise<User[]>;\n  getUsersWithStats(): Promise<any[]>;\n  deleteUser(id: string): Promise<void>;\n  \n  // Activity Log operations\n  getRecentActivityLogs(limit?: number): Promise<ActivityLog[]>;\n  createActivityLog(log: InsertActivityLog): Promise<ActivityLog>;\n  \n  // Contact Message operations\n  getAllContactMessages(): Promise<ContactMessage[]>;\n  getContactMessagesByStatus(status: string): Promise<ContactMessage[]>;\n  createContactMessage(message: InsertContactMessage): Promise<ContactMessage>;\n  updateContactMessage(id: string, data: Partial<ContactMessage>): Promise<ContactMessage>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user || undefined;\n  }\n\n  async getUserByVerificationToken(token: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.emailVerificationToken, token));\n    return user || undefined;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  async updateUser(id: string, data: Partial<User>): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  // Job Seeker Profile operations\n  async getJobSeekerProfile(userId: string): Promise<JobSeekerProfile | undefined> {\n    const [profile] = await db\n      .select()\n      .from(jobSeekerProfiles)\n      .where(eq(jobSeekerProfiles.userId, userId));\n    return profile || undefined;\n  }\n\n  async createJobSeekerProfile(profile: InsertJobSeekerProfile): Promise<JobSeekerProfile> {\n    const [newProfile] = await db.insert(jobSeekerProfiles).values(profile).returning();\n    return newProfile;\n  }\n\n  async updateJobSeekerProfile(id: string, data: Partial<JobSeekerProfile>): Promise<JobSeekerProfile> {\n    const [profile] = await db\n      .update(jobSeekerProfiles)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(jobSeekerProfiles.id, id))\n      .returning();\n    return profile;\n  }\n\n  // Work Experience operations\n  async getWorkExperience(profileId: string): Promise<WorkExperience[]> {\n    return await db\n      .select()\n      .from(workExperience)\n      .where(eq(workExperience.profileId, profileId))\n      .orderBy(desc(workExperience.startDate));\n  }\n\n  async createWorkExperience(experience: InsertWorkExperience): Promise<WorkExperience> {\n    const [exp] = await db.insert(workExperience).values(experience).returning();\n    return exp;\n  }\n\n  async deleteWorkExperience(id: string): Promise<void> {\n    await db.delete(workExperience).where(eq(workExperience.id, id));\n  }\n\n  // Education operations\n  async getEducation(profileId: string): Promise<Education[]> {\n    return await db\n      .select()\n      .from(education)\n      .where(eq(education.profileId, profileId))\n      .orderBy(desc(education.startYear));\n  }\n\n  async createEducation(edu: InsertEducation): Promise<Education> {\n    const [newEdu] = await db.insert(education).values(edu).returning();\n    return newEdu;\n  }\n\n  async deleteEducation(id: string): Promise<void> {\n    await db.delete(education).where(eq(education.id, id));\n  }\n\n  // Certification operations\n  async getCertifications(profileId: string): Promise<Certification[]> {\n    return await db\n      .select()\n      .from(certifications)\n      .where(eq(certifications.profileId, profileId))\n      .orderBy(desc(certifications.issueDate));\n  }\n\n  async createCertification(cert: InsertCertification): Promise<Certification> {\n    const [newCert] = await db.insert(certifications).values(cert).returning();\n    return newCert;\n  }\n\n  async deleteCertification(id: string): Promise<void> {\n    await db.delete(certifications).where(eq(certifications.id, id));\n  }\n\n  // Employer Profile operations\n  async getEmployerProfile(userId: string): Promise<EmployerProfile | undefined> {\n    const [profile] = await db\n      .select()\n      .from(employerProfiles)\n      .where(eq(employerProfiles.userId, userId));\n    return profile || undefined;\n  }\n\n  async createEmployerProfile(profile: InsertEmployerProfile): Promise<EmployerProfile> {\n    const [newProfile] = await db.insert(employerProfiles).values(profile).returning();\n    return newProfile;\n  }\n\n  async updateEmployerProfile(id: string, data: Partial<EmployerProfile>): Promise<EmployerProfile> {\n    const [profile] = await db\n      .update(employerProfiles)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(employerProfiles.id, id))\n      .returning();\n    return profile;\n  }\n\n  // Job operations\n  async getAllJobs(filters?: any): Promise<Job[]> {\n    let query = db.select().from(jobs);\n    \n    if (filters?.isActive !== undefined) {\n      query = query.where(eq(jobs.isActive, filters.isActive)) as any;\n    }\n    \n    return await query.orderBy(desc(jobs.createdAt));\n  }\n\n  async getJob(id: string): Promise<Job | undefined> {\n    const [job] = await db.select().from(jobs).where(eq(jobs.id, id));\n    return job || undefined;\n  }\n\n  async getJobsByEmployer(employerId: string): Promise<Job[]> {\n    return await db\n      .select()\n      .from(jobs)\n      .where(eq(jobs.employerId, employerId))\n      .orderBy(desc(jobs.createdAt));\n  }\n\n  async createJob(job: InsertJob): Promise<Job> {\n    const [newJob] = await db.insert(jobs).values(job).returning();\n    return newJob;\n  }\n\n  async updateJob(id: string, data: Partial<Job>): Promise<Job> {\n    const [job] = await db\n      .update(jobs)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(jobs.id, id))\n      .returning();\n    return job;\n  }\n\n  async deleteJob(id: string): Promise<void> {\n    await db.delete(jobs).where(eq(jobs.id, id));\n  }\n\n  // Application operations\n  async getAllApplications(): Promise<Application[]> {\n    return await db\n      .select()\n      .from(applications)\n      .orderBy(desc(applications.createdAt));\n  }\n\n  async getApplication(id: string): Promise<Application | undefined> {\n    const [app] = await db\n      .select()\n      .from(applications)\n      .where(eq(applications.id, id))\n      .limit(1);\n    return app || undefined;\n  }\n\n  async getApplicationsBySeeker(seekerId: string): Promise<Application[]> {\n    return await db\n      .select()\n      .from(applications)\n      .where(eq(applications.seekerId, seekerId))\n      .orderBy(desc(applications.createdAt));\n  }\n\n  async getApplicationsByJob(jobId: string): Promise<Application[]> {\n    return await db\n      .select()\n      .from(applications)\n      .where(eq(applications.jobId, jobId))\n      .orderBy(desc(applications.createdAt));\n  }\n\n  async createApplication(application: InsertApplication): Promise<Application> {\n    const [app] = await db.insert(applications).values(application).returning();\n    return app;\n  }\n\n  async updateApplication(id: string, data: Partial<Application>): Promise<Application> {\n    const [app] = await db\n      .update(applications)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(applications.id, id))\n      .returning();\n    return app;\n  }\n\n  // Fraud Alert operations\n  async getAllFraudAlerts(): Promise<FraudAlert[]> {\n    return await db\n      .select()\n      .from(fraudAlerts)\n      .orderBy(desc(fraudAlerts.createdAt));\n  }\n\n  async getFraudAlert(id: string): Promise<FraudAlert | null> {\n    const [alert] = await db\n      .select()\n      .from(fraudAlerts)\n      .where(eq(fraudAlerts.id, id))\n      .limit(1);\n    return alert || null;\n  }\n\n  async getPendingFraudAlerts(): Promise<FraudAlert[]> {\n    return await db\n      .select()\n      .from(fraudAlerts)\n      .where(eq(fraudAlerts.status, \"pending\"))\n      .orderBy(desc(fraudAlerts.createdAt));\n  }\n\n  async createFraudAlert(alert: InsertFraudAlert): Promise<FraudAlert> {\n    const [newAlert] = await db.insert(fraudAlerts).values(alert).returning();\n    return newAlert;\n  }\n\n  async updateFraudAlert(id: string, data: Partial<FraudAlert>): Promise<FraudAlert> {\n    const [alert] = await db\n      .update(fraudAlerts)\n      .set(data)\n      .where(eq(fraudAlerts.id, id))\n      .returning();\n    return alert;\n  }\n\n  // Admin operations\n  async getAllUsers(): Promise<User[]> {\n    return await db\n      .select()\n      .from(users)\n      .orderBy(desc(users.createdAt));\n  }\n\n  async getUsersWithStats(): Promise<any[]> {\n    // Get all users with aggregated statistics and full details\n    const allUsers = await this.getAllUsers();\n    const allFraudAlerts = await this.getAllFraudAlerts();\n    \n    const usersWithStats = await Promise.all(\n      allUsers.map(async (user) => {\n        let stats: any = {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          role: user.role,\n          isEmailVerified: user.isEmailVerified,\n          createdAt: user.createdAt,\n          flagged: user.isFlagged,\n        };\n\n        // Include fraud alert info if user is flagged\n        if (user.isFlagged) {\n          const userAlerts = allFraudAlerts.filter(\n            alert => alert.entityType === 'user' && alert.entityId === user.id\n          );\n          if (userAlerts.length > 0) {\n            // Get the most recent alert for this user\n            const latestAlert = userAlerts.sort((a, b) => \n              new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n            )[0];\n            stats.fraudAlertReason = latestAlert.description;\n            stats.fraudAlertType = latestAlert.alertType;\n            stats.fraudAlertConfidence = latestAlert.aiConfidence;\n            stats.fraudAlertStatus = latestAlert.status;\n          }\n        }\n\n        if (user.role === 'job_seeker') {\n          const profile = await this.getJobSeekerProfile(user.id);\n          const apps = await this.getApplicationsBySeeker(profile?.id || '');\n          stats.totalApplications = apps.length;\n          stats.profileComplete = !!profile?.headline;\n          \n          // Include profile details\n          if (profile) {\n            stats.headline = profile.headline;\n            stats.bio = profile.bio;\n            stats.location = profile.location;\n            stats.phoneNumber = profile.phoneNumber;\n            stats.skills = profile.skills;\n            stats.resumeUrl = profile.resumeUrl;\n            stats.profilePictureUrl = profile.profileImage;\n            stats.portfolioUrl = profile.portfolioUrl;\n          }\n        } else if (user.role === 'employer') {\n          const profile = await this.getEmployerProfile(user.id);\n          const employerJobs = await this.getJobsByEmployer(user.id);\n          stats.totalJobs = employerJobs.length;\n          \n          // Include employer profile details\n          if (profile) {\n            stats.companyName = profile.companyName;\n            stats.bio = profile.companyDescription;\n            stats.location = profile.location;\n            stats.website = profile.companyWebsite;\n            stats.phoneNumber = profile.phoneNumber;\n            stats.profilePictureUrl = profile.companyLogo;\n          }\n        }\n\n        return stats;\n      })\n    );\n\n    return usersWithStats;\n  }\n\n  async deleteUser(userId: string): Promise<void> {\n    const user = await this.getUser(userId);\n    if (!user) {\n      throw new Error(\"User not found\");\n    }\n\n    // Cascade delete based on user role\n    if (user.role === 'job_seeker') {\n      const profile = await this.getJobSeekerProfile(userId);\n      if (profile) {\n        // Delete work experience\n        const experiences = await this.getWorkExperience(profile.id);\n        for (const exp of experiences) {\n          await db.delete(workExperience).where(eq(workExperience.id, exp.id));\n        }\n\n        // Delete education\n        const educations = await this.getEducation(profile.id);\n        for (const edu of educations) {\n          await db.delete(education).where(eq(education.id, edu.id));\n        }\n\n        // Delete certifications\n        const certs = await this.getCertifications(profile.id);\n        for (const cert of certs) {\n          await db.delete(certifications).where(eq(certifications.id, cert.id));\n        }\n\n        // Delete applications\n        const apps = await this.getApplicationsBySeeker(profile.id);\n        for (const app of apps) {\n          await db.delete(applications).where(eq(applications.id, app.id));\n        }\n\n        // Delete profile\n        await db.delete(jobSeekerProfiles).where(eq(jobSeekerProfiles.userId, userId));\n      }\n    } else if (user.role === 'employer') {\n      const profile = await this.getEmployerProfile(userId);\n      if (profile) {\n        // Delete all jobs posted by employer (and their applications)\n        const employerJobs = await this.getJobsByEmployer(userId);\n        for (const job of employerJobs) {\n          // Delete applications for this job\n          await db.delete(applications).where(eq(applications.jobId, job.id));\n          // Delete the job\n          await db.delete(jobs).where(eq(jobs.id, job.id));\n        }\n\n        // Delete employer profile\n        await db.delete(employerProfiles).where(eq(employerProfiles.userId, userId));\n      }\n    }\n\n    // Delete fraud alerts related to this user\n    await db.delete(fraudAlerts).where(\n      and(\n        eq(fraudAlerts.entityType, \"user\"),\n        eq(fraudAlerts.entityId, userId)\n      )\n    );\n\n    // Finally, delete the user\n    await db.delete(users).where(eq(users.id, userId));\n  }\n\n  // Activity Log operations\n  async getRecentActivityLogs(limit: number = 50): Promise<ActivityLog[]> {\n    return await db\n      .select()\n      .from(activityLogs)\n      .orderBy(desc(activityLogs.createdAt))\n      .limit(limit);\n  }\n\n  async createActivityLog(log: InsertActivityLog): Promise<ActivityLog> {\n    const [newLog] = await db.insert(activityLogs).values(log).returning();\n    return newLog;\n  }\n\n  // Contact Message operations\n  async getAllContactMessages(): Promise<ContactMessage[]> {\n    return await db\n      .select()\n      .from(contactMessages)\n      .orderBy(desc(contactMessages.createdAt));\n  }\n\n  async getContactMessagesByStatus(status: string): Promise<ContactMessage[]> {\n    return await db\n      .select()\n      .from(contactMessages)\n      .where(eq(contactMessages.status, status))\n      .orderBy(desc(contactMessages.createdAt));\n  }\n\n  async createContactMessage(message: InsertContactMessage): Promise<ContactMessage> {\n    const [newMessage] = await db.insert(contactMessages).values(message).returning();\n    return newMessage;\n  }\n\n  async updateContactMessage(id: string, data: Partial<ContactMessage>): Promise<ContactMessage> {\n    const [message] = await db\n      .update(contactMessages)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(contactMessages.id, id))\n      .returning();\n    return message;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":19087,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"server/email.ts":{"content":"import { getUncachableResendClient } from './resend-client';\nimport crypto from 'crypto';\n\nconst ADMIN_EMAIL = 'admin@zambajobs.digital';\n\nasync function sendEmail(to: string, subject: string, html: string): Promise<void> {\n  try {\n    const { client } = await getUncachableResendClient();\n    const fromEmail = 'noreply@zambajobs.digital';\n    \n    console.log(`Attempting to send email from ${fromEmail} to ${to}...`);\n    \n    const result = await client.emails.send({\n      from: fromEmail,\n      to,\n      subject,\n      html,\n    });\n    \n    console.log(`✅ Email sent successfully! ID: ${result.data?.id}, From: ${fromEmail}, To: ${to}, Subject: ${subject}`);\n    console.log('Resend response:', JSON.stringify(result, null, 2));\n  } catch (error: any) {\n    console.error('❌ Failed to send email:', error);\n    console.error('Error details:', JSON.stringify(error, null, 2));\n    throw new Error(`Email sending failed: ${error.message || 'Unknown error'}`);\n  }\n}\n\nexport function generateOTP(): string {\n  return crypto.randomInt(100000, 1000000).toString();\n}\n\nexport async function sendOTPEmail(\n  email: string,\n  otp: string,\n  firstName?: string\n): Promise<void> {\n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n        .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n        .header { background: linear-gradient(135deg, #EAB308 0%, #F59E0B 100%); color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }\n        .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px; }\n        .otp-box { background: white; border: 2px dashed #EAB308; border-radius: 8px; padding: 20px; text-align: center; margin: 20px 0; }\n        .otp-code { font-size: 32px; font-weight: bold; color: #EAB308; letter-spacing: 8px; }\n        .footer { text-align: center; margin-top: 20px; font-size: 12px; color: #666; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        <div class=\"header\">\n          <h1>🔐 ZambaJobs Verification Code</h1>\n        </div>\n        <div class=\"content\">\n          <p>Hi${firstName ? ` ${firstName}` : ''},</p>\n          <p>Your verification code for ZambaJobs is:</p>\n          \n          <div class=\"otp-box\">\n            <div class=\"otp-code\">${otp}</div>\n          </div>\n          \n          <p><strong>This code will expire in 10 minutes.</strong></p>\n          <p>If you didn't request this code, please ignore this email.</p>\n          \n          <p>Need help? Contact us at support@zambajobs.digital</p>\n        </div>\n        <div class=\"footer\">\n          <p>© 2025 ZambaJobs. Connecting talent with opportunity in the Philippines.</p>\n        </div>\n      </div>\n    </body>\n    </html>\n  `;\n  \n  await sendEmail(email, 'Your ZambaJobs Verification Code', html);\n}\n\nexport async function sendPasswordResetEmail(\n  email: string,\n  token: string,\n  firstName?: string\n): Promise<void> {\n  const resetUrl = `${process.env.APP_URL || 'http://localhost:5000'}/reset-password?token=${token}`;\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n        .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n        .header { background: linear-gradient(135deg, #EAB308 0%, #F59E0B 100%); color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }\n        .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px; }\n        .button { display: inline-block; background: #EAB308; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; margin: 20px 0; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        <div class=\"header\">\n          <h1>🔑 Password Reset Request</h1>\n        </div>\n        <div class=\"content\">\n          <p>Hi${firstName ? ` ${firstName}` : ''},</p>\n          <p>We received a request to reset your password. Click the button below to set a new password:</p>\n          \n          <p style=\"text-align: center;\">\n            <a href=\"${resetUrl}\" class=\"button\">Reset Password</a>\n          </p>\n          \n          <p><strong>This link will expire in 1 hour.</strong></p>\n          <p>If you didn't request a password reset, please ignore this email and your password will remain unchanged.</p>\n        </div>\n      </div>\n    </body>\n    </html>\n  `;\n  \n  await sendEmail(email, 'Reset your ZambaJobs password', html);\n}\n\nexport async function sendFraudAlertEmail(\n  alertType: string,\n  description: string,\n  entityType: string,\n  entityId: string,\n  confidence: number\n): Promise<void> {\n  const dashboardUrl = `${process.env.APP_URL || 'http://localhost:5000'}/admin/fraud-detection`;\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n        .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n        .header { background: linear-gradient(135deg, #DC2626 0%, #EF4444 100%); color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }\n        .content { background: #fff; padding: 30px; border: 2px solid #DC2626; border-radius: 0 0 8px 8px; }\n        .alert-box { background: #FEE2E2; border-left: 4px solid #DC2626; padding: 15px; margin: 20px 0; }\n        .confidence { font-size: 24px; font-weight: bold; color: #DC2626; }\n        .button { display: inline-block; background: #DC2626; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; margin: 20px 0; }\n        ul { background: #f9f9f9; padding: 20px; border-radius: 6px; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        <div class=\"header\">\n          <h1>🚨 URGENT: Fraud Detection Alert</h1>\n        </div>\n        <div class=\"content\">\n          <div class=\"alert-box\">\n            <p><strong>⚠️ The AI fraud detection system has flagged potentially fraudulent activity that requires immediate review.</strong></p>\n          </div>\n          \n          <h3>Alert Details:</h3>\n          <ul>\n            <li><strong>Alert Type:</strong> ${alertType}</li>\n            <li><strong>Entity Type:</strong> ${entityType}</li>\n            <li><strong>Entity ID:</strong> ${entityId}</li>\n            <li><strong>AI Confidence:</strong> <span class=\"confidence\">${confidence}%</span></li>\n          </ul>\n          \n          <h3>Description:</h3>\n          <p>${description}</p>\n          \n          <p style=\"text-align: center;\">\n            <a href=\"${dashboardUrl}\" class=\"button\">Review in Admin Dashboard</a>\n          </p>\n          \n          <p><strong>Recommended Action:</strong> Please review this alert immediately and take appropriate action (flag account, suspend listing, or dismiss if false positive).</p>\n        </div>\n      </div>\n    </body>\n    </html>\n  `;\n  \n  await sendEmail(ADMIN_EMAIL, `🚨 Fraud Alert: ${alertType} (${confidence}% confidence)`, html);\n}\n\nexport async function sendApplicationStatusEmail(\n  email: string,\n  jobTitle: string,\n  status: string,\n  firstName?: string\n): Promise<void> {\n  const statusMessages = {\n    reviewing: \"is being reviewed\",\n    shortlisted: \"has been shortlisted! 🎉\",\n    rejected: \"was not selected this time\",\n    accepted: \"has been accepted! 🎉 Congratulations!\",\n  };\n\n  const message = statusMessages[status as keyof typeof statusMessages] || \"has been updated\";\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n        .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n        .header { background: linear-gradient(135deg, #EAB308 0%, #F59E0B 100%); color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }\n        .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        <div class=\"header\">\n          <h1>📋 Application Status Update</h1>\n        </div>\n        <div class=\"content\">\n          <p>Hi${firstName ? ` ${firstName}` : ''},</p>\n          <p>Your application for <strong>${jobTitle}</strong> ${message}.</p>\n          <p>Log in to your ZambaJobs account to view more details.</p>\n        </div>\n      </div>\n    </body>\n    </html>\n  `;\n  \n  await sendEmail(email, `Application Update: ${jobTitle}`, html);\n}\n","path":null,"size_bytes":8579,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { relations } from \"drizzle-orm\";\n\n// Session storage table (required for Replit Auth)\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// Users table with hybrid authentication (Replit Auth + legacy email/password)\n// IMPORTANT: Replit Auth requires id, email, firstName, lastName, profileImageUrl\nexport const users = pgTable(\"users\", {\n  // Replit Auth fields (keep default for migration compatibility)\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(), // nullable - some Replit login methods don't have emails\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  \n  // Legacy authentication fields (keep during migration)\n  password: varchar(\"password\"), // nullable for OAuth users\n  isEmailVerified: boolean(\"is_email_verified\").default(false),\n  emailVerificationToken: varchar(\"email_verification_token\"),\n  emailVerificationTokenExpiry: timestamp(\"email_verification_token_expiry\"),\n  passwordResetToken: varchar(\"password_reset_token\"),\n  passwordResetExpiry: timestamp(\"password_reset_expiry\"),\n  otp: varchar(\"otp\"),\n  otpExpiry: timestamp(\"otp_expiry\"),\n  otpAttempts: integer(\"otp_attempts\").default(0),\n  lastOtpResendAt: timestamp(\"last_otp_resend_at\"),\n  otpResendCount: integer(\"otp_resend_count\").default(0),\n  otpResendHourStart: timestamp(\"otp_resend_hour_start\"),\n  \n  // ZambaJobs-specific fields\n  role: varchar(\"role\", { enum: [\"job_seeker\", \"employer\", \"admin\"] }),\n  isFlagged: boolean(\"is_flagged\").default(false).notNull(),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Job Seeker profiles\nexport const jobSeekerProfiles = pgTable(\"job_seeker_profiles\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  profileImage: varchar(\"profile_image\"),\n  headline: text(\"headline\"),\n  bio: text(\"bio\"),\n  skills: text(\"skills\").array(),\n  resumeUrl: varchar(\"resume_url\"),\n  linkedinUrl: varchar(\"linkedin_url\"),\n  portfolioUrl: varchar(\"portfolio_url\"),\n  location: varchar(\"location\"),\n  phoneNumber: varchar(\"phone_number\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Work Experience\nexport const workExperience = pgTable(\"work_experience\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  profileId: varchar(\"profile_id\").notNull().references(() => jobSeekerProfiles.id, { onDelete: \"cascade\" }),\n  companyName: varchar(\"company_name\").notNull(),\n  position: varchar(\"position\").notNull(),\n  location: varchar(\"location\"),\n  startDate: varchar(\"start_date\").notNull(),\n  endDate: varchar(\"end_date\"),\n  isCurrent: boolean(\"is_current\").default(false).notNull(),\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Education\nexport const education = pgTable(\"education\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  profileId: varchar(\"profile_id\").notNull().references(() => jobSeekerProfiles.id, { onDelete: \"cascade\" }),\n  institution: varchar(\"institution\").notNull(),\n  degree: varchar(\"degree\").notNull(),\n  fieldOfStudy: varchar(\"field_of_study\"),\n  startYear: varchar(\"start_year\").notNull(),\n  endYear: varchar(\"end_year\"),\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Certifications\nexport const certifications = pgTable(\"certifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  profileId: varchar(\"profile_id\").notNull().references(() => jobSeekerProfiles.id, { onDelete: \"cascade\" }),\n  name: varchar(\"name\").notNull(),\n  issuer: varchar(\"issuer\").notNull(),\n  issueDate: varchar(\"issue_date\"),\n  expiryDate: varchar(\"expiry_date\"),\n  credentialUrl: varchar(\"credential_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Employer profiles\nexport const employerProfiles = pgTable(\"employer_profiles\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  companyName: varchar(\"company_name\").notNull(),\n  companyLogo: varchar(\"company_logo\"),\n  companyWebsite: varchar(\"company_website\"),\n  companyDescription: text(\"company_description\"),\n  industry: varchar(\"industry\"),\n  location: varchar(\"location\"),\n  phoneNumber: varchar(\"phone_number\"),\n  isVerified: boolean(\"is_verified\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Job postings\nexport const jobs = pgTable(\"jobs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  employerId: varchar(\"employer_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  title: varchar(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  requirements: text(\"requirements\").array(),\n  responsibilities: text(\"responsibilities\").array(),\n  skills: text(\"skills\").array(),\n  location: varchar(\"location\").notNull(),\n  jobType: varchar(\"job_type\", { enum: [\"full_time\", \"part_time\", \"contract\", \"remote\", \"hybrid\"] }).notNull(),\n  salaryMin: integer(\"salary_min\"),\n  salaryMax: integer(\"salary_max\"),\n  salaryCurrency: varchar(\"salary_currency\").default(\"USD\"),\n  category: varchar(\"category\"),\n  requirementDocumentUrl: varchar(\"requirement_document_url\"),\n  isActive: boolean(\"is_active\").default(true).notNull(),\n  isFlagged: boolean(\"is_flagged\").default(false).notNull(),\n  aiMatchScore: integer(\"ai_match_score\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Job applications\nexport const applications = pgTable(\"applications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  jobId: varchar(\"job_id\").notNull().references(() => jobs.id, { onDelete: \"cascade\" }),\n  seekerId: varchar(\"seeker_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  coverLetter: text(\"cover_letter\"),\n  status: varchar(\"status\", { enum: [\"applied\", \"reviewing\", \"shortlisted\", \"rejected\", \"accepted\"] }).notNull().default(\"applied\"),\n  aiMatchScore: integer(\"ai_match_score\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Fraud alerts\nexport const fraudAlerts = pgTable(\"fraud_alerts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  entityType: varchar(\"entity_type\", { enum: [\"user\", \"job\", \"application\"] }).notNull(),\n  entityId: varchar(\"entity_id\").notNull(),\n  alertType: varchar(\"alert_type\").notNull(),\n  description: text(\"description\").notNull(),\n  aiConfidence: integer(\"ai_confidence\").notNull(),\n  status: varchar(\"status\", { enum: [\"pending\", \"reviewed\", \"dismissed\", \"confirmed\"] }).notNull().default(\"pending\"),\n  reviewedBy: varchar(\"reviewed_by\").references(() => users.id),\n  reviewNotes: text(\"review_notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  reviewedAt: timestamp(\"reviewed_at\"),\n});\n\n// Activity Logs - track platform activities for admin dashboard\nexport const activityLogs = pgTable(\"activity_logs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id, { onDelete: \"set null\" }), // nullable for system events\n  entityType: varchar(\"entity_type\", { enum: [\"user\", \"job\", \"application\", \"profile\", \"fraud_alert\", \"system\"] }).notNull(),\n  entityId: varchar(\"entity_id\"), // nullable for system-level events\n  action: varchar(\"action\").notNull(), // e.g., \"created\", \"updated\", \"deleted\", \"flagged\", \"verified\"\n  description: text(\"description\").notNull(),\n  metadata: jsonb(\"metadata\"), // Additional context (IP, session, etc.)\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => [\n  index(\"idx_activity_entity\").on(table.entityType, table.entityId),\n  index(\"idx_activity_created\").on(table.createdAt),\n]);\n\n// Contact Messages - support/contact form submissions\nexport const contactMessages = pgTable(\"contact_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id, { onDelete: \"set null\" }), // nullable for non-authenticated users\n  name: varchar(\"name\").notNull(),\n  email: varchar(\"email\").notNull(),\n  subject: varchar(\"subject\"),\n  message: text(\"message\").notNull(),\n  status: varchar(\"status\", { enum: [\"new\", \"read\", \"replied\", \"archived\"] }).notNull().default(\"new\"),\n  priority: varchar(\"priority\", { enum: [\"low\", \"normal\", \"high\", \"urgent\"] }).notNull().default(\"normal\"),\n  repliedBy: varchar(\"replied_by\").references(() => users.id),\n  replyMessage: text(\"reply_message\"),\n  handledAt: timestamp(\"handled_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n}, (table) => [\n  index(\"idx_contact_status\").on(table.status),\n  index(\"idx_contact_created\").on(table.createdAt),\n]);\n\n// Relations\nexport const usersRelations = relations(users, ({ one }) => ({\n  jobSeekerProfile: one(jobSeekerProfiles, {\n    fields: [users.id],\n    references: [jobSeekerProfiles.userId],\n  }),\n  employerProfile: one(employerProfiles, {\n    fields: [users.id],\n    references: [employerProfiles.userId],\n  }),\n}));\n\nexport const jobSeekerProfilesRelations = relations(jobSeekerProfiles, ({ one, many }) => ({\n  user: one(users, {\n    fields: [jobSeekerProfiles.userId],\n    references: [users.id],\n  }),\n  workExperience: many(workExperience),\n  education: many(education),\n  certifications: many(certifications),\n}));\n\nexport const workExperienceRelations = relations(workExperience, ({ one }) => ({\n  profile: one(jobSeekerProfiles, {\n    fields: [workExperience.profileId],\n    references: [jobSeekerProfiles.id],\n  }),\n}));\n\nexport const educationRelations = relations(education, ({ one }) => ({\n  profile: one(jobSeekerProfiles, {\n    fields: [education.profileId],\n    references: [jobSeekerProfiles.id],\n  }),\n}));\n\nexport const certificationsRelations = relations(certifications, ({ one }) => ({\n  profile: one(jobSeekerProfiles, {\n    fields: [certifications.profileId],\n    references: [jobSeekerProfiles.id],\n  }),\n}));\n\nexport const employerProfilesRelations = relations(employerProfiles, ({ one }) => ({\n  user: one(users, {\n    fields: [employerProfiles.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const jobsRelations = relations(jobs, ({ one, many }) => ({\n  employer: one(users, {\n    fields: [jobs.employerId],\n    references: [users.id],\n  }),\n  applications: many(applications),\n}));\n\nexport const applicationsRelations = relations(applications, ({ one }) => ({\n  job: one(jobs, {\n    fields: [applications.jobId],\n    references: [jobs.id],\n  }),\n  seeker: one(users, {\n    fields: [applications.seekerId],\n    references: [users.id],\n  }),\n}));\n\n// Zod schemas for validation\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  isEmailVerified: true,\n  emailVerificationToken: true,\n  emailVerificationTokenExpiry: true,\n  passwordResetToken: true,\n  passwordResetExpiry: true,\n  otp: true,\n  otpExpiry: true,\n  otpAttempts: true,\n  lastOtpResendAt: true,\n  otpResendCount: true,\n  otpResendHourStart: true,\n  isFlagged: true,\n});\n\nexport const insertJobSeekerProfileSchema = createInsertSchema(jobSeekerProfiles).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertWorkExperienceSchema = createInsertSchema(workExperience).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertEducationSchema = createInsertSchema(education).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertCertificationSchema = createInsertSchema(certifications).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertEmployerProfileSchema = createInsertSchema(employerProfiles).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  isVerified: true,\n});\n\nexport const insertJobSchema = createInsertSchema(jobs).omit({\n  id: true,\n  employerId: true, // Omit because it's added from authenticated session\n  createdAt: true,\n  updatedAt: true,\n  isActive: true,\n  isFlagged: true,\n  aiMatchScore: true,\n});\n\nexport const insertApplicationSchema = createInsertSchema(applications).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  status: true,\n  aiMatchScore: true,\n});\n\nexport const insertFraudAlertSchema = createInsertSchema(fraudAlerts).omit({\n  id: true,\n  createdAt: true,\n  reviewedAt: true,\n  status: true,\n});\n\nexport const insertActivityLogSchema = createInsertSchema(activityLogs).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertContactMessageSchema = createInsertSchema(contactMessages).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  status: true,\n  handledAt: true,\n});\n\n// TypeScript types\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type UpsertUser = typeof users.$inferInsert;\n\nexport type JobSeekerProfile = typeof jobSeekerProfiles.$inferSelect;\nexport type InsertJobSeekerProfile = z.infer<typeof insertJobSeekerProfileSchema>;\n\nexport type WorkExperience = typeof workExperience.$inferSelect;\nexport type InsertWorkExperience = z.infer<typeof insertWorkExperienceSchema>;\n\nexport type Education = typeof education.$inferSelect;\nexport type InsertEducation = z.infer<typeof insertEducationSchema>;\n\nexport type Certification = typeof certifications.$inferSelect;\nexport type InsertCertification = z.infer<typeof insertCertificationSchema>;\n\nexport type EmployerProfile = typeof employerProfiles.$inferSelect;\nexport type InsertEmployerProfile = z.infer<typeof insertEmployerProfileSchema>;\n\nexport type Job = typeof jobs.$inferSelect;\nexport type InsertJob = z.infer<typeof insertJobSchema>;\n\nexport type Application = typeof applications.$inferSelect;\nexport type InsertApplication = z.infer<typeof insertApplicationSchema>;\n\nexport type FraudAlert = typeof fraudAlerts.$inferSelect;\nexport type InsertFraudAlert = z.infer<typeof insertFraudAlertSchema>;\n\nexport type ActivityLog = typeof activityLogs.$inferSelect;\nexport type InsertActivityLog = z.infer<typeof insertActivityLogSchema>;\n\nexport type ContactMessage = typeof contactMessages.$inferSelect;\nexport type InsertContactMessage = z.infer<typeof insertContactMessageSchema>;\n","path":null,"size_bytes":15105,"size_tokens":null},"client/src/pages/jobs.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Search, MapPin, Briefcase, Clock, Bookmark, Sparkles, Building2 } from \"lucide-react\";\nimport { formatPesoRange } from \"@/lib/philippines\";\nimport type { Job } from \"@shared/schema\";\n\nexport default function Jobs() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [location, setLocation] = useState(\"\");\n  const [jobType, setJobType] = useState<string>(\"all\");\n  const [category, setCategory] = useState<string>(\"all\");\n\n  const { data: jobs, isLoading } = useQuery<Job[]>({\n    queryKey: [\"/api/jobs\", { search: searchTerm, location, jobType, category }],\n  });\n\n  const filteredJobs = jobs?.filter(job => job.isActive && !job.isFlagged) || [];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"container max-w-7xl mx-auto flex h-16 items-center justify-between px-4 md:px-6 lg:px-8\">\n          <Link href=\"/jobs\">\n            <div className=\"flex items-center gap-2 hover-elevate active-elevate-2 rounded-md px-3 py-2\">\n              <Briefcase className=\"h-6 w-6 text-primary\" />\n              <span className=\"text-xl font-bold\">ZambaJobs</span>\n            </div>\n          </Link>\n          \n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/dashboard\">\n              <Button variant=\"ghost\" data-testid=\"button-dashboard\">\n                Dashboard\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      {/* Search Section */}\n      <section className=\"border-b bg-muted/30 py-8\">\n        <div className=\"container max-w-7xl mx-auto px-4 md:px-6 lg:px-8\">\n          <h1 className=\"mb-6 text-3xl font-bold\">Find Your Next Opportunity</h1>\n          \n          <div className=\"flex flex-col gap-4 md:flex-row\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n              <Input\n                placeholder=\"Job title, keywords, or company\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-search\"\n              />\n            </div>\n            \n            <div className=\"relative flex-1\">\n              <MapPin className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n              <Input\n                placeholder=\"Location\"\n                value={location}\n                onChange={(e) => setLocation(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-location\"\n              />\n            </div>\n\n            <Select value={jobType} onValueChange={setJobType}>\n              <SelectTrigger className=\"w-full md:w-[180px]\" data-testid=\"select-job-type\">\n                <SelectValue placeholder=\"Job Type\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Types</SelectItem>\n                <SelectItem value=\"full_time\">Full Time</SelectItem>\n                <SelectItem value=\"part_time\">Part Time</SelectItem>\n                <SelectItem value=\"contract\">Contract</SelectItem>\n                <SelectItem value=\"remote\">Remote</SelectItem>\n                <SelectItem value=\"hybrid\">Hybrid</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={category} onValueChange={setCategory}>\n              <SelectTrigger className=\"w-full md:w-[180px]\" data-testid=\"select-category\">\n                <SelectValue placeholder=\"Category\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Categories</SelectItem>\n                <SelectItem value=\"Technology\">Technology</SelectItem>\n                <SelectItem value=\"Marketing\">Marketing</SelectItem>\n                <SelectItem value=\"Design\">Design</SelectItem>\n                <SelectItem value=\"Sales\">Sales</SelectItem>\n                <SelectItem value=\"Finance\">Finance</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n      </section>\n\n      {/* Jobs List */}\n      <section className=\"py-8\">\n        <div className=\"container max-w-7xl mx-auto px-4 md:px-6 lg:px-8\">\n          <div className=\"mb-6 flex items-center justify-between\">\n            <p className=\"text-sm text-muted-foreground\">\n              {filteredJobs.length} {filteredJobs.length === 1 ? 'job' : 'jobs'} found\n            </p>\n          </div>\n\n          {isLoading ? (\n            <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n              {[1, 2, 3, 4, 5, 6].map((i) => (\n                <Card key={i}>\n                  <CardHeader className=\"gap-4\">\n                    <Skeleton className=\"h-12 w-12 rounded-md\" />\n                    <div className=\"space-y-2\">\n                      <Skeleton className=\"h-6 w-3/4\" />\n                      <Skeleton className=\"h-4 w-1/2\" />\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <Skeleton className=\"h-20 w-full\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredJobs.length === 0 ? (\n            <div className=\"flex min-h-[400px] flex-col items-center justify-center text-center\">\n              <Briefcase className=\"h-16 w-16 text-muted-foreground/50 mb-4\" />\n              <h3 className=\"text-xl font-semibold mb-2\">No jobs found</h3>\n              <p className=\"text-muted-foreground max-w-md\">\n                Try adjusting your search criteria or filters to find more opportunities\n              </p>\n            </div>\n          ) : (\n            <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n              {filteredJobs.map((job) => (\n                <Card key={job.id} className=\"hover-elevate flex flex-col\" data-testid={`card-job-${job.id}`}>\n                  <CardHeader className=\"space-y-0 pb-4\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex h-12 w-12 items-center justify-center rounded-md bg-primary/10\">\n                        <Building2 className=\"h-6 w-6 text-primary\" />\n                      </div>\n                      <Button size=\"icon\" variant=\"ghost\" data-testid={`button-bookmark-${job.id}`}>\n                        <Bookmark className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    <div className=\"pt-4\">\n                      <CardTitle className=\"line-clamp-1\">{job.title}</CardTitle>\n                      <CardDescription className=\"mt-1\">{job.location}</CardDescription>\n                    </div>\n                  </CardHeader>\n                  \n                  <CardContent className=\"flex-1 space-y-4\">\n                    <p className=\"text-sm text-muted-foreground line-clamp-3\">\n                      {job.description}\n                    </p>\n                    \n                    <div className=\"flex flex-wrap gap-2\">\n                      <Badge variant=\"secondary\" className=\"gap-1\">\n                        <Briefcase className=\"h-3 w-3\" />\n                        {job.jobType.replace('_', ' ')}\n                      </Badge>\n                      {job.category && (\n                        <Badge variant=\"outline\">{job.category}</Badge>\n                      )}\n                      {job.aiMatchScore && job.aiMatchScore > 70 && (\n                        <Badge variant=\"default\" className=\"gap-1\">\n                          <Sparkles className=\"h-3 w-3\" />\n                          {job.aiMatchScore}% Match\n                        </Badge>\n                      )}\n                    </div>\n\n                    <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                      {(job.salaryMin || job.salaryMax) && (\n                        <div className=\"flex items-center gap-1\">\n                          <span>\n                            {formatPesoRange(job.salaryMin, job.salaryMax)}\n                          </span>\n                        </div>\n                      )}\n                      <div className=\"flex items-center gap-1\">\n                        <Clock className=\"h-4 w-4\" />\n                        <span>{new Date(job.createdAt).toLocaleDateString()}</span>\n                      </div>\n                    </div>\n                  </CardContent>\n\n                  <CardFooter>\n                    <Link href={`/jobs/${job.id}`} className=\"w-full\">\n                      <Button className=\"w-full\" data-testid={`button-view-job-${job.id}`}>\n                        View Details\n                      </Button>\n                    </Link>\n                  </CardFooter>\n                </Card>\n              ))}\n            </div>\n          )}\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":9579,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2263,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"server/objectStorage.ts":{"content":"import { Storage, File } from \"@google-cloud/storage\";\nimport { Response } from \"express\";\nimport { randomUUID } from \"crypto\";\nimport {\n  ObjectAclPolicy,\n  ObjectPermission,\n  canAccessObject,\n  getObjectAclPolicy,\n  setObjectAclPolicy,\n} from \"./objectAcl\";\n\nconst REPLIT_SIDECAR_ENDPOINT = \"http://127.0.0.1:1106\";\n\nexport const objectStorageClient = new Storage({\n  credentials: {\n    audience: \"replit\",\n    subject_token_type: \"access_token\",\n    token_url: `${REPLIT_SIDECAR_ENDPOINT}/token`,\n    type: \"external_account\",\n    credential_source: {\n      url: `${REPLIT_SIDECAR_ENDPOINT}/credential`,\n      format: {\n        type: \"json\",\n        subject_token_field_name: \"access_token\",\n      },\n    },\n    universe_domain: \"googleapis.com\",\n  },\n  projectId: \"\",\n});\n\nexport class ObjectNotFoundError extends Error {\n  constructor() {\n    super(\"Object not found\");\n    this.name = \"ObjectNotFoundError\";\n    Object.setPrototypeOf(this, ObjectNotFoundError.prototype);\n  }\n}\n\nexport class ObjectStorageService {\n  constructor() {}\n\n  getPublicObjectSearchPaths(): Array<string> {\n    const pathsStr = process.env.PUBLIC_OBJECT_SEARCH_PATHS || \"\";\n    const paths = Array.from(\n      new Set(\n        pathsStr\n          .split(\",\")\n          .map((path) => path.trim())\n          .filter((path) => path.length > 0)\n      )\n    );\n    if (paths.length === 0) {\n      throw new Error(\n        \"PUBLIC_OBJECT_SEARCH_PATHS not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PUBLIC_OBJECT_SEARCH_PATHS env var (comma-separated paths).\"\n      );\n    }\n    return paths;\n  }\n\n  getPrivateObjectDir(): string {\n    const dir = process.env.PRIVATE_OBJECT_DIR || \"\";\n    if (!dir) {\n      throw new Error(\n        \"PRIVATE_OBJECT_DIR not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PRIVATE_OBJECT_DIR env var.\"\n      );\n    }\n    return dir;\n  }\n\n  async searchPublicObject(filePath: string): Promise<File | null> {\n    for (const searchPath of this.getPublicObjectSearchPaths()) {\n      const fullPath = `${searchPath}/${filePath}`;\n      const { bucketName, objectName } = parseObjectPath(fullPath);\n      const bucket = objectStorageClient.bucket(bucketName);\n      const file = bucket.file(objectName);\n      const [exists] = await file.exists();\n      if (exists) {\n        return file;\n      }\n    }\n    return null;\n  }\n\n  async downloadObject(file: File, res: Response, cacheTtlSec: number = 3600) {\n    try {\n      const [metadata] = await file.getMetadata();\n      const aclPolicy = await getObjectAclPolicy(file);\n      const isPublic = aclPolicy?.visibility === \"public\";\n      \n      res.set({\n        \"Content-Type\": metadata.contentType || \"application/octet-stream\",\n        \"Content-Length\": metadata.size,\n        \"Cache-Control\": `${isPublic ? \"public\" : \"private\"}, max-age=${cacheTtlSec}`,\n      });\n\n      const stream = file.createReadStream();\n      stream.on(\"error\", (err) => {\n        console.error(\"Stream error:\", err);\n        if (!res.headersSent) {\n          res.status(500).json({ error: \"Error streaming file\" });\n        }\n      });\n      stream.pipe(res);\n    } catch (error) {\n      console.error(\"Error downloading file:\", error);\n      if (!res.headersSent) {\n        res.status(500).json({ error: \"Error downloading file\" });\n      }\n    }\n  }\n\n  async getObjectEntityUploadURL(targetPath?: string): Promise<string> {\n    const privateObjectDir = this.getPrivateObjectDir();\n    if (!privateObjectDir) {\n      throw new Error(\n        \"PRIVATE_OBJECT_DIR not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PRIVATE_OBJECT_DIR env var.\"\n      );\n    }\n\n    let fullPath: string;\n    if (targetPath) {\n      // Use provided target path (user-scoped)\n      fullPath = `${privateObjectDir}${targetPath}`;\n    } else {\n      // Legacy random path for backward compatibility\n      const objectId = randomUUID();\n      fullPath = `${privateObjectDir}/uploads/${objectId}`;\n    }\n    \n    const { bucketName, objectName } = parseObjectPath(fullPath);\n\n    return signObjectURL({\n      bucketName,\n      objectName,\n      method: \"PUT\",\n      ttlSec: 900,\n    });\n  }\n\n  async getObjectEntityFile(objectPath: string): Promise<File> {\n    if (!objectPath.startsWith(\"/objects/\")) {\n      throw new ObjectNotFoundError();\n    }\n\n    const parts = objectPath.slice(1).split(\"/\");\n    if (parts.length < 2) {\n      throw new ObjectNotFoundError();\n    }\n\n    const entityId = parts.slice(1).join(\"/\");\n    let entityDir = this.getPrivateObjectDir();\n    if (!entityDir.endsWith(\"/\")) {\n      entityDir = `${entityDir}/`;\n    }\n    const objectEntityPath = `${entityDir}${entityId}`;\n    const { bucketName, objectName } = parseObjectPath(objectEntityPath);\n    const bucket = objectStorageClient.bucket(bucketName);\n    const objectFile = bucket.file(objectName);\n    const [exists] = await objectFile.exists();\n    if (!exists) {\n      throw new ObjectNotFoundError();\n    }\n    return objectFile;\n  }\n\n  normalizeObjectEntityPath(rawPath: string): string {\n    if (!rawPath.startsWith(\"https://storage.googleapis.com/\")) {\n      return rawPath;\n    }\n  \n    const url = new URL(rawPath);\n    const rawObjectPath = url.pathname;\n  \n    let objectEntityDir = this.getPrivateObjectDir();\n    if (!objectEntityDir.endsWith(\"/\")) {\n      objectEntityDir = `${objectEntityDir}/`;\n    }\n  \n    if (!rawObjectPath.startsWith(objectEntityDir)) {\n      return rawObjectPath;\n    }\n\n    const entityId = rawObjectPath.slice(objectEntityDir.length);\n    return `/objects/${entityId}`;\n  }\n\n  async trySetObjectEntityAclPolicy(\n    rawPath: string,\n    aclPolicy: ObjectAclPolicy\n  ): Promise<string> {\n    const normalizedPath = this.normalizeObjectEntityPath(rawPath);\n    if (!normalizedPath.startsWith(\"/\")) {\n      return normalizedPath;\n    }\n\n    const objectFile = await this.getObjectEntityFile(normalizedPath);\n    await setObjectAclPolicy(objectFile, aclPolicy);\n    return normalizedPath;\n  }\n\n  async canAccessObjectEntity({\n    userId,\n    objectFile,\n    requestedPermission,\n  }: {\n    userId?: string;\n    objectFile: File;\n    requestedPermission?: ObjectPermission;\n  }): Promise<boolean> {\n    return canAccessObject({\n      userId,\n      objectFile,\n      requestedPermission: requestedPermission ?? ObjectPermission.READ,\n    });\n  }\n}\n\nfunction parseObjectPath(path: string): {\n  bucketName: string;\n  objectName: string;\n} {\n  if (!path.startsWith(\"/\")) {\n    path = `/${path}`;\n  }\n  const pathParts = path.split(\"/\");\n  if (pathParts.length < 3) {\n    throw new Error(\"Invalid path: must contain at least a bucket name\");\n  }\n\n  const bucketName = pathParts[1];\n  const objectName = pathParts.slice(2).join(\"/\");\n\n  return {\n    bucketName,\n    objectName,\n  };\n}\n\nasync function signObjectURL({\n  bucketName,\n  objectName,\n  method,\n  ttlSec,\n}: {\n  bucketName: string;\n  objectName: string;\n  method: \"GET\" | \"PUT\" | \"DELETE\" | \"HEAD\";\n  ttlSec: number;\n}): Promise<string> {\n  const request = {\n    bucket_name: bucketName,\n    object_name: objectName,\n    method,\n    expires_at: new Date(Date.now() + ttlSec * 1000).toISOString(),\n  };\n  const response = await fetch(\n    `${REPLIT_SIDECAR_ENDPOINT}/object-storage/signed-object-url`,\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(request),\n    }\n  );\n  if (!response.ok) {\n    throw new Error(\n      `Failed to sign object URL, errorcode: ${response.status}, ` +\n        `make sure you're running on Replit`\n    );\n  }\n\n  const { signed_url: signedURL } = await response.json();\n  return signedURL;\n}\n","path":null,"size_bytes":7645,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 45 100% 96.86%;\n  --foreground: 38.18 53.23% 24.31%;\n  --border: 44.21 26.76% 86.08%;\n  --card: 47.14 87.5% 96.86%;\n  --card-foreground: 210 25% 7.8431%;\n  --card-border: 44.21 26.76% 94%;\n  --sidebar: 180 6.6667% 97.0588%;\n  --sidebar-foreground: 210 25% 7.8431%;\n  --sidebar-border: 205.0000 25.0000% 90.5882%;\n  --sidebar-primary: 203.8863 88.2845% 53.1373%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 211.5789 51.3514% 92.7451%;\n  --sidebar-accent-foreground: 203.8863 88.2845% 53.1373%;\n  --sidebar-ring: 202.8169 89.1213% 53.1373%;\n  --popover: 0 0% 100%;\n  --popover-foreground: 210 25% 7.8431%;\n  --popover-border: 44.21 26.76% 96%;\n  --primary: 38.23 87.6% 74.71%;\n  --primary-foreground: 39.27 43.31% 24.9%;\n  --secondary: 39.27 43.31% 24.9%;\n  --secondary-foreground: 39.75 86.96% 81.96%;\n  --muted: 38.4 60.98% 91.96%;\n  --muted-foreground: 38.18 53.23% 24.31%;\n  --accent: 74.4 39.68% 87.65%;\n  --accent-foreground: 91.43 10.55% 39.02%;\n  --destructive: 0.49 54.19% 55.49%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 44.21 26.76% 86.08%;\n  --ring: 39.27 43.31% 24.9%;\n  --chart-1: 203.8863 88.2845% 53.1373%;\n  --chart-2: 159.7826 100% 36.0784%;\n  --chart-3: 42.0290 92.8251% 56.2745%;\n  --chart-4: 147.1429 78.5047% 41.9608%;\n  --chart-5: 341.4894 75.2000% 50.9804%;\n  --font-sans: 'Figtree', sans-serif;\n  --font-serif: 'Figtree', sans-serif;\n  --font-mono: 'Figtree', sans-serif;\n  --radius: 0.875rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 0%;\n  --foreground: 200 6.6667% 91.1765%;\n  --border: 210 5.2632% 14.9020%;\n  --card: 228 9.8039% 10%;\n  --card-foreground: 0 0% 85.0980%;\n  --card-border: 210 5.2632% 12%;\n  --sidebar: 228 9.8039% 10%;\n  --sidebar-foreground: 0 0% 85.0980%;\n  --sidebar-border: 205.7143 15.7895% 26.0784%;\n  --sidebar-primary: 202.8169 89.1213% 53.1373%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 205.7143 70% 7.8431%;\n  --sidebar-accent-foreground: 203.7736 87.6033% 52.5490%;\n  --sidebar-ring: 202.8169 89.1213% 53.1373%;\n  --popover: 0 0% 0%;\n  --popover-foreground: 200 6.6667% 91.1765%;\n  --popover-border: 210 5.2632% 2%;\n  --primary: 203.7736 87.6033% 52.5490%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 195.0000 15.3846% 94.9020%;\n  --secondary-foreground: 210 25% 7.8431%;\n  --muted: 0 0% 9.4118%;\n  --muted-foreground: 210 3.3898% 46.2745%;\n  --accent: 205.7143 70% 7.8431%;\n  --accent-foreground: 203.7736 87.6033% 52.5490%;\n  --destructive: 356.3033 90.5579% 54.3137%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 207.6923 27.6596% 18.4314%;\n  --ring: 202.8169 89.1213% 53.1373%;\n  --chart-1: 203.8863 88.2845% 53.1373%;\n  --chart-2: 159.7826 100% 36.0784%;\n  --chart-3: 42.0290 92.8251% 56.2745%;\n  --chart-4: 147.1429 78.5047% 41.9608%;\n  --chart-5: 341.4894 75.2000% 50.9804%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --radius: 1.3rem;\n  --spacing: 0.25rem;\n  --font-mono: 'Figtree', sans-serif;\n  --font-sans: 'Figtree', sans-serif;\n  --font-serif: 'Figtree', sans-serif;\n  --tracking-normal: 0em;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","path":null,"size_bytes":11936,"size_tokens":null},"client/src/pages/job-details.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Link, useParams, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Briefcase, \n  MapPin, \n  Clock, \n  Building2, \n  CheckCircle,\n  Sparkles,\n  ArrowLeft,\n  FileText,\n  GraduationCap,\n  Award,\n  ExternalLink\n} from \"lucide-react\";\nimport type { Job } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { formatPesoRange } from \"@/lib/philippines\";\n\nexport default function JobDetails() {\n  const params = useParams();\n  const jobId = params.id;\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [coverLetter, setCoverLetter] = useState(\"\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [resumeUrl, setResumeUrl] = useState<string>(\"\");\n  const [isUploadingResume, setIsUploadingResume] = useState(false);\n\n  const { data: job, isLoading } = useQuery<Job>({\n    queryKey: [\"/api/jobs\", jobId],\n  });\n\n  const { data: profile } = useQuery<any>({\n    queryKey: [\"/api/profile\"],\n  });\n\n  const { data: workExperience = [] } = useQuery<any[]>({\n    queryKey: [\"/api/profile/work-experience\"],\n    enabled: dialogOpen,\n  });\n\n  const { data: education = [] } = useQuery<any[]>({\n    queryKey: [\"/api/profile/education\"],\n    enabled: dialogOpen,\n  });\n\n  const handleResumeUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    const MAX_FILE_SIZE = 10 * 1024 * 1024;\n    const ALLOWED_TYPES = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      toast({ \n        title: \"Invalid file type\", \n        description: \"Only PDF and Word documents are allowed\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    if (file.size > MAX_FILE_SIZE) {\n      toast({ \n        title: \"File too large\", \n        description: \"Resume must be under 10MB\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    try {\n      setIsUploadingResume(true);\n      const response: any = await apiRequest(\"POST\", \"/api/objects/upload-resume\", {\n        contentType: file.type,\n        fileSize: file.size\n      });\n      const { uploadURL, objectPath } = response;\n      \n      const uploadResponse = await fetch(uploadURL, {\n        method: \"PUT\",\n        body: file,\n        headers: { \"Content-Type\": file.type },\n      });\n\n      if (!uploadResponse.ok) {\n        throw new Error(\"Failed to upload resume\");\n      }\n      \n      setResumeUrl(objectPath);\n      toast({ title: \"Resume uploaded\", description: \"Resume uploaded successfully\" });\n    } catch (error: any) {\n      toast({ title: \"Upload failed\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsUploadingResume(false);\n    }\n  };\n\n  const applyMutation = useMutation({\n    mutationFn: async () => {\n      // Ensure resume is uploaded before allowing application\n      const currentResumeUrl = resumeUrl || profile?.resumeUrl;\n      if (!currentResumeUrl) {\n        throw new Error(\"Please upload your resume before applying\");\n      }\n\n      // Update profile with resume if changed\n      if (resumeUrl) {\n        await apiRequest(\"PUT\", \"/api/profile\", { resumeUrl });\n      }\n      \n      return await apiRequest(\"POST\", `/api/jobs/${jobId}/apply`, { coverLetter });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/applications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({\n        title: \"Application submitted!\",\n        description: \"Your application has been sent to the employer.\",\n      });\n      setDialogOpen(false);\n      setCoverLetter(\"\");\n      setResumeUrl(\"\");\n      setLocation(\"/dashboard\");\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to submit application\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <div className=\"container max-w-4xl mx-auto py-8 px-4\">\n          <div className=\"animate-pulse space-y-4\">\n            <div className=\"h-8 bg-muted rounded w-3/4\"></div>\n            <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n            <div className=\"h-64 bg-muted rounded\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!job) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold mb-2\">Job not found</h2>\n          <Link href=\"/jobs\">\n            <Button>Browse Jobs</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"container max-w-7xl mx-auto flex h-16 items-center justify-between px-4 md:px-6 lg:px-8\">\n          <Link href=\"/jobs\">\n            <div className=\"flex items-center gap-2 hover-elevate active-elevate-2 rounded-md px-3 py-2\">\n              <Briefcase className=\"h-6 w-6 text-primary\" />\n              <span className=\"text-xl font-bold\">ZambaJobs</span>\n            </div>\n          </Link>\n          \n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/jobs\">\n              <Button variant=\"ghost\" data-testid=\"button-back-to-jobs\">\n                <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                Back to Jobs\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"container max-w-4xl mx-auto py-8 px-4 md:px-6 lg:px-8\">\n        {/* Job Header */}\n        <Card className=\"mb-8\">\n          <CardHeader>\n            <div className=\"flex items-start justify-between gap-4\">\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"flex h-16 w-16 items-center justify-center rounded-md bg-primary/10\">\n                    <Building2 className=\"h-8 w-8 text-primary\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"text-3xl mb-2\">{job.title}</CardTitle>\n                    <CardDescription className=\"text-base flex items-center gap-4 flex-wrap\">\n                      <span className=\"flex items-center gap-1\">\n                        <MapPin className=\"h-4 w-4\" />\n                        {job.location}\n                      </span>\n                      <span className=\"flex items-center gap-1\">\n                        <Clock className=\"h-4 w-4\" />\n                        Posted {new Date(job.createdAt).toLocaleDateString()}\n                      </span>\n                    </CardDescription>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-wrap gap-2 mb-4\">\n                  <Badge variant=\"secondary\" className=\"gap-1\">\n                    <Briefcase className=\"h-3 w-3\" />\n                    {job.jobType.replace('_', ' ')}\n                  </Badge>\n                  {job.category && (\n                    <Badge variant=\"outline\">{job.category}</Badge>\n                  )}\n                  {job.aiMatchScore && job.aiMatchScore > 70 && (\n                    <Badge variant=\"default\" className=\"gap-1\">\n                      <Sparkles className=\"h-3 w-3\" />\n                      {job.aiMatchScore}% Match\n                    </Badge>\n                  )}\n                </div>\n\n                {(job.salaryMin || job.salaryMax) && (\n                  <div className=\"flex items-center gap-2 text-lg font-semibold text-primary\">\n                    <span>\n                      {formatPesoRange(job.salaryMin, job.salaryMax)}\n                    </span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent>\n            <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n              <DialogTrigger asChild>\n                <Button size=\"lg\" className=\"w-full sm:w-auto\" data-testid=\"button-apply\">\n                  Apply Now\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n                <DialogHeader>\n                  <DialogTitle>Apply for {job.title}</DialogTitle>\n                  <DialogDescription>\n                    Review your portfolio and upload your resume to submit your application\n                  </DialogDescription>\n                </DialogHeader>\n                <div className=\"space-y-6 py-4\">\n                  {/* Work Experience Summary */}\n                  {workExperience.length > 0 && (\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <label className=\"text-sm font-medium flex items-center gap-2\">\n                          <Briefcase className=\"h-4 w-4\" />\n                          Work Experience ({workExperience.length})\n                        </label>\n                        <Link href=\"/profile\">\n                          <Button variant=\"ghost\" size=\"sm\" className=\"gap-1\">\n                            Edit <ExternalLink className=\"h-3 w-3\" />\n                          </Button>\n                        </Link>\n                      </div>\n                      <div className=\"space-y-2\">\n                        {workExperience.slice(0, 3).map((exp: any) => (\n                          <Card key={exp.id} className=\"p-3\">\n                            <div className=\"flex justify-between items-start gap-2\">\n                              <div className=\"flex-1 min-w-0\">\n                                <h4 className=\"font-medium text-sm truncate\">{exp.title}</h4>\n                                <p className=\"text-sm text-muted-foreground truncate\">{exp.company}</p>\n                              </div>\n                              <Badge variant=\"outline\" className=\"text-xs whitespace-nowrap\">\n                                {new Date(exp.startDate).getFullYear()}\n                                {exp.endDate ? ` - ${new Date(exp.endDate).getFullYear()}` : ' - Present'}\n                              </Badge>\n                            </div>\n                          </Card>\n                        ))}\n                        {workExperience.length > 3 && (\n                          <p className=\"text-xs text-muted-foreground text-center\">\n                            +{workExperience.length - 3} more experience(s)\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Education Summary */}\n                  {education.length > 0 && (\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <label className=\"text-sm font-medium flex items-center gap-2\">\n                          <GraduationCap className=\"h-4 w-4\" />\n                          Education ({education.length})\n                        </label>\n                        <Link href=\"/profile\">\n                          <Button variant=\"ghost\" size=\"sm\" className=\"gap-1\">\n                            Edit <ExternalLink className=\"h-3 w-3\" />\n                          </Button>\n                        </Link>\n                      </div>\n                      <div className=\"space-y-2\">\n                        {education.slice(0, 2).map((edu: any) => (\n                          <Card key={edu.id} className=\"p-3\">\n                            <div className=\"flex justify-between items-start gap-2\">\n                              <div className=\"flex-1 min-w-0\">\n                                <h4 className=\"font-medium text-sm truncate\">{edu.degree}</h4>\n                                <p className=\"text-sm text-muted-foreground truncate\">{edu.school}</p>\n                              </div>\n                              <Badge variant=\"outline\" className=\"text-xs whitespace-nowrap\">\n                                {new Date(edu.graduationDate).getFullYear()}\n                              </Badge>\n                            </div>\n                          </Card>\n                        ))}\n                        {education.length > 2 && (\n                          <p className=\"text-xs text-muted-foreground text-center\">\n                            +{education.length - 2} more education(s)\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Add Portfolio Message if Empty */}\n                  {workExperience.length === 0 && education.length === 0 && (\n                    <Card className=\"p-4 bg-muted/50\">\n                      <div className=\"flex items-center gap-3\">\n                        <Award className=\"h-5 w-5 text-muted-foreground\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium\">Complete your portfolio</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            Add your work experience and education to strengthen your application\n                          </p>\n                        </div>\n                        <Link href=\"/profile\">\n                          <Button variant=\"outline\" size=\"sm\">\n                            Add Now\n                          </Button>\n                        </Link>\n                      </div>\n                    </Card>\n                  )}\n\n                  {/* Resume Upload */}\n                  <div className=\"space-y-3\">\n                    <label className=\"text-sm font-medium\">Resume *</label>\n                    {(resumeUrl || profile?.resumeUrl) && (\n                      <div className=\"flex items-center gap-2 p-3 bg-muted rounded-md\">\n                        <FileText className=\"h-4 w-4 text-primary\" />\n                        <span className=\"text-sm flex-1\">Resume uploaded</span>\n                        <a \n                          href={`/objects${resumeUrl || profile?.resumeUrl}`}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"text-sm text-primary hover:underline\"\n                        >\n                          View\n                        </a>\n                      </div>\n                    )}\n                    <Input\n                      type=\"file\"\n                      accept=\".pdf,.doc,.docx\"\n                      onChange={handleResumeUpload}\n                      disabled={isUploadingResume}\n                      data-testid=\"input-apply-resume\"\n                    />\n                    {isUploadingResume && (\n                      <p className=\"text-sm text-muted-foreground mt-2\">Uploading resume...</p>\n                    )}\n                    <p className=\"text-xs text-muted-foreground\">\n                      {profile?.resumeUrl ? \"Update your resume\" : \"Upload your resume (PDF, DOC, or DOCX - max 10MB)\"}\n                    </p>\n                  </div>\n\n                  {/* Cover Letter */}\n                  <div className=\"space-y-3\">\n                    <label className=\"text-sm font-medium\">Cover Letter (Optional)</label>\n                    <Textarea\n                      placeholder=\"Tell the employer why you're a great fit for this position...\"\n                      value={coverLetter}\n                      onChange={(e) => setCoverLetter(e.target.value)}\n                      rows={6}\n                      data-testid=\"textarea-cover-letter\"\n                    />\n                  </div>\n\n                  <Button\n                    className=\"w-full\"\n                    onClick={() => applyMutation.mutate()}\n                    disabled={applyMutation.isPending || isUploadingResume || (!resumeUrl && !profile?.resumeUrl)}\n                    data-testid=\"button-submit-application\"\n                  >\n                    {applyMutation.isPending ? \"Submitting...\" : \"Submit Application\"}\n                  </Button>\n                  {!resumeUrl && !profile?.resumeUrl && (\n                    <p className=\"text-sm text-center text-muted-foreground\">\n                      Please upload your resume to continue\n                    </p>\n                  )}\n                </div>\n              </DialogContent>\n            </Dialog>\n          </CardContent>\n        </Card>\n\n        {/* Job Description */}\n        <Card className=\"mb-6\">\n          <CardHeader>\n            <CardTitle>Job Description</CardTitle>\n          </CardHeader>\n          <CardContent className=\"prose prose-sm max-w-none dark:prose-invert\">\n            <p className=\"whitespace-pre-wrap\">{job.description}</p>\n          </CardContent>\n        </Card>\n\n        {/* Responsibilities */}\n        {job.responsibilities && job.responsibilities.length > 0 && (\n          <Card className=\"mb-6\">\n            <CardHeader>\n              <CardTitle>Responsibilities</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-2\">\n                {job.responsibilities.map((resp, idx) => (\n                  <li key={idx} className=\"flex items-start gap-2\">\n                    <CheckCircle className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                    <span>{resp}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Requirements */}\n        {job.requirements && job.requirements.length > 0 && (\n          <Card className=\"mb-6\">\n            <CardHeader>\n              <CardTitle>Requirements</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-2\">\n                {job.requirements.map((req, idx) => (\n                  <li key={idx} className=\"flex items-start gap-2\">\n                    <CheckCircle className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                    <span>{req}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Skills */}\n        {job.skills && job.skills.length > 0 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>Required Skills</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex flex-wrap gap-2\">\n                {job.skills.map((skill, idx) => (\n                  <Badge key={idx} variant=\"secondary\">{skill}</Badge>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":19516,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"server/objectAcl.ts":{"content":"import { File } from \"@google-cloud/storage\";\n\nconst ACL_POLICY_METADATA_KEY = \"custom:aclPolicy\";\n\nexport enum ObjectAccessGroupType {}\n\nexport interface ObjectAccessGroup {\n  type: ObjectAccessGroupType;\n  id: string;\n}\n\nexport enum ObjectPermission {\n  READ = \"read\",\n  WRITE = \"write\",\n}\n\nexport interface ObjectAclRule {\n  group: ObjectAccessGroup;\n  permission: ObjectPermission;\n}\n\nexport interface ObjectAclPolicy {\n  owner: string;\n  visibility: \"public\" | \"private\";\n  aclRules?: Array<ObjectAclRule>;\n}\n\nfunction isPermissionAllowed(\n  requested: ObjectPermission,\n  granted: ObjectPermission,\n): boolean {\n  if (requested === ObjectPermission.READ) {\n    return [ObjectPermission.READ, ObjectPermission.WRITE].includes(granted);\n  }\n  return granted === ObjectPermission.WRITE;\n}\n\nabstract class BaseObjectAccessGroup implements ObjectAccessGroup {\n  constructor(\n    public readonly type: ObjectAccessGroupType,\n    public readonly id: string,\n  ) {}\n\n  public abstract hasMember(userId: string): Promise<boolean>;\n}\n\nfunction createObjectAccessGroup(\n  group: ObjectAccessGroup,\n): BaseObjectAccessGroup {\n  switch (group.type) {\n    default:\n      throw new Error(`Unknown access group type: ${group.type}`);\n  }\n}\n\nexport async function setObjectAclPolicy(\n  objectFile: File,\n  aclPolicy: ObjectAclPolicy,\n): Promise<void> {\n  const [exists] = await objectFile.exists();\n  if (!exists) {\n    throw new Error(`Object not found: ${objectFile.name}`);\n  }\n\n  await objectFile.setMetadata({\n    metadata: {\n      [ACL_POLICY_METADATA_KEY]: JSON.stringify(aclPolicy),\n    },\n  });\n}\n\nexport async function getObjectAclPolicy(\n  objectFile: File,\n): Promise<ObjectAclPolicy | null> {\n  const [metadata] = await objectFile.getMetadata();\n  const aclPolicy = metadata?.metadata?.[ACL_POLICY_METADATA_KEY];\n  if (!aclPolicy) {\n    return null;\n  }\n  return JSON.parse(aclPolicy as string);\n}\n\nexport async function canAccessObject({\n  userId,\n  objectFile,\n  requestedPermission,\n}: {\n  userId?: string;\n  objectFile: File;\n  requestedPermission: ObjectPermission;\n}): Promise<boolean> {\n  const aclPolicy = await getObjectAclPolicy(objectFile);\n  if (!aclPolicy) {\n    return false;\n  }\n\n  if (\n    aclPolicy.visibility === \"public\" &&\n    requestedPermission === ObjectPermission.READ\n  ) {\n    return true;\n  }\n\n  if (!userId) {\n    return false;\n  }\n\n  if (aclPolicy.owner === userId) {\n    return true;\n  }\n\n  for (const rule of aclPolicy.aclRules || []) {\n    const accessGroup = createObjectAccessGroup(rule.group);\n    if (\n      (await accessGroup.hasMember(userId)) &&\n      isPermissionAllowed(requestedPermission, rule.permission)\n    ) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","path":null,"size_bytes":2707,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SidebarProvider, SidebarTrigger, SidebarInset } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport { AuthProvider, useAuth } from \"@/contexts/auth-context\";\nimport { Input } from \"@/components/ui/input\";\nimport { Search } from \"lucide-react\";\nimport { useState } from \"react\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/landing\";\nimport Login from \"@/pages/login\";\nimport Register from \"@/pages/register\";\nimport ForgotPassword from \"@/pages/forgot-password\";\nimport VerifyEmail from \"@/pages/verify-email\";\nimport VerifyOTP from \"@/pages/verify-otp\";\nimport Onboarding from \"@/pages/onboarding\";\nimport Profile from \"@/pages/profile\";\nimport Jobs from \"@/pages/jobs\";\nimport JobDetails from \"@/pages/job-details\";\nimport PostJob from \"@/pages/post-job\";\nimport JobManagement from \"@/pages/job-management\";\nimport ApplicantPortfolio from \"@/pages/applicant-portfolio\";\nimport JobSeekerDashboard from \"@/pages/job-seeker-dashboard\";\nimport EmployerDashboard from \"@/pages/employer-dashboard\";\nimport AdminDashboard from \"@/pages/admin-dashboard\";\nimport AdminContacts from \"@/pages/admin-contacts\";\nimport AdminAnalytics from \"@/pages/admin-analytics\";\nimport AdminUsers from \"@/pages/admin-users\";\nimport AdminJobs from \"@/pages/admin-jobs\";\nimport AdminManagement from \"@/pages/admin-admins\";\nimport AdminFraud from \"@/pages/admin-fraud\";\nimport EmployerAnalytics from \"@/pages/employer-analytics\";\nimport JobSeekerAnalytics from \"@/pages/job-seeker-analytics\";\nimport EmployerContact from \"@/pages/employer-contact\";\nimport JobSeekerContact from \"@/pages/job-seeker-contact\";\n\nfunction getRoleDashboard(role: string): string {\n  switch (role) {\n    case \"job_seeker\":\n      return \"/dashboard\";\n    case \"employer\":\n      return \"/employer/dashboard\";\n    case \"admin\":\n      return \"/admin/dashboard\";\n    default:\n      return \"/\";\n  }\n}\n\nfunction ProtectedRoute({ \n  children, \n  allowedRoles \n}: { \n  children: React.ReactNode; \n  allowedRoles?: string[];\n}) {\n  const { user, isLoading } = useAuth();\n\n  // Don't render or redirect while loading\n  if (isLoading || !user) {\n    if (isLoading) {\n      return <div className=\"flex items-center justify-center h-screen\">Loading...</div>;\n    }\n    return <Redirect to=\"/login\" />;\n  }\n\n  // User is now guaranteed to be defined\n  if (allowedRoles && user.role && !allowedRoles.includes(user.role)) {\n    const correctDashboard = getRoleDashboard(user.role);\n    return <Redirect to={correctDashboard} />;\n  }\n\n  return <>{children}</>;\n}\n\nfunction DashboardLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <SidebarProvider defaultOpen={true}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n        <SidebarInset className=\"flex-1 overflow-hidden\">\n          <header className=\"sticky top-0 z-50 flex h-14 items-center gap-4 border-b bg-background px-4\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-3 flex-1\">\n              <h1 className=\"text-lg font-semibold\">ZambaJobs</h1>\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            {children}\n          </main>\n        </SidebarInset>\n      </div>\n    </SidebarProvider>\n  );\n}\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Landing} />\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/register\" component={Register} />\n      <Route path=\"/onboarding\" component={Onboarding} />\n      <Route path=\"/forgot-password\" component={ForgotPassword} />\n      <Route path=\"/verify-email\" component={VerifyEmail} />\n      <Route path=\"/verify-otp\" component={VerifyOTP} />\n      <Route path=\"/jobs\" component={Jobs} />\n      <Route path=\"/jobs/:id\" component={JobDetails} />\n      <Route path=\"/profile\">\n        <ProtectedRoute allowedRoles={[\"job_seeker\", \"employer\"]}>\n          <DashboardLayout>\n            <Profile />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/dashboard\">\n        <ProtectedRoute allowedRoles={[\"job_seeker\"]}>\n          <DashboardLayout>\n            <JobSeekerDashboard />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/employer/dashboard\">\n        <ProtectedRoute allowedRoles={[\"employer\"]}>\n          <DashboardLayout>\n            <EmployerDashboard />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/employer/post-job\">\n        <ProtectedRoute allowedRoles={[\"employer\"]}>\n          <DashboardLayout>\n            <PostJob />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/employer/jobs/:id\">\n        <ProtectedRoute allowedRoles={[\"employer\"]}>\n          <DashboardLayout>\n            <JobManagement />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/employer/applicant/:userId\">\n        <ProtectedRoute allowedRoles={[\"employer\"]}>\n          <DashboardLayout>\n            <ApplicantPortfolio />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/employer/analytics\">\n        <ProtectedRoute allowedRoles={[\"employer\"]}>\n          <DashboardLayout>\n            <EmployerAnalytics />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/employer/contact\">\n        <ProtectedRoute allowedRoles={[\"employer\"]}>\n          <DashboardLayout>\n            <EmployerContact />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/analytics\">\n        <ProtectedRoute allowedRoles={[\"job_seeker\"]}>\n          <DashboardLayout>\n            <JobSeekerAnalytics />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/contact\">\n        <ProtectedRoute allowedRoles={[\"job_seeker\"]}>\n          <DashboardLayout>\n            <JobSeekerContact />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/dashboard\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminDashboard />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminDashboard />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/contacts\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminContacts />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/analytics\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminAnalytics />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/fraud\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminFraud />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/users\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminUsers />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/jobs\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminJobs />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/admins\">\n        <ProtectedRoute allowedRoles={[\"admin\"]}>\n          <DashboardLayout>\n            <AdminManagement />\n          </DashboardLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n}\n","path":null,"size_bytes":8370,"size_tokens":null},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","path":null,"size_bytes":483,"size_tokens":null},"client/src/pages/landing.tsx":{"content":"import { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Briefcase, Shield, Sparkles, Search, MapPin, Users, TrendingUp, CheckCircle } from \"lucide-react\";\n\nexport default function Landing() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Navigation */}\n      <header className=\"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"container max-w-7xl mx-auto flex h-16 items-center justify-between px-4 md:px-6 lg:px-8\">\n          <Link href=\"/\" data-testid=\"link-home\">\n            <div className=\"flex items-center gap-2 hover-elevate active-elevate-2 rounded-md px-3 py-2\">\n              <Briefcase className=\"h-6 w-6 text-primary\" />\n              <span className=\"text-xl font-bold\">ZambaJobs</span>\n            </div>\n          </Link>\n          \n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/login\">\n              <Button variant=\"ghost\" data-testid=\"button-login\">\n                Log In\n              </Button>\n            </Link>\n            <Link href=\"/register\">\n              <Button data-testid=\"button-signup\">\n                Sign Up\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"relative overflow-hidden bg-gradient-to-br from-primary/5 via-background to-accent/5 py-24 md:py-32\">\n        <div className=\"absolute inset-0 bg-grid-slate-200/20 [mask-image:linear-gradient(0deg,transparent,black)]\"></div>\n        <div className=\"container relative max-w-7xl mx-auto px-4 md:px-6 lg:px-8\">\n          <div className=\"mx-auto max-w-3xl text-center\">\n            <Badge className=\"mb-4\" variant=\"secondary\" data-testid=\"badge-ai-powered\">\n              <Sparkles className=\"mr-2 h-3 w-3\" />\n              AI-Powered Fraud Detection\n            </Badge>\n            <h1 className=\"mb-6 text-4xl font-bold tracking-tight sm:text-5xl md:text-6xl\">\n              Find Your Dream Job with{\" \"}\n              <span className=\"text-primary\">AI-Powered Matching</span>\n            </h1>\n            <p className=\"mb-8 text-lg text-muted-foreground sm:text-xl\">\n              Secure, intelligent job portal connecting talented professionals with trusted employers. Protected by advanced fraud detection.\n            </p>\n            \n            {/* Search Bar */}\n            <div className=\"mx-auto mb-8 flex max-w-2xl flex-col gap-4 sm:flex-row\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Job title or keyword\"\n                  className=\"pl-10\"\n                  data-testid=\"input-job-search\"\n                />\n              </div>\n              <div className=\"relative flex-1\">\n                <MapPin className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Location\"\n                  className=\"pl-10\"\n                  data-testid=\"input-location-search\"\n                />\n              </div>\n              <Button size=\"lg\" data-testid=\"button-search-jobs\">\n                <Search className=\"mr-2 h-4 w-4\" />\n                Search\n              </Button>\n            </div>\n\n            <div className=\"flex flex-wrap items-center justify-center gap-4\">\n              <Link href=\"/jobs\">\n                <Button size=\"lg\" data-testid=\"button-find-jobs\">\n                  Find Jobs\n                </Button>\n              </Link>\n              <Link href=\"/employer/post-job\">\n                <Button size=\"lg\" variant=\"outline\" data-testid=\"button-post-jobs\">\n                  Post a Job\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section className=\"py-16 md:py-24\">\n        <div className=\"container max-w-7xl mx-auto px-4 md:px-6 lg:px-8\">\n          <div className=\"mb-12 text-center\">\n            <h2 className=\"mb-4 text-3xl font-bold sm:text-4xl\">Why Choose ZambaJobs?</h2>\n            <p className=\"mx-auto max-w-2xl text-lg text-muted-foreground\">\n              Advanced technology meets professional recruitment for a safer, smarter hiring experience\n            </p>\n          </div>\n\n          <div className=\"grid gap-8 md:grid-cols-2 lg:grid-cols-3\">\n            <Card className=\"hover-elevate\" data-testid=\"card-feature-ai\">\n              <CardHeader>\n                <div className=\"mb-2 flex h-12 w-12 items-center justify-center rounded-md bg-primary/10\">\n                  <Sparkles className=\"h-6 w-6 text-primary\" />\n                </div>\n                <CardTitle>AI Job Matching</CardTitle>\n                <CardDescription>\n                  Our intelligent algorithm analyzes your skills and experience to recommend the perfect job opportunities\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover-elevate\" data-testid=\"card-feature-security\">\n              <CardHeader>\n                <div className=\"mb-2 flex h-12 w-12 items-center justify-center rounded-md bg-destructive/10\">\n                  <Shield className=\"h-6 w-6 text-destructive\" />\n                </div>\n                <CardTitle>Fraud Detection</CardTitle>\n                <CardDescription>\n                  Advanced AI monitors all profiles and job postings to protect you from scams and fraudulent activity\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover-elevate\" data-testid=\"card-feature-verified\">\n              <CardHeader>\n                <div className=\"mb-2 flex h-12 w-12 items-center justify-center rounded-md bg-chart-1/10\">\n                  <CheckCircle className=\"h-6 w-6 text-chart-1\" />\n                </div>\n                <CardTitle>Verified Employers</CardTitle>\n                <CardDescription>\n                  All employers are verified to ensure you're applying to legitimate companies with real opportunities\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover-elevate\" data-testid=\"card-feature-smart\">\n              <CardHeader>\n                <div className=\"mb-2 flex h-12 w-12 items-center justify-center rounded-md bg-chart-2/10\">\n                  <TrendingUp className=\"h-6 w-6 text-chart-2\" />\n                </div>\n                <CardTitle>Smart Recommendations</CardTitle>\n                <CardDescription>\n                  Employers receive AI-powered candidate suggestions matching their job requirements perfectly\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover-elevate\" data-testid=\"card-feature-professional\">\n              <CardHeader>\n                <div className=\"mb-2 flex h-12 w-12 items-center justify-center rounded-md bg-accent/50\">\n                  <Briefcase className=\"h-6 w-6 text-accent-foreground\" />\n                </div>\n                <CardTitle>Professional Profiles</CardTitle>\n                <CardDescription>\n                  Build comprehensive profiles with work experience, education, certifications, and portfolio links\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover-elevate\" data-testid=\"card-feature-community\">\n              <CardHeader>\n                <div className=\"mb-2 flex h-12 w-12 items-center justify-center rounded-md bg-chart-4/10\">\n                  <Users className=\"h-6 w-6 text-chart-4\" />\n                </div>\n                <CardTitle>Growing Community</CardTitle>\n                <CardDescription>\n                  Join thousands of professionals and companies building meaningful careers and teams\n                </CardDescription>\n              </CardHeader>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"border-t bg-muted/30 py-16\">\n        <div className=\"container max-w-7xl mx-auto px-4 md:px-6 lg:px-8 text-center\">\n          <h2 className=\"mb-4 text-3xl font-bold\">Ready to Get Started?</h2>\n          <p className=\"mb-8 text-lg text-muted-foreground\">\n            Join ZambaJobs today and experience the future of secure recruitment\n          </p>\n          <div className=\"flex flex-wrap items-center justify-center gap-4\">\n            <Link href=\"/jobs\">\n              <Button size=\"lg\" data-testid=\"button-cta-seeker\">\n                I'm Looking for Jobs\n              </Button>\n            </Link>\n            <Link href=\"/employer/post-job\">\n              <Button size=\"lg\" variant=\"outline\" data-testid=\"button-cta-employer\">\n                I'm Hiring Talent\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"border-t py-8\">\n        <div className=\"container max-w-7xl mx-auto px-4 md:px-6 lg:px-8\">\n          <div className=\"flex flex-col items-center justify-between gap-4 md:flex-row\">\n            <div className=\"flex items-center gap-2\">\n              <Briefcase className=\"h-5 w-5 text-primary\" />\n              <span className=\"font-semibold\">ZambaJobs</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Shield className=\"h-4 w-4 text-muted-foreground\" />\n              <span className=\"text-sm text-muted-foreground\">Secure & Private</span>\n            </div>\n            <p className=\"text-sm text-muted-foreground\">\n              © 2025 ZambaJobs. All rights reserved.\n            </p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","path":null,"size_bytes":10086,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"server/ai.ts":{"content":"import OpenAI from \"openai\";\nimport type { JobSeekerProfile, Job, User, EmployerProfile } from \"@shared/schema\";\n\nconst openai = new OpenAI({\n  baseURL: process.env.AI_INTEGRATIONS_OPENAI_BASE_URL,\n  apiKey: process.env.AI_INTEGRATIONS_OPENAI_API_KEY\n});\n\ninterface FraudAnalysisResult {\n  isFraudulent: boolean;\n  confidence: number;\n  reasons: string[];\n  alertType: string;\n}\n\nexport async function analyzeUserProfileForFraud(\n  user: User,\n  profile?: JobSeekerProfile | EmployerProfile,\n  profileImageUrl?: string\n): Promise<FraudAnalysisResult> {\n  try {\n    const profileData = JSON.stringify({\n      email: user.email,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      role: user.role,\n      profile: profile || {},\n    });\n\n    const messages: any[] = [\n      {\n        role: \"system\",\n        content: \"You are a fraud detection AI for a job portal. Analyze user profiles for signs of fraudulent activity, fake information, or suspicious patterns. Look for: inconsistencies in professional history, suspicious email patterns, implausible claims, copy-pasted generic content, missing critical information, or red flags. If a profile image is provided, analyze it for stock photos, inappropriate content, or suspicious elements. Respond in JSON format.\"\n      }\n    ];\n\n    // Build user message with optional image\n    const userContent: any[] = [\n      {\n        type: \"text\",\n        text: `Analyze this user profile for fraud: ${profileData}. Return JSON with: { \"isFraudulent\": boolean, \"confidence\": number (0-100), \"reasons\": string[], \"alertType\": string }`\n      }\n    ];\n\n    // Add image if profile image URL is provided\n    if (profileImageUrl) {\n      userContent.push({\n        type: \"image_url\",\n        image_url: {\n          url: profileImageUrl,\n          detail: \"auto\"\n        }\n      });\n    }\n\n    messages.push({\n      role: \"user\",\n      content: userContent\n    });\n\n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n      messages,\n      response_format: { type: \"json_object\" },\n      max_completion_tokens: 1024,\n    });\n\n    const result = JSON.parse(response.choices[0]?.message?.content || \"{}\");\n    return {\n      isFraudulent: result.isFraudulent || false,\n      confidence: result.confidence || 0,\n      reasons: result.reasons || [],\n      alertType: result.alertType || \"Suspicious Profile\"\n    };\n  } catch (error) {\n    console.error(\"Fraud analysis error:\", error);\n    return {\n      isFraudulent: false,\n      confidence: 0,\n      reasons: [\"Analysis failed\"],\n      alertType: \"Analysis Error\"\n    };\n  }\n}\n\nexport async function analyzeJobPostingForFraud(job: Job): Promise<FraudAnalysisResult> {\n  try {\n    const jobData = JSON.stringify({\n      title: job.title,\n      description: job.description,\n      requirements: job.requirements,\n      salaryMin: job.salaryMin,\n      salaryMax: job.salaryMax,\n      location: job.location,\n      jobType: job.jobType,\n    });\n\n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n      messages: [\n        {\n          role: \"system\",\n          content: \"You are a fraud detection AI for a job portal. Analyze job postings for scams, pyramid schemes, unrealistic offers, or fraudulent positions. Look for: unrealistic salary promises, vague job descriptions, requests for money/personal information upfront, multi-level marketing schemes, work-from-home scams. Respond in JSON format.\"\n        },\n        {\n          role: \"user\",\n          content: `Analyze this job posting for fraud: ${jobData}. Return JSON with: { \"isFraudulent\": boolean, \"confidence\": number (0-100), \"reasons\": string[], \"alertType\": string }`\n        }\n      ],\n      response_format: { type: \"json_object\" },\n      max_completion_tokens: 1024,\n    });\n\n    const result = JSON.parse(response.choices[0]?.message?.content || \"{}\");\n    return {\n      isFraudulent: result.isFraudulent || false,\n      confidence: result.confidence || 0,\n      reasons: result.reasons || [],\n      alertType: result.alertType || \"Suspicious Job Posting\"\n    };\n  } catch (error) {\n    console.error(\"Job fraud analysis error:\", error);\n    return {\n      isFraudulent: false,\n      confidence: 0,\n      reasons: [\"Analysis failed\"],\n      alertType: \"Analysis Error\"\n    };\n  }\n}\n\ninterface JobMatchResult {\n  matchScore: number;\n  reasoning: string;\n}\n\nexport async function calculateJobMatch(\n  seekerProfile: JobSeekerProfile,\n  job: Job,\n  workExperience?: Array<{companyName: string, position: string, description?: string}>,\n  education?: Array<{institution: string, degree: string, fieldOfStudy?: string}>,\n  certifications?: Array<{name: string, issuer: string}>\n): Promise<number> {\n  const result = await calculateJobMatchWithReasoning(seekerProfile, job, workExperience, education, certifications);\n  return result.matchScore;\n}\n\nexport async function calculateJobMatchWithReasoning(\n  seekerProfile: JobSeekerProfile,\n  job: Job,\n  workExperience?: Array<{companyName: string, position: string, description?: string}>,\n  education?: Array<{institution: string, degree: string, fieldOfStudy?: string}>,\n  certifications?: Array<{name: string, issuer: string}>\n): Promise<JobMatchResult> {\n  try {\n    const profileData = {\n      skills: seekerProfile.skills || [],\n      headline: seekerProfile.headline,\n      bio: seekerProfile.bio,\n      location: seekerProfile.location,\n      hasResume: !!seekerProfile.resumeUrl,\n      portfolioUrl: seekerProfile.portfolioUrl,\n      linkedinUrl: seekerProfile.linkedinUrl,\n      workExperience: workExperience || [],\n      education: education || [],\n      certifications: certifications || [],\n    };\n\n    const jobData = {\n      title: job.title,\n      description: job.description,\n      requirements: job.requirements || [],\n      skills: job.skills || [],\n      location: job.location,\n      jobType: job.jobType,\n      salaryRange: job.salaryMin && job.salaryMax ? `${job.salaryMin}-${job.salaryMax}` : undefined,\n    };\n\n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n      messages: [\n        {\n          role: \"system\",\n          content: \"You are an AI job matching expert for the Philippine job market. Calculate how well a candidate matches a job based on their complete professional profile including skills, work experience, education, certifications, and portfolio. Consider: 1) Skill alignment with job requirements, 2) Relevant work experience in similar roles/industries, 3) Educational background matching job needs, 4) Professional certifications, 5) Portfolio quality (if provided), 6) Location compatibility, 7) Career progression and growth potential. Weight resume/portfolio presence positively as it shows professionalism. Return a match score from 0-100 where 90-100 is excellent, 70-89 is good, 50-69 is moderate, below 50 is poor fit. Respond in JSON format.\"\n        },\n        {\n          role: \"user\",\n          content: `Calculate detailed match score between this candidate profile: ${JSON.stringify(profileData)} and this job posting: ${JSON.stringify(jobData)}. Consider the candidate's complete professional background. Return JSON with: { \"matchScore\": number (0-100), \"reasoning\": string (brief 1-2 sentence explanation of why this score was given) }`\n        }\n      ],\n      response_format: { type: \"json_object\" },\n      max_completion_tokens: 512,\n    });\n\n    const result = JSON.parse(response.choices[0]?.message?.content || \"{}\");\n    return {\n      matchScore: result.matchScore || 0,\n      reasoning: result.reasoning || \"Unable to determine match reasoning\"\n    };\n  } catch (error) {\n    console.error(\"Job match calculation error:\", error);\n    return { matchScore: 0, reasoning: \"Match calculation failed\" };\n  }\n}\n\nexport async function findMatchingCandidates(\n  job: Job,\n  candidates: Array<{ \n    user: User; \n    profile: JobSeekerProfile;\n    workExperience?: Array<{companyName: string, position: string, description?: string}>;\n    education?: Array<{institution: string, degree: string, fieldOfStudy?: string}>;\n    certifications?: Array<{name: string, issuer: string}>;\n  }>\n): Promise<Array<{ userId: string; matchScore: number }>> {\n  try {\n    const matches = await Promise.all(\n      candidates.map(async (candidate) => {\n        const score = await calculateJobMatch(\n          candidate.profile, \n          job,\n          candidate.workExperience,\n          candidate.education,\n          candidate.certifications\n        );\n        return {\n          userId: candidate.user.id,\n          matchScore: score,\n        };\n      })\n    );\n\n    return matches\n      .filter(m => m.matchScore > 50)\n      .sort((a, b) => b.matchScore - a.matchScore)\n      .slice(0, 10);\n  } catch (error) {\n    console.error(\"Candidate matching error:\", error);\n    return [];\n  }\n}\n","path":null,"size_bytes":9246,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/pages/admin-dashboard.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { useState } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Briefcase, Shield, AlertTriangle, Users, FileText, TrendingUp, Search, Flag, RefreshCcw, Mail, BarChart3, MessageSquare, Eye, MapPin, Building2, Phone, Linkedin, DollarSign, Calendar } from \"lucide-react\";\nimport type { FraudAlert, User, Job, ActivityLog } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { formatDistance } from \"date-fns\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\n\nexport default function AdminDashboard() {\n  const { toast } = useToast();\n  const [userSearch, setUserSearch] = useState(\"\");\n  const [viewingDetails, setViewingDetails] = useState<any>(null);\n  const [detailsData, setDetailsData] = useState<any>(null);\n  const [loadingDetails, setLoadingDetails] = useState(false);\n  \n  const { data: fraudAlerts, isLoading: alertsLoading } = useQuery<FraudAlert[]>({\n    queryKey: [\"/api/admin/fraud-alerts\"],\n  });\n\n  const { data: stats } = useQuery<any>({\n    queryKey: [\"/api/admin/stats\"],\n  });\n\n  const { data: users, isLoading: usersLoading } = useQuery<any[]>({\n    queryKey: [\"/api/admin/users\"],\n  });\n\n  const { data: activityLogs, isLoading: activityLoading, isError: activityError } = useQuery<ActivityLog[]>({\n    queryKey: [\"/api/admin/activity\"],\n  });\n\n  const reviewAlertMutation = useMutation({\n    mutationFn: async ({ id, status, notes }: { id: string; status: string; notes?: string }) => {\n      return await apiRequest(\"PUT\", `/api/admin/fraud-alerts/${id}`, { status, reviewNotes: notes });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/fraud-alerts\"] });\n      toast({\n        title: \"Alert updated\",\n        description: \"The fraud alert has been reviewed successfully.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update alert\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const flagUserMutation = useMutation({\n    mutationFn: async ({ userId, isFlagged }: { userId: string; isFlagged: boolean }) => {\n      return await apiRequest(\"PUT\", `/api/admin/users/${userId}/flag`, { isFlagged });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      toast({ title: \"User updated\", description: \"User flag status updated successfully\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleViewDetails = async (alert: any) => {\n    setViewingDetails(alert);\n    setLoadingDetails(true);\n    setDetailsData(null);\n    \n    try {\n      const response = await fetch(`/api/admin/fraud-alerts/${alert.id}/details`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch details');\n      }\n      const data = await response.json();\n      setDetailsData(data.details);\n    } catch (error) {\n      toast({ title: \"Error\", description: \"Failed to load details\", variant: \"destructive\" });\n    } finally {\n      setLoadingDetails(false);\n    }\n  };\n\n  const pendingAlerts = fraudAlerts?.filter(a => a.status === \"pending\") || [];\n  \n  const filteredUsers = users?.filter(u => \n    !userSearch || \n    u.email.toLowerCase().includes(userSearch.toLowerCase()) ||\n    u.role.toLowerCase().includes(userSearch.toLowerCase())\n  ) || [];\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold mb-2\">Admin Dashboard</h1>\n          <p className=\"text-muted-foreground\">Monitor platform security and moderate content</p>\n        </div>\n        <Badge variant=\"destructive\" className=\"gap-1\">\n          <Shield className=\"h-3 w-3\" />\n          Admin\n        </Badge>\n      </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid gap-6 md:grid-cols-4 mb-8\">\n          <Card data-testid=\"card-stat-users\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Users</CardDescription>\n              <CardTitle className=\"text-3xl\">{stats?.totalUsers || 0}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Users className=\"h-3 w-3\" />\n                <span>Platform members</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-total-jobs\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Active Jobs</CardDescription>\n              <CardTitle className=\"text-3xl\">{stats?.activeJobs || 0}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Briefcase className=\"h-3 w-3\" />\n                <span>Job postings</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-pending-alerts\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Pending Alerts</CardDescription>\n              <CardTitle className=\"text-3xl text-destructive\">{pendingAlerts.length}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <AlertTriangle className=\"h-3 w-3\" />\n                <span>Needs review</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-flagged\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Flagged Content</CardDescription>\n              <CardTitle className=\"text-3xl\">{stats?.flaggedContent || 0}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Shield className=\"h-3 w-3\" />\n                <span>Under review</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Quick Actions & Recent Activity */}\n        <div className=\"grid gap-6 md:grid-cols-3 mb-8\">\n          {/* Quick Actions */}\n          <Card className=\"md:col-span-2\" data-testid=\"card-quick-actions\">\n            <CardHeader>\n              <CardTitle>Quick Actions</CardTitle>\n              <CardDescription>Common administrative tasks</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                <Button variant=\"outline\" size=\"sm\" className=\"h-auto py-3 flex-col gap-2\" asChild data-testid=\"button-view-contacts\">\n                  <Link href=\"/admin/contacts\">\n                    <Mail className=\"h-5 w-5\" />\n                    <span className=\"text-xs\">Contact Messages</span>\n                  </Link>\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"h-auto py-3 flex-col gap-2\" asChild data-testid=\"button-view-analytics\">\n                  <Link href=\"/admin/analytics\">\n                    <BarChart3 className=\"h-5 w-5\" />\n                    <span className=\"text-xs\">Analytics</span>\n                  </Link>\n                </Button>\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\" \n                  className=\"h-auto py-3 flex-col gap-2\"\n                  onClick={() => {\n                    queryClient.invalidateQueries({ queryKey: [\"/api/admin/fraud-alerts\"] });\n                    queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n                    queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n                    queryClient.invalidateQueries({ queryKey: [\"/api/admin/activity\"] });\n                    queryClient.invalidateQueries({ queryKey: [\"/api/admin/contacts\"] });\n                    toast({ title: \"Refreshed\", description: \"Admin data has been refreshed\" });\n                  }}\n                  data-testid=\"button-refresh-data\"\n                >\n                  <RefreshCcw className=\"h-5 w-5\" />\n                  <span className=\"text-xs\">Refresh Data</span>\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Recent Activity */}\n          <Card data-testid=\"card-recent-activity\">\n            <CardHeader>\n              <CardTitle>Recent Activity</CardTitle>\n              <CardDescription>Latest platform events</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3 max-h-64 overflow-y-auto\">\n                {activityLoading ? (\n                  <p className=\"text-sm text-muted-foreground\">Loading activity...</p>\n                ) : activityError ? (\n                  <p className=\"text-sm text-destructive\">Failed to load activity logs</p>\n                ) : activityLogs && activityLogs.length > 0 ? (\n                  activityLogs.slice(0, 8).map((log) => (\n                    <div key={log.id} className=\"flex gap-2 text-sm\" data-testid={`activity-log-${log.id}`}>\n                      <div className=\"min-w-0 flex-1\">\n                        <p className=\"text-sm line-clamp-2\">{log.description}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {formatDistance(new Date(log.createdAt), new Date(), { addSuffix: true })}\n                        </p>\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-sm text-muted-foreground\">No recent activity</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Main Content */}\n        <Tabs defaultValue=\"alerts\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"alerts\" data-testid=\"tab-alerts\">\n              Fraud Alerts\n            </TabsTrigger>\n            <TabsTrigger value=\"users\" data-testid=\"tab-users\">\n              User Management\n            </TabsTrigger>\n            <TabsTrigger value=\"moderation\" data-testid=\"tab-moderation\">\n              Content Moderation\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"alerts\" className=\"space-y-4 mt-6\">\n            {pendingAlerts.length > 0 ? (\n              <div className=\"space-y-4\">\n                {pendingAlerts.map((alert) => (\n                  <Card \n                    key={alert.id} \n                    className=\"hover-elevate border-destructive/50\" \n                    data-testid={`card-alert-${alert.id}`}\n                  >\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <CardTitle className=\"text-lg\">{alert.alertType}</CardTitle>\n                            <Badge \n                              variant={\n                                alert.aiConfidence >= 80 ? \"destructive\" :\n                                alert.aiConfidence >= 60 ? \"default\" :\n                                \"secondary\"\n                              }\n                            >\n                              {alert.aiConfidence}% Confidence\n                            </Badge>\n                            <Badge variant=\"outline\">{alert.entityType}</Badge>\n                          </div>\n                          <CardDescription>\n                            Detected {new Date(alert.createdAt).toLocaleString()}\n                          </CardDescription>\n                        </div>\n                      </div>\n                      <p className=\"text-sm mt-2\">\n                        {alert.description}\n                      </p>\n                    </CardHeader>\n                    <CardContent className=\"flex gap-2\">\n                      <Button\n                        size=\"sm\"\n                        variant=\"destructive\"\n                        onClick={() => reviewAlertMutation.mutate({ id: alert.id, status: \"confirmed\" })}\n                        disabled={reviewAlertMutation.isPending}\n                        data-testid={`button-confirm-${alert.id}`}\n                      >\n                        Confirm Fraud\n                      </Button>\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => reviewAlertMutation.mutate({ id: alert.id, status: \"dismissed\" })}\n                        disabled={reviewAlertMutation.isPending}\n                        data-testid={`button-dismiss-${alert.id}`}\n                      >\n                        Dismiss\n                      </Button>\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => handleViewDetails(alert)}\n                        data-testid={`button-view-details-${alert.id}`}\n                      >\n                        <Eye className=\"h-4 w-4 mr-1\" />\n                        View Details\n                      </Button>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <div className=\"flex min-h-[400px] flex-col items-center justify-center text-center p-8\">\n                <Shield className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No pending fraud alerts</h3>\n                <p className=\"text-sm text-muted-foreground max-w-md\">\n                  All fraud alerts have been reviewed. The platform is secure!\n                </p>\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"users\" className=\"space-y-4 mt-6\">\n            <div className=\"flex items-center gap-4 mb-4\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search users by email or role...\"\n                  value={userSearch}\n                  onChange={(e) => setUserSearch(e.target.value)}\n                  className=\"pl-10\"\n                  data-testid=\"input-user-search\"\n                />\n              </div>\n              <Badge variant=\"outline\">{filteredUsers.length} users</Badge>\n            </div>\n\n            {usersLoading ? (\n              <div className=\"text-center py-8 text-muted-foreground\">Loading users...</div>\n            ) : filteredUsers.length > 0 ? (\n              <div className=\"space-y-2\">\n                {filteredUsers.map((user) => (\n                  <Card key={user.id} className=\"hover-elevate\" data-testid={`card-user-${user.id}`}>\n                    <CardContent className=\"flex items-center justify-between p-4\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <p className=\"font-medium\">{user.email}</p>\n                          <Badge variant={user.role === 'admin' ? 'destructive' : user.role === 'employer' ? 'default' : 'secondary'}>\n                            {user.role}\n                          </Badge>\n                          {user.isFlagged && (\n                            <Badge variant=\"destructive\" className=\"gap-1\">\n                              <Flag className=\"h-3 w-3\" />\n                              Flagged\n                            </Badge>\n                          )}\n                          {!user.emailVerified && (\n                            <Badge variant=\"outline\">Unverified</Badge>\n                          )}\n                        </div>\n                        <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                          <span>Joined {new Date(user.createdAt).toLocaleDateString()}</span>\n                          {user.role === 'job_seeker' && user.applicationCount !== undefined && (\n                            <span>{user.applicationCount} applications</span>\n                          )}\n                          {user.role === 'employer' && user.jobCount !== undefined && (\n                            <span>{user.jobCount} jobs posted</span>\n                          )}\n                        </div>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant={user.isFlagged ? \"default\" : \"destructive\"}\n                        onClick={() => flagUserMutation.mutate({ userId: user.id, isFlagged: !user.isFlagged })}\n                        disabled={flagUserMutation.isPending || user.role === 'admin'}\n                        data-testid={`button-flag-${user.id}`}\n                      >\n                        {user.isFlagged ? 'Unflag' : 'Flag'}\n                      </Button>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <div className=\"flex min-h-[400px] flex-col items-center justify-center text-center p-8\">\n                <Users className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No users found</h3>\n                <p className=\"text-sm text-muted-foreground max-w-md\">\n                  Try adjusting your search criteria\n                </p>\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"moderation\" className=\"space-y-4 mt-6\">\n            <div className=\"flex min-h-[400px] flex-col items-center justify-center text-center p-8\">\n              <FileText className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">Content moderation queue</h3>\n              <p className=\"text-sm text-muted-foreground max-w-md\">\n                Review flagged users, jobs, and other content here\n              </p>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n      {/* Details Dialog */}\n      <Dialog open={!!viewingDetails} onOpenChange={() => setViewingDetails(null)}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Alert Details</DialogTitle>\n            <DialogDescription>\n              {viewingDetails?.entityType === 'user' ? 'User Profile Information' : 'Job Posting Information'}\n            </DialogDescription>\n          </DialogHeader>\n\n          {loadingDetails ? (\n            <div className=\"py-8 text-center text-muted-foreground\">Loading details...</div>\n          ) : !detailsData ? (\n            <div className=\"py-8 text-center text-destructive\">Entity not found or has been deleted</div>\n          ) : viewingDetails?.entityType === 'user' ? (\n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold mb-2\">User Information</h3>\n                <div className=\"grid gap-2 text-sm\">\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Email:</span>\n                    <span className=\"col-span-2\">{detailsData.email}</span>\n                  </div>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Role:</span>\n                    <span className=\"col-span-2\">\n                      <Badge>{detailsData.role}</Badge>\n                    </span>\n                  </div>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Joined:</span>\n                    <span className=\"col-span-2\">{new Date(detailsData.createdAt).toLocaleDateString()}</span>\n                  </div>\n                  {detailsData.firstName && (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <span className=\"text-muted-foreground\">Name:</span>\n                      <span className=\"col-span-2\">{detailsData.firstName} {detailsData.lastName}</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <Separator />\n              <div>\n                <h3 className=\"font-semibold mb-2\">Profile Details</h3>\n                <div className=\"grid gap-2 text-sm\">\n                  {detailsData.headline && (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <span className=\"text-muted-foreground\">Headline:</span>\n                      <span className=\"col-span-2\">{detailsData.headline}</span>\n                    </div>\n                  )}\n                  {detailsData.bio && (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <span className=\"text-muted-foreground\">Bio:</span>\n                      <span className=\"col-span-2\">{detailsData.bio}</span>\n                    </div>\n                  )}\n                  {detailsData.location && (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <span className=\"text-muted-foreground\">Location:</span>\n                      <span className=\"col-span-2\">{detailsData.location}</span>\n                    </div>\n                  )}\n                  {detailsData.skills && detailsData.skills.length > 0 && (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <span className=\"text-muted-foreground\">Skills:</span>\n                      <div className=\"col-span-2 flex flex-wrap gap-1\">\n                        {detailsData.skills.map((skill: string, idx: number) => (\n                          <Badge key={idx} variant=\"outline\">{skill}</Badge>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold mb-2\">Job Information</h3>\n                <div className=\"grid gap-2 text-sm\">\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Title:</span>\n                    <span className=\"col-span-2 font-medium\">{detailsData.title}</span>\n                  </div>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Company:</span>\n                    <span className=\"col-span-2\">{detailsData.companyName}</span>\n                  </div>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Location:</span>\n                    <span className=\"col-span-2\">{detailsData.location}</span>\n                  </div>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Job Type:</span>\n                    <span className=\"col-span-2\">\n                      <Badge variant=\"outline\">{detailsData.jobType?.replace('_', ' ')}</Badge>\n                    </span>\n                  </div>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    <span className=\"text-muted-foreground\">Status:</span>\n                    <span className=\"col-span-2\">\n                      <Badge variant={detailsData.status === 'active' ? 'default' : 'secondary'}>{detailsData.status}</Badge>\n                    </span>\n                  </div>\n                  {(detailsData.salaryMin || detailsData.salaryMax) && (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      <span className=\"text-muted-foreground\">Salary:</span>\n                      <span className=\"col-span-2\">\n                        {detailsData.salaryMin && detailsData.salaryMax\n                          ? `₱${detailsData.salaryMin?.toLocaleString()} - ₱${detailsData.salaryMax?.toLocaleString()}`\n                          : detailsData.salaryMin \n                          ? `₱${detailsData.salaryMin?.toLocaleString()}+`\n                          : `Up to ₱${detailsData.salaryMax?.toLocaleString()}`}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <Separator />\n              <div>\n                <h3 className=\"font-semibold mb-2\">Description</h3>\n                <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{detailsData.description}</p>\n              </div>\n              {detailsData.requirements && detailsData.requirements.length > 0 && (\n                <>\n                  <Separator />\n                  <div>\n                    <h3 className=\"font-semibold mb-2\">Requirements</h3>\n                    <ul className=\"list-disc list-inside text-sm text-muted-foreground space-y-1\">\n                      {detailsData.requirements.map((req: string, idx: number) => (\n                        <li key={idx}>{req}</li>\n                      ))}\n                    </ul>\n                  </div>\n                </>\n              )}\n              {detailsData.skills && detailsData.skills.length > 0 && (\n                <>\n                  <Separator />\n                  <div>\n                    <h3 className=\"font-semibold mb-2\">Required Skills</h3>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {detailsData.skills.map((skill: string, idx: number) => (\n                        <Badge key={idx} variant=\"outline\">{skill}</Badge>\n                      ))}\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":26642,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"server/auth.ts":{"content":"import bcrypt from \"bcrypt\";\nimport jwt from \"jsonwebtoken\";\nimport { randomBytes } from \"crypto\";\nimport type { Request, Response, NextFunction, RequestHandler } from \"express\";\n\nconst SALT_ROUNDS = 10;\nconst JWT_SECRET = process.env.JWT_SECRET || process.env.SESSION_SECRET;\nconst JWT_EXPIRES_IN = \"7d\";\n\nif (!JWT_SECRET) {\n  throw new Error(\"JWT_SECRET environment variable is required for production\");\n}\n\nexport interface AuthUser {\n  userId: string;\n  email: string;\n  role: string;\n}\n\ninterface JWTPayload {\n  userId: string;\n  email: string;\n  role: string;\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, SALT_ROUNDS);\n}\n\nexport async function comparePassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\nexport function generateToken(): string {\n  return randomBytes(32).toString(\"hex\");\n}\n\nexport function generateVerificationToken(): string {\n  return randomBytes(20).toString(\"hex\");\n}\n\nexport function generateJWT(payload: JWTPayload): string {\n  return jwt.sign(payload, JWT_SECRET!, { expiresIn: JWT_EXPIRES_IN });\n}\n\nexport function verifyJWT(token: string): JWTPayload {\n  return jwt.verify(token, JWT_SECRET!) as JWTPayload;\n}\n\nfunction getAuthUser(req: Request): AuthUser | null {\n  // After isAuthenticated middleware runs, req.auth will always be populated\n  // for both session-based and JWT-based authentication\n  return req.auth || null;\n}\n\nexport const isAuthenticated: RequestHandler = (req: Request, res: Response, next: NextFunction) => {\n  try {\n    // Check session first (for backward compatibility with existing frontend)\n    if (req.session && req.session.userId && req.session.userEmail && req.session.userRole) {\n      // Populate req.auth from session for downstream middleware compatibility\n      req.auth = {\n        userId: req.session.userId,\n        email: req.session.userEmail,\n        role: req.session.userRole,\n      };\n      return next();\n    }\n\n    // Check JWT token from Authorization header\n    const authHeader = req.headers.authorization;\n    if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n      return res.status(401).json({ message: \"Unauthorized - No token provided\" });\n    }\n\n    const token = authHeader.substring(7);\n    const payload = verifyJWT(token);\n    \n    // Attach user info to request (stateless - no session creation)\n    req.auth = {\n      userId: payload.userId,\n      email: payload.email,\n      role: payload.role,\n    };\n    \n    next();\n  } catch (error) {\n    return res.status(401).json({ message: \"Unauthorized - Invalid token\" });\n  }\n};\n\nexport const isAdmin: RequestHandler = async (req: Request, res: Response, next: NextFunction) => {\n  const user = getAuthUser(req);\n  if (!user || user.role !== \"admin\") {\n    return res.status(403).json({ message: \"Forbidden: Admin access required\" });\n  }\n  next();\n};\n\nexport const isEmployer: RequestHandler = async (req: Request, res: Response, next: NextFunction) => {\n  const user = getAuthUser(req);\n  if (!user || user.role !== \"employer\") {\n    return res.status(403).json({ message: \"Forbidden: Employer access required\" });\n  }\n  next();\n};\n\nexport const isJobSeeker: RequestHandler = async (req: Request, res: Response, next: NextFunction) => {\n  const user = getAuthUser(req);\n  if (!user || user.role !== \"job_seeker\") {\n    return res.status(403).json({ message: \"Forbidden: Job seeker access required\" });\n  }\n  next();\n};\n\nexport function getUserId(req: Request): string {\n  const user = getAuthUser(req);\n  if (!user) {\n    throw new Error(\"User not authenticated\");\n  }\n  return user.userId;\n}\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId: string;\n    userRole: string;\n    userEmail: string;\n  }\n}\n\ndeclare global {\n  namespace Express {\n    interface Request {\n      auth?: AuthUser;\n    }\n  }\n}\n","path":null,"size_bytes":3887,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\n// JWT token storage\nlet authToken: string | null = null;\n\nexport function setAuthToken(token: string | null) {\n  authToken = token;\n  if (token) {\n    sessionStorage.setItem(\"auth_token\", token);\n  } else {\n    sessionStorage.removeItem(\"auth_token\");\n  }\n}\n\nexport function getAuthToken(): string | null {\n  if (!authToken) {\n    authToken = sessionStorage.getItem(\"auth_token\");\n  }\n  return authToken;\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const headers: Record<string, string> = data ? { \"Content-Type\": \"application/json\" } : {};\n  \n  // Add Authorization header if JWT token exists\n  const token = getAuthToken();\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  \n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\", // Keep for same-origin session cookies\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    // Build URL from query key, handling both path segments and query parameters\n    let url = \"\";\n    const params = new URLSearchParams();\n    \n    for (const segment of queryKey) {\n      if (typeof segment === \"string\" || typeof segment === \"number\") {\n        // Path segments\n        url += (url === \"\" ? \"\" : \"/\") + segment;\n      } else if (typeof segment === \"object\" && segment !== null) {\n        // Query parameters - merge all object properties into URLSearchParams\n        for (const [key, value] of Object.entries(segment)) {\n          if (value !== undefined && value !== null && value !== \"\" && value !== \"all\") {\n            params.append(key, String(value));\n          }\n        }\n      }\n    }\n    \n    // Append query string if params exist\n    const queryString = params.toString();\n    const finalUrl = queryString ? `${url}?${queryString}` : url;\n    \n    // Build headers with Authorization if JWT token exists\n    const headers: Record<string, string> = {};\n    const token = getAuthToken();\n    if (token) {\n      headers[\"Authorization\"] = `Bearer ${token}`;\n    }\n    \n    const res = await fetch(finalUrl, {\n      headers,\n      credentials: \"include\", // Keep for same-origin session cookies\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":3164,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4050,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Briefcase, Mail, Lock, Chrome } from \"lucide-react\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { apiRequest, setAuthToken, queryClient } from \"@/lib/queryClient\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n});\n\ntype LoginForm = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n  const [needsVerification, setNeedsVerification] = useState(false);\n  const [userEmail, setUserEmail] = useState(\"\");\n\n  const form = useForm<LoginForm>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginForm) => {\n      setUserEmail(data.email);\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", data);\n      \n      if (!response.ok) {\n        const result = await response.json();\n        const error: any = new Error(result.message || \"Login failed\");\n        error.status = response.status;\n        throw error;\n      }\n      \n      const result = await response.json();\n      return result;\n    },\n    onSuccess: async (data) => {\n      setNeedsVerification(false);\n      // Store JWT token for subsequent requests\n      if (data.token) {\n        setAuthToken(data.token);\n      }\n      \n      // Invalidate the auth query to refetch user data with new token\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n      \n      toast({\n        title: \"Welcome back!\",\n        description: \"You have successfully logged in.\",\n      });\n      \n      // Redirect based on user role\n      const role = data.user?.role;\n      if (role === \"employer\") {\n        setLocation(\"/employer/dashboard\");\n      } else if (role === \"admin\") {\n        setLocation(\"/admin/dashboard\");\n      } else {\n        setLocation(\"/dashboard\");\n      }\n    },\n    onError: (error: any) => {\n      if (error.status === 403 && error.message?.includes(\"verify your email\")) {\n        setNeedsVerification(true);\n        toast({\n          title: \"Email not verified\",\n          description: \"Please verify your email before logging in.\",\n          variant: \"destructive\",\n        });\n      } else {\n        setNeedsVerification(false);\n        toast({\n          title: \"Login failed\",\n          description: error.message || \"Invalid email or password\",\n          variant: \"destructive\",\n        });\n      }\n    },\n  });\n\n  const resendVerificationMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/auth/resend-verification\", { email: userEmail });\n      \n      if (!response.ok) {\n        const result = await response.json();\n        throw new Error(result.message || \"Failed to send verification email\");\n      }\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Verification email sent\",\n        description: \"Please check your inbox for the verification link.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to send verification email\",\n        description: error.message || \"Please try again later\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginForm) => {\n    loginMutation.mutate(data);\n  };\n\n  const handleGoogleLogin = () => {\n    window.location.href = \"/api/auth/google\";\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-accent/5 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-md bg-primary/10\">\n            <Briefcase className=\"h-6 w-6 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl font-bold\">Welcome</CardTitle>\n          <CardDescription>\n            Log in to your ZambaJobs account\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Button\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={handleGoogleLogin}\n            data-testid=\"button-google-login\"\n          >\n            <Chrome className=\"mr-2 h-4 w-4\" />\n            Continue with Google\n          </Button>\n\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <Separator />\n            </div>\n            <div className=\"relative flex justify-center text-xs uppercase\">\n              <span className=\"bg-card px-2 text-muted-foreground\">Or continue with</span>\n            </div>\n          </div>\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Mail className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                        <Input\n                          {...field}\n                          type=\"email\"\n                          placeholder=\"you@example.com\"\n                          className=\"pl-10\"\n                          data-testid=\"input-email\"\n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Lock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                        <Input\n                          {...field}\n                          type=\"password\"\n                          placeholder=\"••••••••\"\n                          className=\"pl-10\"\n                          data-testid=\"input-password\"\n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"flex justify-end\">\n                <Link href=\"/forgot-password\" className=\"text-sm text-primary hover:underline\" data-testid=\"link-forgot-password\">\n                  Forgot password?\n                </Link>\n              </div>\n\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={loginMutation.isPending}\n                data-testid=\"button-submit-login\"\n              >\n                {loginMutation.isPending ? \"Logging in...\" : \"Log In\"}\n              </Button>\n            </form>\n          </Form>\n\n          {needsVerification && (\n            <div className=\"rounded-md bg-muted p-4 text-center space-y-2\" data-testid=\"alert-verification-needed\">\n              <p className=\"text-sm text-muted-foreground\">\n                Your email is not verified. Check your inbox for the verification link.\n              </p>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => resendVerificationMutation.mutate()}\n                disabled={resendVerificationMutation.isPending}\n                data-testid=\"button-resend-verification\"\n              >\n                {resendVerificationMutation.isPending ? \"Sending...\" : \"Resend Verification Email\"}\n              </Button>\n            </div>\n          )}\n\n          <div className=\"text-center text-sm text-muted-foreground\">\n            Don't have an account?{\" \"}\n            <Link href=\"/register\" className=\"text-primary hover:underline\" data-testid=\"link-register\">\n              Sign up\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":9029,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","path":null,"size_bytes":2210,"size_tokens":null},"design_guidelines.md":{"content":"# ZambaJobs Design Guidelines\n\n## Design Approach\n**Reference-Based**: Inspired by LinkedIn's professional aesthetic with OnlineJobs.ph's clarity. Focus on trust, credibility, and efficient information presentation while maintaining modern visual appeal.\n\n## Core Design Principles\n1. **Professional Trust**: Clean, corporate design establishing credibility\n2. **Role Clarity**: Distinct visual treatments for Job Seeker, Employer, and Admin views\n3. **Information Hierarchy**: Clear content prioritization for job listings and profiles\n4. **Icon-Driven Navigation**: Strategic iconography enhancing usability\n\n## Typography\n- **Primary Font**: Inter or Open Sans via Google Fonts CDN\n- **Display Font**: Same as primary for consistency\n- **Hierarchy**:\n  - H1: 2.5rem (40px), font-bold - Page titles\n  - H2: 2rem (32px), font-semibold - Section headers\n  - H3: 1.5rem (24px), font-semibold - Card titles, job titles\n  - Body: 1rem (16px), font-normal - General content\n  - Small: 0.875rem (14px), font-normal - Metadata, timestamps\n\n## Layout System\n**Spacing Units**: Tailwind units of 4, 6, 8, 12, 16, 24\n- Component padding: p-6, p-8\n- Section spacing: py-12, py-16, py-24\n- Card gaps: gap-6, gap-8\n- Container: max-w-7xl with px-4 md:px-6 lg:px-8\n\n## Component Library\n\n### Navigation\n- **Header**: Sticky top navigation with logo left, main nav center, auth/profile right\n- Include icons: Home, Jobs, Companies, Messages, Notifications (bell icon)\n- Profile dropdown with role badge (Seeker/Employer/Admin)\n- Mobile: Hamburger menu with slide-out drawer\n\n### Hero Section\n- **Landing Page**: Full-width hero (h-96 to h-screen) with professional imagery\n- Image: Modern office environment or diverse professionals collaborating\n- Overlay: Gradient overlay for text readability\n- Content: Bold headline, subheading, dual CTA buttons (Sign Up, Browse Jobs)\n- Search bar prominently featured in hero for job search\n\n### Job Listings\n- **Card Layout**: Grid system (grid-cols-1 md:grid-cols-2 lg:grid-cols-3)\n- Each card includes:\n  - Company logo (top-left, rounded)\n  - Job title (H3)\n  - Company name with verification badge icon\n  - Location icon + location\n  - Clock icon + posted time\n  - Salary range with dollar icon\n  - Tag pills for job type (Remote, Full-time, etc.)\n  - Bookmark icon (top-right)\n- Hover state: Subtle elevation increase\n\n### Profile Components\n- **Professional Background Section**:\n  - Work Experience: Briefcase icon, company logo, role, duration, description\n  - Education: Graduation cap icon, institution, degree, years\n  - Certifications: Award/certificate icon, certification name, issuer\n  - Skills: Tag pills with checkmark icons\n  - Portfolio Links: LinkedIn icon, GitHub icon, personal website icon\n- Timeline layout for experience/education (vertical line connecting entries)\n\n### Forms & Inputs\n- **Registration/Login**: Clean centered card (max-w-md)\n- Google Sign-In: Large button with Google logo, \"Continue with Google\"\n- Divider: \"OR\" with horizontal lines\n- Input fields: Icon prefix (email icon, lock icon, user icon)\n- Resume upload: Drag-drop zone with upload icon and file preview\n- Form validation: Inline error messages with warning icon\n\n### Dashboard Layouts\n- **Job Seeker**: \n  - Sidebar: Profile completion meter, quick stats (applications, views)\n  - Main: Recommended jobs feed, recent applications table\n  \n- **Employer**:\n  - Sidebar: Active job postings count, candidate pipeline\n  - Main: Job management table, candidate recommendations\n  \n- **Super Admin**:\n  - Alert panel: Flagged content with warning icons, AI confidence scores\n  - Moderation queue: Review cards with approve/reject actions\n  - System stats: Dashboard widgets with trend charts\n\n### Application Flow\n- Apply button: Prominent primary CTA\n- Application modal: Cover letter textarea, resume selection, submit\n- Status badges: Applied (blue), Reviewing (yellow), Rejected (red), Accepted (green)\n- Timeline view: Progress tracker with icons for each stage\n\n### AI Features UI\n- **Fraud Detection Alerts**: Yellow/red warning cards with shield icon\n- **Job Match Score**: Percentage badge with AI sparkle icon\n- **Smart Suggestions**: Recommendation cards with \"AI Matched\" label\n\n## Icons\n**Library**: Heroicons via CDN\n- Professional background: briefcase, academic-cap, certificate, code, link\n- Navigation: home, briefcase, building, chat, bell, user\n- Actions: bookmark, heart, share, filter, search, upload, trash, check, x\n- Status: shield-check, shield-exclamation, clock, map-pin\n\n## Animations\n**Minimal & Purposeful**:\n- Card hover: Subtle translate-y and shadow increase (transition-transform duration-200)\n- Button states: Scale on click (active:scale-95)\n- Page transitions: Fade-in for content load\n- NO scroll-based animations, parallax, or decorative motion\n\n## Images\n- **Hero**: High-quality professional workspace or team collaboration (1920x800px minimum)\n- **Company Logos**: Displayed in job cards and employer profiles (100x100px, rounded)\n- **Profile Photos**: User avatars (circular, 40px, 80px, 160px sizes)\n- **Placeholder**: Use gradient backgrounds with initials for missing avatars\n\n## Responsive Behavior\n- Desktop (lg:): Multi-column layouts, expanded sidebar\n- Tablet (md:): 2-column grids, collapsible sidebar\n- Mobile: Single column, bottom navigation for key actions, hamburger menu\n\n## Trust & Security Elements\n- Verification badges: Blue checkmark icon for verified employers\n- Security indicators: Lock icon for secure pages, shield for fraud protection\n- Data privacy: Badge/seal in footer (\"Secure & Private\")\n- Email verification: Envelope icon with status indicator","path":null,"size_bytes":5644,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/pages/employer-dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Briefcase, Plus, Users, Eye, Sparkles, TrendingUp, Building2 } from \"lucide-react\";\nimport type { Job, Application } from \"@shared/schema\";\n\nexport default function EmployerDashboard() {\n  const { data: jobs, isLoading: jobsLoading } = useQuery<Job[]>({\n    queryKey: [\"/api/employer/jobs\"],\n  });\n\n  const { data: candidates, isLoading: candidatesLoading } = useQuery<any[]>({\n    queryKey: [\"/api/employer/candidates\"],\n  });\n\n  const activeJobs = jobs?.filter(j => j.isActive && !j.isFlagged) || [];\n  const totalApplications = 0; // TODO: Get from applications query\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"container max-w-7xl mx-auto flex h-16 items-center justify-between px-4 md:px-6 lg:px-8\">\n          <Link href=\"/jobs\">\n            <div className=\"flex items-center gap-2 hover-elevate active-elevate-2 rounded-md px-3 py-2\">\n              <Briefcase className=\"h-6 w-6 text-primary\" />\n              <span className=\"text-xl font-bold\">ZambaJobs</span>\n            </div>\n          </Link>\n          \n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/employer/post-job\">\n              <Button data-testid=\"button-post-job\">\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Post a Job\n              </Button>\n            </Link>\n            <Link href=\"/profile\">\n              <Button variant=\"outline\" data-testid=\"button-profile\">\n                <Building2 className=\"mr-2 h-4 w-4\" />\n                Company Profile\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"container max-w-7xl mx-auto py-8 px-4 md:px-6 lg:px-8\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Employer Dashboard</h1>\n          <p className=\"text-muted-foreground\">Manage your job postings and find great candidates</p>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid gap-6 md:grid-cols-3 mb-8\">\n          <Card data-testid=\"card-stat-jobs\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Active Jobs</CardDescription>\n              <CardTitle className=\"text-3xl\">{activeJobs.length}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Briefcase className=\"h-3 w-3\" />\n                <span>Total postings</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-applications\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Applications</CardDescription>\n              <CardTitle className=\"text-3xl\">{totalApplications}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Users className=\"h-3 w-3\" />\n                <span>From all jobs</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-candidates\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Recommended Candidates</CardDescription>\n              <CardTitle className=\"text-3xl\">{candidates?.length || 0}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Sparkles className=\"h-3 w-3\" />\n                <span>AI-matched</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Main Content */}\n        <Tabs defaultValue=\"jobs\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"jobs\" data-testid=\"tab-jobs\">\n              My Job Postings\n            </TabsTrigger>\n            <TabsTrigger value=\"candidates\" data-testid=\"tab-candidates\">\n              Recommended Candidates\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"jobs\" className=\"space-y-4 mt-6\">\n            {activeJobs.length > 0 ? (\n              <div className=\"space-y-4\">\n                {activeJobs.map((job) => (\n                  <Card key={job.id} className=\"hover-elevate\" data-testid={`card-job-${job.id}`}>\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <CardTitle>{job.title}</CardTitle>\n                            {job.isActive && (\n                              <Badge variant=\"default\">Active</Badge>\n                            )}\n                          </div>\n                          <CardDescription>{job.location} • {job.jobType.replace('_', ' ')}</CardDescription>\n                        </div>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground line-clamp-2 mt-2\">\n                        {job.description}\n                      </p>\n                    </CardHeader>\n                    <CardContent className=\"flex flex-wrap gap-4 text-sm\">\n                      <div className=\"flex items-center gap-2\">\n                        <Eye className=\"h-4 w-4 text-muted-foreground\" />\n                        <span>Posted {new Date(job.createdAt).toLocaleDateString()}</span>\n                      </div>\n                    </CardContent>\n                    <CardContent className=\"pt-0 flex gap-2\">\n                      <Link href={`/employer/jobs/${job.id}`}>\n                        <Button data-testid={`button-manage-${job.id}`}>Manage</Button>\n                      </Link>\n                      <Link href={`/jobs/${job.id}`}>\n                        <Button variant=\"outline\" data-testid={`button-preview-${job.id}`}>Preview</Button>\n                      </Link>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <div className=\"flex min-h-[400px] flex-col items-center justify-center text-center p-8\">\n                <Briefcase className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No active job postings</h3>\n                <p className=\"text-sm text-muted-foreground max-w-md mb-4\">\n                  Create your first job posting to start finding great candidates\n                </p>\n                <Link href=\"/employer/post-job\">\n                  <Button>\n                    <Plus className=\"mr-2 h-4 w-4\" />\n                    Post a Job\n                  </Button>\n                </Link>\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"candidates\" className=\"space-y-4 mt-6\">\n            {candidates && candidates.length > 0 ? (\n              <div className=\"space-y-4\">\n                {candidates.map((candidate) => (\n                  <Card key={candidate.id} className=\"hover-elevate\" data-testid={`card-candidate-${candidate.id}`}>\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <CardTitle>{candidate.firstName} {candidate.lastName}</CardTitle>\n                            {candidate.matchScore && (\n                              <Badge variant=\"default\" className=\"gap-1\">\n                                <Sparkles className=\"h-3 w-3\" />\n                                {candidate.matchScore}% Match\n                              </Badge>\n                            )}\n                          </div>\n                          <CardDescription>{candidate.headline || \"Job Seeker\"}</CardDescription>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"flex gap-2\">\n                      <Button data-testid={`button-view-candidate-${candidate.id}`}>View Profile</Button>\n                      <Button variant=\"outline\">Message</Button>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <div className=\"flex min-h-[400px] flex-col items-center justify-center text-center p-8\">\n                <Sparkles className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No candidate recommendations yet</h3>\n                <p className=\"text-sm text-muted-foreground max-w-md mb-4\">\n                  Post jobs to get AI-powered candidate recommendations\n                </p>\n                <Link href=\"/employer/post-job\">\n                  <Button>\n                    <Plus className=\"mr-2 h-4 w-4\" />\n                    Post a Job\n                  </Button>\n                </Link>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9662,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"replit.md":{"content":"# ZambaJobs - AI-Powered Job Portal\n\n## Overview\nZambaJobs is a secure, AI-powered job portal designed to connect job seekers with employers while actively preventing fraudulent activities. It offers intelligent job matching, AI-driven fraud detection, and role-based access for job seekers, employers, and administrators. The platform emphasizes a professional, LinkedIn-inspired design to build trust and efficiently present information, supporting modern recruitment workflows such as profile management, job applications, candidate matching, and administrative fraud monitoring. Key features include automatic profile and resume persistence, OTP email authentication, and a comprehensive admin panel for managing users, jobs, fraud alerts, and platform analytics. The project aims to provide a robust and secure platform for the job market.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\nThe frontend is built with React and TypeScript, using Vite for tooling and Wouter for routing. TanStack Query manages server state, while React Hook Form with Zod handles form validation. The UI leverages Shadcn/ui, Radix UI primitives, and Tailwind CSS for styling, following a \"New York\" style variant with custom CSS variables, Inter/Open Sans fonts, and Lucide React icons. The design system emphasizes 4px unit spacing, consistent elevation, icon-driven navigation, and responsive grid layouts with a mobile-first approach.\n\n### Backend Architecture\nThe backend uses Express.js with TypeScript, implementing a RESTful API design with middleware for logging and error handling. Authentication and authorization are managed using Bcrypt for password hashing, JWT for stateless authentication, session management with PostgreSQL, and role-based access control (job_seeker, employer, admin). It includes email verification, password reset, and OTP authentication with a 10-minute expiry, 5-attempt lockout, and rate limiting. The API structure is modular, covering authentication, jobs, profiles, employer operations, and administrative tasks, with consistent error handling.\n\n### Data Storage\nPostgreSQL, accessed via Neon serverless driver and Drizzle ORM, is used for data storage. The schema includes Users (role-based), JobSeekerProfiles, EmployerProfiles, WorkExperience, Education, Certifications, Jobs, Applications, FraudAlerts, and Sessions, with relationships such as one-to-one (User to Profile), one-to-many (Profile to experience/education, Employer to Jobs), and many-to-many (Job Seekers to Jobs via Applications).\n\n### AI Integration\nThe platform integrates with the OpenAI API (GPT-5 model) for all AI operations, including fraud detection and smart matching, expecting JSON-structured responses. Fraud detection analyzes user profiles and job postings for suspicious patterns, assigning confidence scores and generating alerts. Smart matching provides AI-powered job recommendations based on comprehensive candidate profiles, including skills, work experience, education, certifications, resume/portfolio presence, and location compatibility, providing detailed match scores (0-100) with reasoning tailored for the Philippine job market.\n\n### File Storage\nGoogle Cloud Storage is integrated for profile images and resume uploads, utilizing object storage, ACL policies, and owner-based access control, integrated with Replit's sidecar for authentication.\n\n### Feature Specifications\n- **Secure Session Management:** Complete session termination on logout with cache-control headers preventing browser caching of authenticated pages. Logout clears server-side session, client-side cookie (with matching httpOnly, secure, sameSite options), all cached queries, and forces page reload to prevent back button access to authenticated content.\n- **Analytics Reporting System:** Comprehensive analytics dashboards for Admins (platform-wide metrics), Employers (job performance metrics), and Job Seekers (personal application tracking). All dashboards include interactive graphs, trend analysis (30-day window), distribution charts, and CSV export capabilities.\n- **Resume Upload Validation:** Enhanced backend validation for resume uploads, ensuring file path format, existence in object storage, valid document types (PDF, DOC, DOCX), and maximum file size (10MB).\n- **Employer Applicant Portfolio Viewer:** Employers can view complete candidate profiles, including profile picture, headline, bio, contact details, skills, work experience, education, certifications, and direct resume download links.\n- **Admin User Management:** Admins can delete user accounts (with cascade deletion of related data), create new admin accounts, and manage user lists with pagination. Additionally, admins can view complete user credentials through a \"View\" button that displays a comprehensive dialog with full name, email, role, verification status, location, bio, company info, phone number, skills, and activity statistics.\n- **Profile Picture and Resume Auto-Save:** Automatically saves profile pictures and resumes upon upload. The system decouples the profile form from query data to maintain unsaved edits during uploads, validates all form data using Zod schema, and handles empty fields and errors gracefully.\n- **Enhanced AI Job Recommendations:** Upgraded AI matching algorithm utilizing comprehensive candidate profiles for more accurate recommendations, considering skills, work history, education, certifications, resume/portfolio presence, and location compatibility, with detailed scoring and reasoning.\n- **Fraud Alert Details Viewer:** Admins can view comprehensive details of flagged users or jobs from fraud alerts via a \"View Details\" button. The modal displays a prominent warning box with the fraud alert reason, confidence score, and alert type, followed by full user profiles (name, email, role, location, bio, skills) or complete job postings (title, company, description, requirements, salary) fetched from the `/api/admin/fraud-alerts/:id/details` endpoint.\n- **Enhanced Job Management Search:** Improved search functionality in admin job management to show all jobs when the search field is empty and search across multiple fields including title, location, job type, and company name.\n- **Employer Job Post Management:** Employers can fully manage their job postings with edit, toggle active/inactive, and delete capabilities. Features include a comprehensive edit dialog with all job fields, ownership verification for security, automatic fraud detection on updates, and real-time UI updates via query invalidation. Accessible from the Job Management page (`/employer/jobs/:id`).\n- **Admin Contact Reply System:** Fixed critical bug in admin contact messaging where reply textareas used shared state causing typing issues. Now implements per-message reply state using Record<string, string> mapping for independent reply composition across multiple contact messages.\n- **Requirement Document Upload:** Employers can upload requirement documents (PDF, DOC, DOCX, max 10MB) when creating job postings via the `/api/objects/upload-document` endpoint. Documents are stored in Google Cloud Storage with objectPath stored in the `requirementDocumentUrl` field. The endpoint validates file type, size, and enforces employer-only authentication. Access pattern: frontend calls endpoint with `{contentType, fileSize}`, receives `{uploadURL, objectPath}`, uploads to GCS, then stores objectPath in job record. Documents are accessed via `/objects/` + objectPath pattern for secure authenticated downloads.\n- **Admin Document Preview:** Admins can preview employer-uploaded requirement documents in Admin Job Management through a \"View Document\" button that opens documents in a new browser tab via the `/objects/` endpoint for secure access with authentication checks.\n- **Admin Resume Preview:** Admins can view job seeker and employer resumes through the User Management interface. The \"View\" button displays complete user details including a \"View Resume\" button (when resumeUrl exists) that opens resumes in a new browser tab via the `/objects/` endpoint. Enhanced `getUsersWithStats()` function returns complete user profiles including resumeUrl, firstName, lastName, isEmailVerified, flagged status, and role-specific details (headline, bio, location, skills, companyName) for comprehensive admin visibility.\n- **Admin Job Management Actions:** Admins have full job management capabilities including: (1) View/Manage button displaying comprehensive job details modal with title, company, description, requirements, responsibilities, benefits, location, salary, and document attachments accessible via `/objects/` endpoint, and (2) Delete button with confirmation dialog backed by `/api/admin/jobs/:id` endpoint that bypasses ownership checks for administrative deletions.\n- **Sign-Up Agreements:** Mandatory sign-up agreements implemented for both job seekers and employers. Users must read and accept role-specific agreements before registration. Agreements are displayed in a scrollable dialog with full terms and conditions, validated through a required checkbox in the registration form. The backend safely handles the agreement field by stripping it before database persistence.\n- **Consistent Field Naming:** All resume-related API responses use camelCase `resumeUrl` consistently across frontend and backend for proper type safety and predictability. The `/api/resume` endpoint accepts `resumeUrl` in request body matching the database schema definition.\n- **Application Status Management:** Employers can manage job applications through Accept, Review, and Reject actions. The job management interface displays applications in tabs (Pending, Reviewing, Accepted, Rejected) with status badges and action buttons. Status updates use the `/api/applications/:id` endpoint with optimistic UI updates via TanStack Query invalidation. Buttons disable when status matches current state to prevent redundant updates.\n- **Employer Resume Access Control:** Employers can view applicant resumes only when the job seeker has applied to their posted jobs. The `/objects/:id` endpoint validates application relationships before granting resume access, ensuring resumes remain scoped to legitimate recruitment interactions.\n- **Enhanced Fraud Alert Visibility:** Fraud alerts now display comprehensive context about flagged content and reviewers across all alert states (Pending, Confirmed, Dismissed). The `/api/admin/fraud-alerts` endpoint enriches each alert with entityInfo (showing the specific user or job that was flagged with name/email/role or title/company/employer details) and reviewerInfo (displaying which admin reviewed the alert). Frontend displays this information consistently across all three alert sections with visual differentiation: red styling for confirmed alerts, green for dismissed alerts. The system automatically captures reviewer identity when admins update alert status, providing full audit trail of fraud detection and review actions.\n- **Admin Job Fraud Alert Details:** The admin job management View dialog now displays fraud alert details for flagged jobs, including alert type, AI confidence score, status, and reason. For manually flagged jobs (no AI alert), shows \"Manually flagged by administrator\" as the reason with \"Manual Review\" type and hidden confidence score.\n- **All-Jobs AI Matching Dashboard:** Job seeker dashboard now displays ALL matching jobs from the platform with AI-powered scoring and reasoning. The `/api/jobs/recommended` endpoint processes all active, non-flagged jobs using batch processing (5 concurrent) for efficiency. Shows match count, color-coded match badges (70+ green, 50-69 gray, 30-49 outline), and AI-generated reasoning explaining why each job matches the candidate's profile. Uses `calculateJobMatchWithReasoning` function that returns both score and detailed explanation.\n\n## External Dependencies\n\n### Third-Party Services\n- **AI Services:** OpenAI API (GPT-5)\n- **Cloud Storage:** Google Cloud Storage\n- **Database:** Neon PostgreSQL (serverless)\n- **Email Service:** Resend\n\n### NPM Packages\n- **Core Dependencies:** `@neondatabase/serverless`, `drizzle-orm`, `express`, `bcrypt`, `jsonwebtoken`, `openai`\n- **React Ecosystem:** `@tanstack/react-query`, `react-hook-form`, `@hookform/resolvers`, `zod`, `wouter`\n- **UI Libraries:** `@radix-ui/*`, `tailwindcss`, `class-variance-authority`, `lucide-react`, `cmdk`\n- **Development Tools:** `TypeScript`, `Vite`, `tsx`, `esbuild`\n\n### Environment Configuration\n- `DATABASE_URL`\n- `JWT_SECRET` or `SESSION_SECRET`\n- `AI_INTEGRATIONS_OPENAI_BASE_URL`\n- `AI_INTEGRATIONS_OPENAI_API_KEY`\n- `APP_URL`\n- `ADMIN_EMAIL`\n- `PUBLIC_OBJECT_SEARCH_PATHS`","path":null,"size_bytes":12765,"size_tokens":null},"client/src/components/app-sidebar.tsx":{"content":"import { useLocation } from \"wouter\";\nimport {\n  Briefcase,\n  LayoutDashboard,\n  Search,\n  FileText,\n  Users,\n  Shield,\n  Settings,\n  LogOut,\n  User,\n  Building2,\n  AlertTriangle,\n  BarChart3,\n  Mail,\n  UserCog,\n} from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarHeader,\n  SidebarFooter,\n  SidebarRail,\n} from \"@/components/ui/sidebar\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/contexts/auth-context\";\nimport { queryClient } from \"@/lib/queryClient\";\n\nexport function AppSidebar() {\n  const [location, setLocation] = useLocation();\n  const { user, isLoading } = useAuth();\n\n  const handleLogout = async () => {\n    try {\n      const response = await fetch(\"/api/auth/logout\", {\n        method: \"POST\",\n        credentials: \"include\",\n      });\n      \n      if (response.ok) {\n        // Clear all cached queries to remove any user-specific data\n        queryClient.clear();\n        \n        // Replace current history entry to prevent back button from showing cached pages\n        window.history.replaceState(null, '', '/');\n        \n        // Navigate to landing page\n        setLocation(\"/\");\n        \n        // Force a page reload to ensure clean state\n        window.location.href = '/';\n      } else {\n        console.error(\"Logout failed\");\n      }\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n    }\n  };\n\n  // Don't render sidebar AT ALL until user is resolved\n  if (!user) {\n    return null;\n  }\n\n  const jobSeekerItems = [\n    {\n      title: \"Dashboard\",\n      url: \"/dashboard\",\n      icon: LayoutDashboard,\n    },\n    {\n      title: \"Find Jobs\",\n      url: \"/jobs\",\n      icon: Search,\n    },\n    {\n      title: \"Analytics\",\n      url: \"/analytics\",\n      icon: BarChart3,\n    },\n    {\n      title: \"Contact Support\",\n      url: \"/contact\",\n      icon: Mail,\n    },\n  ];\n\n  const employerItems = [\n    {\n      title: \"Dashboard\",\n      url: \"/employer/dashboard\",\n      icon: LayoutDashboard,\n    },\n    {\n      title: \"Analytics\",\n      url: \"/employer/analytics\",\n      icon: BarChart3,\n    },\n    {\n      title: \"Contact Support\",\n      url: \"/employer/contact\",\n      icon: Mail,\n    },\n  ];\n\n  const adminItems = [\n    {\n      title: \"Dashboard\",\n      url: \"/admin/dashboard\",\n      icon: LayoutDashboard,\n    },\n    {\n      title: \"Fraud Detection\",\n      url: \"/admin/fraud\",\n      icon: AlertTriangle,\n    },\n    {\n      title: \"User Management\",\n      url: \"/admin/users\",\n      icon: Users,\n    },\n    {\n      title: \"Job Management\",\n      url: \"/admin/jobs\",\n      icon: Briefcase,\n    },\n    {\n      title: \"Contact Messages\",\n      url: \"/admin/contacts\",\n      icon: Mail,\n    },\n    {\n      title: \"Report Analytics\",\n      url: \"/admin/analytics\",\n      icon: BarChart3,\n    },\n    {\n      title: \"Admin Management\",\n      url: \"/admin/admins\",\n      icon: UserCog,\n    },\n  ];\n\n  const getMenuItems = () => {\n    if (!user) {\n      return [\n        {\n          title: \"Dashboard\",\n          url: \"/dashboard\",\n          icon: LayoutDashboard,\n        },\n      ];\n    }\n    switch (user.role) {\n      case \"job_seeker\":\n        return jobSeekerItems;\n      case \"employer\":\n        return employerItems;\n      case \"admin\":\n        return adminItems;\n      default:\n        return [];\n    }\n  };\n\n  const menuItems = getMenuItems();\n\n  const getDashboardUrl = () => {\n    switch (user.role) {\n      case \"job_seeker\":\n        return \"/dashboard\";\n      case \"employer\":\n        return \"/employer/dashboard\";\n      case \"admin\":\n        return \"/admin/dashboard\";\n      default:\n        return \"/\";\n    }\n  };\n\n  return (\n    <Sidebar collapsible=\"icon\" data-testid=\"app-sidebar\">\n      <SidebarHeader className=\"border-b p-4\">\n        <button\n          onClick={() => setLocation(getDashboardUrl())}\n          className=\"flex items-center gap-2 hover-elevate rounded-md p-2 -m-2 w-full text-left\"\n          data-testid=\"logo-button\"\n        >\n          <Briefcase className=\"h-6 w-6 text-primary\" />\n          <span className=\"text-lg font-bold group-data-[collapsible=icon]:hidden\">\n            ZambaJobs\n          </span>\n        </button>\n      </SidebarHeader>\n\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Navigation</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton\n                    onClick={() => setLocation(item.url)}\n                    isActive={location === item.url}\n                    data-testid={`nav-${item.title.toLowerCase().replace(/\\s+/g, '-')}`}\n                  >\n                    <item.icon className=\"h-4 w-4\" />\n                    <span>{item.title}</span>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarGroup>\n          <SidebarGroupLabel>Account</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              <SidebarMenuItem>\n                <SidebarMenuButton onClick={handleLogout} data-testid=\"nav-logout\">\n                  <LogOut className=\"h-4 w-4\" />\n                  <span>Logout</span>\n                </SidebarMenuButton>\n              </SidebarMenuItem>\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n\n      <SidebarFooter className=\"border-t p-4\">\n        <div className=\"group-data-[collapsible=icon]:hidden\">\n          <p className=\"text-sm font-medium\">{user.firstName} {user.lastName}</p>\n          <p className=\"text-xs text-muted-foreground\">{user.email}</p>\n          <p className=\"text-xs text-muted-foreground capitalize mt-1\">\n            {user.role?.replace('_', ' ')}\n          </p>\n        </div>\n      </SidebarFooter>\n\n      <SidebarRail />\n    </Sidebar>\n  );\n}\n","path":null,"size_bytes":6075,"size_tokens":null},"client/src/contexts/auth-context.tsx":{"content":"import { createContext, useContext } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { User as UserType } from \"@shared/schema\";\n\ninterface AuthContextType {\n  user: UserType | null | undefined;\n  isLoading: boolean;\n  isError: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | null>(null);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const { data: user, isLoading, isError } = useQuery<UserType>({\n    queryKey: [\"/api/auth/me\"],\n    retry: false,\n  });\n\n  return (\n    <AuthContext.Provider value={{ user, isLoading, isError }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":839,"size_tokens":null},"client/src/pages/verify-email.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { CheckCircle2, XCircle, Loader2 } from \"lucide-react\";\nimport { queryClient } from \"@/lib/queryClient\";\n\nexport default function VerifyEmail() {\n  const [, navigate] = useLocation();\n  const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\n  const [message, setMessage] = useState('');\n\n  useEffect(() => {\n    const verifyEmail = async () => {\n      const urlParams = new URLSearchParams(window.location.search);\n      const token = urlParams.get('token');\n\n      if (!token) {\n        setStatus('error');\n        setMessage('Invalid verification link - no token provided');\n        return;\n      }\n\n      try {\n        const response = await fetch(`/api/auth/verify-email?token=${encodeURIComponent(token)}`);\n        const data = await response.json();\n\n        if (response.ok) {\n          setStatus('success');\n          setMessage(data.message || 'Email verified successfully!');\n          // Refresh auth context in case user is logged in\n          queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n        } else {\n          setStatus('error');\n          setMessage(data.message || 'Verification failed');\n        }\n      } catch (error) {\n        setStatus('error');\n        setMessage('An error occurred during verification');\n        console.error('Verification error:', error);\n      }\n    };\n\n    verifyEmail();\n  }, []);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex justify-center mb-4\">\n            {status === 'loading' && (\n              <Loader2 className=\"h-16 w-16 text-primary animate-spin\" data-testid=\"loader-verification\" />\n            )}\n            {status === 'success' && (\n              <CheckCircle2 className=\"h-16 w-16 text-green-600\" data-testid=\"icon-success\" />\n            )}\n            {status === 'error' && (\n              <XCircle className=\"h-16 w-16 text-destructive\" data-testid=\"icon-error\" />\n            )}\n          </div>\n          <CardTitle data-testid=\"title-verification\">\n            {status === 'loading' && 'Verifying Email...'}\n            {status === 'success' && 'Email Verified!'}\n            {status === 'error' && 'Verification Failed'}\n          </CardTitle>\n          <CardDescription data-testid=\"text-message\">\n            {message}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {status === 'success' && (\n            <Button\n              onClick={() => navigate('/login')}\n              className=\"w-full\"\n              data-testid=\"button-login\"\n            >\n              Go to Login\n            </Button>\n          )}\n          {status === 'error' && (\n            <div className=\"space-y-2\">\n              <Button\n                onClick={() => navigate('/login')}\n                className=\"w-full\"\n                data-testid=\"button-back-to-login\"\n              >\n                Back to Login\n              </Button>\n              <p className=\"text-sm text-center text-muted-foreground\">\n                Need help? Contact support or try registering again.\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":3549,"size_tokens":null},"client/src/pages/profile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/contexts/auth-context\";\nimport { \n  User, Briefcase, GraduationCap, Award, FileText, Plus, Trash2, \n  MapPin, Phone, Linkedin, Globe, Upload, Building2\n} from \"lucide-react\";\nimport type { JobSeekerProfile, WorkExperience, Education, Certification, EmployerProfile } from \"@shared/schema\";\nimport { PhilippineDatePicker } from \"@/components/philippine-date-picker\";\nimport { formatPhilippinePhone, isValidPhilippinePhone } from \"@/lib/philippines\";\n\nconst profileSchema = z.object({\n  headline: z.string().min(3, \"Headline must be at least 3 characters\").or(z.literal(\"\")).optional(),\n  bio: z.string().min(10, \"Bio must be at least 10 characters\").or(z.literal(\"\")).optional(),\n  location: z.string().optional(),\n  phoneNumber: z.string()\n    .optional()\n    .refine((val) => !val || val.trim() === \"\" || isValidPhilippinePhone(val), {\n      message: \"Please enter a valid Philippine phone number (e.g., +63 912-345-6789 or 0912-345-6789)\",\n    })\n    .transform((val) => (val && val.trim()) ? formatPhilippinePhone(val) : val),\n  linkedinUrl: z.string().url(\"Must be a valid URL\").optional().or(z.literal(\"\")),\n  portfolioUrl: z.string().url(\"Must be a valid URL\").optional().or(z.literal(\"\")),\n  skills: z.string().optional(), // Comma-separated\n  profileImage: z.string().optional(),\n  resumeUrl: z.string().optional(),\n});\n\nconst workExpSchema = z.object({\n  companyName: z.string().min(1, \"Company name is required\"),\n  position: z.string().min(1, \"Position is required\"),\n  location: z.string().optional(),\n  startDate: z.string().min(1, \"Start date is required\"), // YYYY-MM format\n  endDate: z.string().optional(), // YYYY-MM format\n  isCurrent: z.boolean().default(false),\n  description: z.string().optional(),\n});\n\nconst educationSchema = z.object({\n  institution: z.string().min(1, \"Institution is required\"),\n  degree: z.string().min(1, \"Degree is required\"),\n  fieldOfStudy: z.string().optional(),\n  startYear: z.string().min(1, \"Start year is required\"),\n  endYear: z.string().optional(),\n  description: z.string().optional(),\n});\n\nconst certificationSchema = z.object({\n  name: z.string().min(1, \"Certificate name is required\"),\n  issuer: z.string().min(1, \"Issuer is required\"),\n  issueDate: z.string().optional(),\n  expiryDate: z.string().optional(),\n  credentialUrl: z.string().url(\"Must be a valid URL\").optional().or(z.literal(\"\")),\n});\n\ntype ProfileForm = z.infer<typeof profileSchema>;\ntype WorkExpForm = z.infer<typeof workExpSchema>;\ntype EducationForm = z.infer<typeof educationSchema>;\ntype CertificationForm = z.infer<typeof certificationSchema>;\n\nexport default function Profile() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [showWorkExpForm, setShowWorkExpForm] = useState(false);\n  const [showEducationForm, setShowEducationForm] = useState(false);\n  const [showCertForm, setShowCertForm] = useState(false);\n  const [isUploadingImage, setIsUploadingImage] = useState(false);\n  const [isUploadingResume, setIsUploadingResume] = useState(false);\n\n  const { data: profileData, isLoading } = useQuery<any>({\n    queryKey: [\"/api/profile\"],\n  });\n\n  const profile = profileData as JobSeekerProfile & {\n    workExperience?: WorkExperience[];\n    education?: Education[];\n    certifications?: Certification[];\n  };\n  \n  const employerProfile = profileData as EmployerProfile;\n\n  const form = useForm<ProfileForm>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      headline: \"\",\n      bio: \"\",\n      location: \"\",\n      phoneNumber: \"\",\n      linkedinUrl: \"\",\n      portfolioUrl: \"\",\n      skills: \"\",\n      profileImage: \"\",\n      resumeUrl: \"\",\n    },\n  });\n\n  // Reset form when profile data is first loaded (not on every update)\n  useEffect(() => {\n    if (profile && !isLoading) {\n      form.reset({\n        headline: profile.headline || \"\",\n        bio: profile.bio || \"\",\n        location: profile.location || \"\",\n        phoneNumber: profile.phoneNumber || \"\",\n        linkedinUrl: profile.linkedinUrl || \"\",\n        portfolioUrl: profile.portfolioUrl || \"\",\n        skills: profile.skills?.join(\", \") || \"\",\n        profileImage: profile.profileImage || \"\",\n        resumeUrl: profile.resumeUrl || \"\",\n      });\n    }\n  }, [profile?.id, isLoading, form]); // Include form in dependencies\n  \n  // Employer form - always initialize to avoid hooks violation\n  const employerForm = useForm({\n    defaultValues: {\n      companyName: employerProfile?.companyName || \"\",\n      companyDescription: employerProfile?.companyDescription || \"\",\n      industry: employerProfile?.industry || \"\",\n      companyWebsite: employerProfile?.companyWebsite || \"\",\n      location: employerProfile?.location || \"\",\n    },\n    values: {\n      companyName: employerProfile?.companyName || \"\",\n      companyDescription: employerProfile?.companyDescription || \"\",\n      industry: employerProfile?.industry || \"\",\n      companyWebsite: employerProfile?.companyWebsite || \"\",\n      location: employerProfile?.location || \"\",\n    },\n  });\n\n  const workExpForm = useForm<WorkExpForm>({\n    resolver: zodResolver(workExpSchema),\n    defaultValues: {\n      companyName: \"\",\n      position: \"\",\n      location: \"\",\n      startDate: \"\",\n      endDate: \"\",\n      isCurrent: false,\n      description: \"\",\n    },\n  });\n\n  const educationForm = useForm<EducationForm>({\n    resolver: zodResolver(educationSchema),\n    defaultValues: {\n      institution: \"\",\n      degree: \"\",\n      fieldOfStudy: \"\",\n      startYear: \"\",\n      endYear: \"\",\n      description: \"\",\n    },\n  });\n\n  const certForm = useForm<CertificationForm>({\n    resolver: zodResolver(certificationSchema),\n    defaultValues: {\n      name: \"\",\n      issuer: \"\",\n      issueDate: \"\",\n      expiryDate: \"\",\n      credentialUrl: \"\",\n    },\n  });\n\n  const handleResumeUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Client-side validation\n    const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB\n    const ALLOWED_TYPES = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      toast({ \n        title: \"Invalid file type\", \n        description: \"Only PDF and Word documents are allowed\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    if (file.size > MAX_FILE_SIZE) {\n      toast({ \n        title: \"File too large\", \n        description: \"Resume must be under 10MB\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    try {\n      setIsUploadingResume(true);\n      \n      // Get resume upload URL with validation\n      const response = await apiRequest(\"POST\", \"/api/objects/upload-resume\", {\n        contentType: file.type,\n        fileSize: file.size\n      });\n      const data: any = await response.json();\n      const { uploadURL, objectPath } = data;\n      console.log(\"DEBUG: Resume upload response:\", { uploadURL: uploadURL ? \"YES\" : \"NO\", objectPath });\n      \n      // Upload resume to object storage\n      const uploadResponse = await fetch(uploadURL, {\n        method: \"PUT\",\n        body: file,\n        headers: {\n          \"Content-Type\": file.type,\n        },\n      });\n\n      // GCS returns 2xx status codes for successful uploads (200 or 204)\n      if (uploadResponse.status < 200 || uploadResponse.status >= 300) {\n        const errorText = await uploadResponse.text().catch(() => 'Unknown error');\n        console.error(\"GCS resume upload failed:\", uploadResponse.status, errorText);\n        throw new Error(\"Failed to upload resume to storage\");\n      }\n      \n      // DO NOT set form value here - wait until save succeeds\n      \n      // Automatically save the complete current form state with new resume URL\n      try {\n        const currentFormData = form.getValues();\n        \n        // Convert empty strings to undefined for optional fields (allows validation to pass)\n        const dataToValidate = {\n          headline: currentFormData.headline?.trim() || undefined,\n          bio: currentFormData.bio?.trim() || undefined,\n          location: currentFormData.location?.trim() || undefined,\n          phoneNumber: currentFormData.phoneNumber?.trim() || undefined,\n          linkedinUrl: currentFormData.linkedinUrl?.trim() || undefined,\n          portfolioUrl: currentFormData.portfolioUrl?.trim() || undefined,\n          skills: currentFormData.skills?.trim() || undefined,\n          profileImage: currentFormData.profileImage || undefined,\n          resumeUrl: objectPath || undefined,\n        };\n        \n        // Validate form data before auto-saving\n        const validationResult = await profileSchema.safeParseAsync(dataToValidate);\n        \n        if (!validationResult.success) {\n          // Reset form value to previous state since we can't auto-save\n          form.setValue(\"resumeUrl\", profile?.resumeUrl || \"\");\n          \n          // Show specific validation errors\n          const errors = validationResult.error.issues.map(i => i.message).join(\", \");\n          toast({ \n            title: \"Resume uploaded but not saved\", \n            description: `Please fix validation errors: ${errors}`,\n            variant: \"destructive\"\n          });\n          return;\n        }\n        \n        // Use validated data (includes transforms like phone number formatting)\n        const validatedData = validationResult.data;\n        const skillsArray = validatedData.skills?.trim() \n          ? validatedData.skills.split(\",\").map(s => s.trim()).filter(Boolean)\n          : [];\n        \n        // Build profile update with explicit file URLs\n        const profileUpdate: any = {\n          headline: validatedData.headline,\n          bio: validatedData.bio,\n          location: validatedData.location,\n          phoneNumber: validatedData.phoneNumber,\n          linkedinUrl: validatedData.linkedinUrl,\n          portfolioUrl: validatedData.portfolioUrl,\n          skills: skillsArray,\n          resumeUrl: objectPath, // NEW resume URL from upload\n        };\n        \n        // Preserve existing profile image\n        if (currentFormData.profileImage) {\n          profileUpdate.profileImage = currentFormData.profileImage;\n        }\n        \n        console.log(\"DEBUG: Sending resume update with:\", { resumeUrl: profileUpdate.resumeUrl });\n        await apiRequest(\"PUT\", \"/api/profile\", profileUpdate);\n        \n        // Only update form value AFTER successful save\n        form.setValue(\"resumeUrl\", objectPath);\n        \n        // Update the query cache to reflect the change (for dashboard/other views)\n        queryClient.setQueryData([\"/api/profile\"], (old: any) => ({\n          ...old,\n          resumeUrl: objectPath\n        }));\n        \n        toast({ title: \"Resume uploaded\", description: \"Resume uploaded and profile saved successfully\" });\n      } catch (saveError: any) {\n        // If save fails, reset form value to maintain UI consistency\n        form.setValue(\"resumeUrl\", profile?.resumeUrl || \"\");\n        throw new Error(\"Failed to save resume: \" + saveError.message);\n      }\n    } catch (error: any) {\n      toast({ title: \"Upload failed\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsUploadingResume(false);\n    }\n  };\n\n  const handleImageUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Client-side validation\n    const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB\n    const ALLOWED_TYPES = ['image/jpeg', 'image/png', 'image/webp', 'image/jpg'];\n\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      toast({ \n        title: \"Invalid file type\", \n        description: \"Only JPEG, PNG, and WebP images are allowed\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    if (file.size > MAX_FILE_SIZE) {\n      toast({ \n        title: \"File too large\", \n        description: \"Image must be under 5MB\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    try {\n      setIsUploadingImage(true);\n      \n      // Get user-scoped upload URL with validation\n      const response = await apiRequest(\"POST\", \"/api/objects/upload\", {\n        contentType: file.type,\n        fileSize: file.size\n      });\n      const data: any = await response.json();\n      const { uploadURL, objectPath } = data;\n      console.log(\"DEBUG: Image upload response:\", { uploadURL: uploadURL ? \"YES\" : \"NO\", objectPath });\n      \n      // Upload image to object storage\n      const uploadResponse = await fetch(uploadURL, {\n        method: \"PUT\",\n        body: file,\n        headers: {\n          \"Content-Type\": file.type,\n        },\n      });\n\n      // GCS returns 2xx status codes for successful uploads (200 or 204)\n      if (uploadResponse.status < 200 || uploadResponse.status >= 300) {\n        const errorText = await uploadResponse.text().catch(() => 'Unknown error');\n        console.error(\"GCS image upload failed:\", uploadResponse.status, errorText);\n        throw new Error(\"Failed to upload image to storage\");\n      }\n      \n      // DO NOT set form value here - wait until save succeeds\n      \n      // Automatically save the complete current form state with new profile image\n      try {\n        const currentFormData = form.getValues();\n        \n        // Convert empty strings to undefined for optional fields (allows validation to pass)\n        const dataToValidate = {\n          headline: currentFormData.headline?.trim() || undefined,\n          bio: currentFormData.bio?.trim() || undefined,\n          location: currentFormData.location?.trim() || undefined,\n          phoneNumber: currentFormData.phoneNumber?.trim() || undefined,\n          linkedinUrl: currentFormData.linkedinUrl?.trim() || undefined,\n          portfolioUrl: currentFormData.portfolioUrl?.trim() || undefined,\n          skills: currentFormData.skills?.trim() || undefined,\n          profileImage: objectPath,\n          resumeUrl: currentFormData.resumeUrl || undefined,\n        };\n        \n        // Validate form data before auto-saving\n        const validationResult = await profileSchema.safeParseAsync(dataToValidate);\n        \n        if (!validationResult.success) {\n          // Reset form value to previous state since we can't auto-save\n          form.setValue(\"profileImage\", profile?.profileImage || \"\");\n          \n          // Show specific validation errors\n          const errors = validationResult.error.issues.map(i => i.message).join(\", \");\n          toast({ \n            title: \"Image uploaded but not saved\", \n            description: `Please fix validation errors: ${errors}`,\n            variant: \"destructive\"\n          });\n          return;\n        }\n        \n        // Use validated data (includes transforms like phone number formatting)\n        const validatedData = validationResult.data;\n        const skillsArray = validatedData.skills?.trim()\n          ? validatedData.skills.split(\",\").map(s => s.trim()).filter(Boolean)\n          : [];\n        \n        // Build profile update with explicit file URLs\n        const profileUpdate: any = {\n          headline: validatedData.headline,\n          bio: validatedData.bio,\n          location: validatedData.location,\n          phoneNumber: validatedData.phoneNumber,\n          linkedinUrl: validatedData.linkedinUrl,\n          portfolioUrl: validatedData.portfolioUrl,\n          skills: skillsArray,\n          profileImage: objectPath, // NEW profile image from upload\n        };\n        \n        // Preserve existing resume\n        if (currentFormData.resumeUrl) {\n          profileUpdate.resumeUrl = currentFormData.resumeUrl;\n        }\n        \n        console.log(\"DEBUG: Sending image update with:\", { profileImage: profileUpdate.profileImage });\n        await apiRequest(\"PUT\", \"/api/profile\", profileUpdate);\n        \n        // Only update form value AFTER successful save\n        form.setValue(\"profileImage\", objectPath);\n        \n        // Update the query cache to reflect the change (for dashboard/other views)\n        queryClient.setQueryData([\"/api/profile\"], (old: any) => ({\n          ...old,\n          profileImage: objectPath\n        }));\n        \n        toast({ title: \"Image uploaded\", description: \"Profile image uploaded and profile saved successfully\" });\n      } catch (saveError: any) {\n        // If save fails, reset form value to maintain UI consistency\n        form.setValue(\"profileImage\", profile?.profileImage || \"\");\n        throw new Error(\"Failed to save profile image: \" + saveError.message);\n      }\n    } catch (error: any) {\n      toast({ title: \"Upload failed\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsUploadingImage(false);\n    }\n  };\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: ProfileForm) => {\n      // Convert empty strings to undefined for optional fields\n      const cleanedData = {\n        headline: data.headline?.trim() || undefined,\n        bio: data.bio?.trim() || undefined,\n        location: data.location?.trim() || undefined,\n        phoneNumber: data.phoneNumber?.trim() || undefined,\n        linkedinUrl: data.linkedinUrl?.trim() || undefined,\n        portfolioUrl: data.portfolioUrl?.trim() || undefined,\n        skills: data.skills?.trim() \n          ? data.skills.split(\",\").map(s => s.trim()).filter(Boolean)\n          : [],\n        profileImage: data.profileImage || undefined,\n        resumeUrl: data.resumeUrl || undefined,\n      };\n      return await apiRequest(\"PUT\", \"/api/profile\", cleanedData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Profile updated\", description: \"Your profile has been updated successfully.\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const addWorkExpMutation = useMutation({\n    mutationFn: async (data: WorkExpForm) => {\n      return await apiRequest(\"POST\", \"/api/profile/work-experience\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Work experience added\" });\n      setShowWorkExpForm(false);\n      workExpForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteWorkExpMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/profile/work-experience/${id}`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Work experience deleted\" });\n    },\n  });\n\n  const addEducationMutation = useMutation({\n    mutationFn: async (data: EducationForm) => {\n      return await apiRequest(\"POST\", \"/api/profile/education\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Education added\" });\n      setShowEducationForm(false);\n      educationForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteEducationMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/profile/education/${id}`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Education deleted\" });\n    },\n  });\n\n  const addCertificationMutation = useMutation({\n    mutationFn: async (data: CertificationForm) => {\n      return await apiRequest(\"POST\", \"/api/profile/certifications\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Certification added\" });\n      setShowCertForm(false);\n      certForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteCertificationMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/profile/certifications/${id}`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Certification deleted\" });\n    },\n  });\n\n  // Employer update mutation - always initialize to avoid hooks violation\n  const updateEmployerMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"PUT\", \"/api/profile\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/profile\"] });\n      toast({ title: \"Company profile updated\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  if (isLoading) {\n    return <div className=\"p-8\">Loading...</div>;\n  }\n\n  // Employer Profile Form\n  if (user?.role === \"employer\") {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-bold mb-2\">Company Profile</h1>\n          <p className=\"text-muted-foreground\">Manage your company information</p>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Building2 className=\"h-5 w-5\" />\n              Company Information\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <Form {...employerForm}>\n              <form onSubmit={employerForm.handleSubmit((data) => updateEmployerMutation.mutate(data))} className=\"space-y-4\">\n                <FormField\n                  control={employerForm.control}\n                  name=\"companyName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Company Name</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-company-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={employerForm.control}\n                  name=\"companyDescription\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Company Description</FormLabel>\n                      <FormControl>\n                        <Textarea {...field} rows={4} data-testid=\"input-company-desc\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={employerForm.control}\n                  name=\"industry\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Industry</FormLabel>\n                      <FormControl>\n                        <Input {...field} placeholder=\"e.g. Technology, Finance\" data-testid=\"input-industry\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"grid gap-4 md:grid-cols-2\">\n                  <FormField\n                    control={employerForm.control}\n                    name=\"companyWebsite\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Company Website</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Globe className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                            <Input {...field} placeholder=\"https://company.com\" className=\"pl-10\" data-testid=\"input-website\" />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={employerForm.control}\n                    name=\"location\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Location</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <MapPin className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                            <Input {...field} placeholder=\"City, Country\" className=\"pl-10\" data-testid=\"input-location\" />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <Button type=\"submit\" disabled={updateEmployerMutation.isPending} data-testid=\"button-save-profile\">\n                  {updateEmployerMutation.isPending ? \"Saving...\" : \"Save Company Profile\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (user?.role !== \"job_seeker\") {\n    return <div className=\"p-8\">Profile not available for this role.</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">My Profile</h1>\n        <p className=\"text-muted-foreground\">Manage your professional profile</p>\n      </div>\n\n      {/* Basic Information */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <User className=\"h-5 w-5\" />\n            Basic Information\n          </CardTitle>\n          <CardDescription>Your professional headline and contact details</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit((data) => updateProfileMutation.mutate(data))} className=\"space-y-4\">\n              {/* Profile Image Upload - EXPERIMENTAL */}\n              <FormField\n                control={form.control}\n                name=\"profileImage\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Profile Image</FormLabel>\n                    <div className=\"flex items-center gap-4\">\n                      <Avatar className=\"h-20 w-20\">\n                        {field.value && (\n                          <AvatarImage \n                            src={`/objects${field.value}`}\n                            alt=\"Profile\"\n                            data-testid=\"profile-image-preview\"\n                          />\n                        )}\n                        <AvatarFallback>\n                          <User className=\"h-10 w-10 text-muted-foreground\" />\n                        </AvatarFallback>\n                      </Avatar>\n                      <FormControl>\n                        <div>\n                          <Input\n                            type=\"file\"\n                            accept=\"image/*\"\n                            onChange={handleImageUpload}\n                            disabled={isUploadingImage}\n                            className=\"max-w-sm\"\n                            data-testid=\"input-profile-image\"\n                          />\n                          {isUploadingImage && (\n                            <p className=\"text-sm text-muted-foreground mt-2\">Uploading...</p>\n                          )}\n                        </div>\n                      </FormControl>\n                    </div>\n                    <FormDescription>Upload a professional photo</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              {/* Resume Upload */}\n              <FormField\n                control={form.control}\n                name=\"resumeUrl\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Resume</FormLabel>\n                    <div className=\"space-y-2\">\n                      {field.value && (\n                        <div className=\"flex items-center gap-2 p-3 bg-muted rounded-md\">\n                          <FileText className=\"h-4 w-4 text-primary\" />\n                          <span className=\"text-sm flex-1\">Resume uploaded</span>\n                          <a \n                            href={`/objects${field.value}`} \n                            target=\"_blank\" \n                            rel=\"noopener noreferrer\"\n                            className=\"text-sm text-primary hover:underline\"\n                            data-testid=\"link-resume-view\"\n                          >\n                            View\n                          </a>\n                        </div>\n                      )}\n                      <FormControl>\n                        <div>\n                          <Input\n                            type=\"file\"\n                            accept=\".pdf,.doc,.docx\"\n                            onChange={handleResumeUpload}\n                            disabled={isUploadingResume}\n                            className=\"max-w-sm\"\n                            data-testid=\"input-resume\"\n                          />\n                          {isUploadingResume && (\n                            <p className=\"text-sm text-muted-foreground mt-2\">Uploading resume...</p>\n                          )}\n                        </div>\n                      </FormControl>\n                    </div>\n                    <FormDescription>Upload your resume (PDF, DOC, or DOCX - max 10MB)</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"headline\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Professional Headline</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"e.g. Senior Software Engineer\" data-testid=\"input-headline\" />\n                    </FormControl>\n                    <FormDescription>A brief professional title</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"bio\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>About Me</FormLabel>\n                    <FormControl>\n                      <Textarea {...field} placeholder=\"Tell employers about yourself...\" rows={4} data-testid=\"input-bio\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <FormField\n                  control={form.control}\n                  name=\"location\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Location</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <MapPin className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input {...field} placeholder=\"City, Country\" className=\"pl-10\" data-testid=\"input-location\" />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"phoneNumber\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Phone Number (Philippines)</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <Phone className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input {...field} placeholder=\"+63 912-345-6789\" className=\"pl-10\" data-testid=\"input-phone\" />\n                        </div>\n                      </FormControl>\n                      <FormDescription>Enter a valid Philippine mobile number</FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"linkedinUrl\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>LinkedIn Profile</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <Linkedin className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input {...field} placeholder=\"https://linkedin.com/in/...\" className=\"pl-10\" data-testid=\"input-linkedin\" />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"portfolioUrl\"\n                  render={({ field}) => (\n                    <FormItem>\n                      <FormLabel>Portfolio/Website</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <Globe className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input {...field} placeholder=\"https://yourwebsite.com\" className=\"pl-10\" data-testid=\"input-portfolio\" />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"skills\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Skills</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"JavaScript, React, Node.js, Python\" data-testid=\"input-skills\" />\n                    </FormControl>\n                    <FormDescription>Separate skills with commas</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button type=\"submit\" disabled={updateProfileMutation.isPending} data-testid=\"button-save-profile\">\n                {updateProfileMutation.isPending ? \"Saving...\" : \"Save Profile\"}\n              </Button>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n\n      {/* Work Experience */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Briefcase className=\"h-5 w-5\" />\n                Work Experience\n              </CardTitle>\n              <CardDescription>Your employment history</CardDescription>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setShowWorkExpForm(!showWorkExpForm)}\n              data-testid=\"button-add-work-exp\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Add Experience\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {showWorkExpForm && (\n            <Card className=\"bg-muted/30\">\n              <CardContent className=\"pt-6\">\n                <Form {...workExpForm}>\n                  <form onSubmit={workExpForm.handleSubmit((data) => addWorkExpMutation.mutate(data))} className=\"space-y-4\">\n                    <div className=\"grid gap-4 md:grid-cols-2\">\n                      <FormField\n                        control={workExpForm.control}\n                        name=\"companyName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Company Name</FormLabel>\n                            <FormControl>\n                              <Input {...field} data-testid=\"input-company\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={workExpForm.control}\n                        name=\"position\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Position</FormLabel>\n                            <FormControl>\n                              <Input {...field} data-testid=\"input-position\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <FormField\n                      control={workExpForm.control}\n                      name=\"location\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Location</FormLabel>\n                          <FormControl>\n                            <Input {...field} data-testid=\"input-work-location\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"grid gap-4 md:grid-cols-2\">\n                      <FormField\n                        control={workExpForm.control}\n                        name=\"startDate\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Start Date</FormLabel>\n                            <FormControl>\n                              <PhilippineDatePicker\n                                value={field.value}\n                                onChange={field.onChange}\n                                mode=\"month-year\"\n                                placeholder=\"Select start date\"\n                                testId=\"input-start-date\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={workExpForm.control}\n                        name=\"endDate\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>End Date (Optional)</FormLabel>\n                            <FormControl>\n                              <PhilippineDatePicker\n                                value={field.value || \"\"}\n                                onChange={field.onChange}\n                                mode=\"month-year\"\n                                placeholder=\"Select end date or leave blank\"\n                                testId=\"input-end-date\"\n                              />\n                            </FormControl>\n                            <FormDescription>Leave blank if currently working here</FormDescription>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <FormField\n                      control={workExpForm.control}\n                      name=\"description\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Description</FormLabel>\n                          <FormControl>\n                            <Textarea {...field} rows={3} data-testid=\"input-work-description\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"flex gap-2\">\n                      <Button type=\"submit\" disabled={addWorkExpMutation.isPending} data-testid=\"button-save-work-exp\">\n                        {addWorkExpMutation.isPending ? \"Adding...\" : \"Add\"}\n                      </Button>\n                      <Button type=\"button\" variant=\"ghost\" onClick={() => setShowWorkExpForm(false)}>\n                        Cancel\n                      </Button>\n                    </div>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n          )}\n\n          {profile?.workExperience && profile.workExperience.length > 0 ? (\n            <div className=\"space-y-4\">\n              {profile.workExperience.map((exp: WorkExperience) => (\n                <Card key={exp.id} data-testid={`work-exp-${exp.id}`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <CardTitle className=\"text-lg\">{exp.position}</CardTitle>\n                        <CardDescription>{exp.companyName} • {exp.location}</CardDescription>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          {exp.startDate} - {exp.endDate || \"Present\"}\n                        </p>\n                      </div>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => deleteWorkExpMutation.mutate(exp.id)}\n                        disabled={deleteWorkExpMutation.isPending}\n                        data-testid={`button-delete-work-${exp.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    {exp.description && (\n                      <p className=\"text-sm mt-2\">{exp.description}</p>\n                    )}\n                  </CardHeader>\n                </Card>\n              ))}\n            </div>\n          ) : !showWorkExpForm && (\n            <p className=\"text-sm text-muted-foreground text-center py-8\">No work experience added yet</p>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Education */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"flex items-center gap-2\">\n                <GraduationCap className=\"h-5 w-5\" />\n                Education\n              </CardTitle>\n              <CardDescription>Your academic background</CardDescription>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setShowEducationForm(!showEducationForm)}\n              data-testid=\"button-add-education\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Add Education\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {showEducationForm && (\n            <Card className=\"bg-muted/30\">\n              <CardContent className=\"pt-6\">\n                <Form {...educationForm}>\n                  <form onSubmit={educationForm.handleSubmit((data) => addEducationMutation.mutate(data))} className=\"space-y-4\">\n                    <FormField\n                      control={educationForm.control}\n                      name=\"institution\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Institution</FormLabel>\n                          <FormControl>\n                            <Input {...field} data-testid=\"input-institution\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"grid gap-4 md:grid-cols-2\">\n                      <FormField\n                        control={educationForm.control}\n                        name=\"degree\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Degree</FormLabel>\n                            <FormControl>\n                              <Input {...field} placeholder=\"e.g. Bachelor's\" data-testid=\"input-degree\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={educationForm.control}\n                        name=\"fieldOfStudy\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Field of Study</FormLabel>\n                            <FormControl>\n                              <Input {...field} placeholder=\"e.g. Computer Science\" data-testid=\"input-field\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <div className=\"grid gap-4 md:grid-cols-2\">\n                      <FormField\n                        control={educationForm.control}\n                        name=\"startYear\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Start Year</FormLabel>\n                            <FormControl>\n                              <PhilippineDatePicker\n                                value={field.value}\n                                onChange={field.onChange}\n                                mode=\"year\"\n                                placeholder=\"Select start year\"\n                                testId=\"input-start-year\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={educationForm.control}\n                        name=\"endYear\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>End Year (Optional)</FormLabel>\n                            <FormControl>\n                              <PhilippineDatePicker\n                                value={field.value || \"\"}\n                                onChange={field.onChange}\n                                mode=\"year\"\n                                placeholder=\"Select end year or leave blank\"\n                                testId=\"input-end-year\"\n                              />\n                            </FormControl>\n                            <FormDescription>Leave blank if currently enrolled</FormDescription>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <FormField\n                      control={educationForm.control}\n                      name=\"description\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Description</FormLabel>\n                          <FormControl>\n                            <Textarea {...field} rows={2} data-testid=\"input-edu-description\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"flex gap-2\">\n                      <Button type=\"submit\" disabled={addEducationMutation.isPending} data-testid=\"button-save-education\">\n                        {addEducationMutation.isPending ? \"Adding...\" : \"Add\"}\n                      </Button>\n                      <Button type=\"button\" variant=\"ghost\" onClick={() => setShowEducationForm(false)}>\n                        Cancel\n                      </Button>\n                    </div>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n          )}\n\n          {profile?.education && profile.education.length > 0 ? (\n            <div className=\"space-y-4\">\n              {profile.education.map((edu: Education) => (\n                <Card key={edu.id} data-testid={`education-${edu.id}`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <CardTitle className=\"text-lg\">{edu.degree} in {edu.fieldOfStudy}</CardTitle>\n                        <CardDescription>{edu.institution}</CardDescription>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          {edu.startYear} - {edu.endYear || \"Present\"}\n                        </p>\n                      </div>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => deleteEducationMutation.mutate(edu.id)}\n                        disabled={deleteEducationMutation.isPending}\n                        data-testid={`button-delete-edu-${edu.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    {edu.description && (\n                      <p className=\"text-sm mt-2\">{edu.description}</p>\n                    )}\n                  </CardHeader>\n                </Card>\n              ))}\n            </div>\n          ) : !showEducationForm && (\n            <p className=\"text-sm text-muted-foreground text-center py-8\">No education added yet</p>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Certifications */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Award className=\"h-5 w-5\" />\n                Certifications\n              </CardTitle>\n              <CardDescription>Your professional certifications</CardDescription>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setShowCertForm(!showCertForm)}\n              data-testid=\"button-add-certification\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Add Certification\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {showCertForm && (\n            <Card className=\"bg-muted/30\">\n              <CardContent className=\"pt-6\">\n                <Form {...certForm}>\n                  <form onSubmit={certForm.handleSubmit((data) => addCertificationMutation.mutate(data))} className=\"space-y-4\">\n                    <div className=\"grid gap-4 md:grid-cols-2\">\n                      <FormField\n                        control={certForm.control}\n                        name=\"name\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Certificate Name</FormLabel>\n                            <FormControl>\n                              <Input {...field} data-testid=\"input-cert-name\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={certForm.control}\n                        name=\"issuer\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Issuing Organization</FormLabel>\n                            <FormControl>\n                              <Input {...field} data-testid=\"input-issuer\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <div className=\"grid gap-4 md:grid-cols-2\">\n                      <FormField\n                        control={certForm.control}\n                        name=\"issueDate\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Issue Date (Optional)</FormLabel>\n                            <FormControl>\n                              <PhilippineDatePicker\n                                value={field.value || \"\"}\n                                onChange={field.onChange}\n                                mode=\"month-year\"\n                                placeholder=\"Select issue date\"\n                                testId=\"input-issue-date\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={certForm.control}\n                        name=\"expiryDate\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Expiry Date (Optional)</FormLabel>\n                            <FormControl>\n                              <PhilippineDatePicker\n                                value={field.value || \"\"}\n                                onChange={field.onChange}\n                                mode=\"month-year\"\n                                placeholder=\"Select expiry date or leave blank\"\n                                testId=\"input-expiry-date\"\n                              />\n                            </FormControl>\n                            <FormDescription>Leave blank if no expiration</FormDescription>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <FormField\n                      control={certForm.control}\n                      name=\"credentialUrl\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Credential URL</FormLabel>\n                          <FormControl>\n                            <Input {...field} placeholder=\"https://...\" data-testid=\"input-credential-url\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"flex gap-2\">\n                      <Button type=\"submit\" disabled={addCertificationMutation.isPending} data-testid=\"button-save-cert\">\n                        {addCertificationMutation.isPending ? \"Adding...\" : \"Add\"}\n                      </Button>\n                      <Button type=\"button\" variant=\"ghost\" onClick={() => setShowCertForm(false)}>\n                        Cancel\n                      </Button>\n                    </div>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n          )}\n\n          {profile?.certifications && profile.certifications.length > 0 ? (\n            <div className=\"space-y-4\">\n              {profile.certifications.map((cert: Certification) => (\n                <Card key={cert.id} data-testid={`cert-${cert.id}`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <CardTitle className=\"text-lg\">{cert.name}</CardTitle>\n                        <CardDescription>{cert.issuer}</CardDescription>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          Issued: {cert.issueDate || \"N/A\"}\n                          {cert.expiryDate && ` • Expires: ${cert.expiryDate}`}\n                        </p>\n                        {cert.credentialUrl && (\n                          <a \n                            href={cert.credentialUrl} \n                            target=\"_blank\" \n                            rel=\"noopener noreferrer\" \n                            className=\"text-sm text-primary hover:underline mt-1 inline-block\"\n                          >\n                            View Credential →\n                          </a>\n                        )}\n                      </div>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => deleteCertificationMutation.mutate(cert.id)}\n                        disabled={deleteCertificationMutation.isPending}\n                        data-testid={`button-delete-cert-${cert.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </CardHeader>\n                </Card>\n              ))}\n            </div>\n          ) : !showCertForm && (\n            <p className=\"text-sm text-muted-foreground text-center py-8\">No certifications added yet</p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":58771,"size_tokens":null},"server/logger.ts":{"content":"import { storage } from \"./storage\";\nimport type { InsertActivityLog } from \"@shared/schema\";\n\nexport const ActivityLogger = {\n  async log(data: InsertActivityLog): Promise<void> {\n    try {\n      await storage.createActivityLog(data);\n    } catch (error) {\n      console.error(\"Failed to log activity:\", error);\n    }\n  },\n\n  async logUserCreated(userId: string, email: string, role: string): Promise<void> {\n    await this.log({\n      userId,\n      entityType: \"user\",\n      entityId: userId,\n      action: \"created\",\n      description: `New ${role} account created: ${email}`,\n      metadata: { email, role },\n    });\n  },\n\n  async logUserUpdated(userId: string, actorId: string, changes: string): Promise<void> {\n    await this.log({\n      userId: actorId,\n      entityType: \"user\",\n      entityId: userId,\n      action: \"updated\",\n      description: `User account updated: ${changes}`,\n      metadata: { changes },\n    });\n  },\n\n  async logUserFlagged(userId: string, actorId: string, flagged: boolean): Promise<void> {\n    await this.log({\n      userId: actorId,\n      entityType: \"user\",\n      entityId: userId,\n      action: flagged ? \"flagged\" : \"unflagged\",\n      description: `User ${flagged ? \"flagged\" : \"unflagged\"} by admin`,\n      metadata: { flagged },\n    });\n  },\n\n  async logJobCreated(jobId: string, employerId: string, title: string): Promise<void> {\n    await this.log({\n      userId: employerId,\n      entityType: \"job\",\n      entityId: jobId,\n      action: \"created\",\n      description: `New job posted: ${title}`,\n      metadata: { title },\n    });\n  },\n\n  async logJobUpdated(jobId: string, employerId: string, title: string): Promise<void> {\n    await this.log({\n      userId: employerId,\n      entityType: \"job\",\n      entityId: jobId,\n      action: \"updated\",\n      description: `Job updated: ${title}`,\n      metadata: { title },\n    });\n  },\n\n  async logJobDeleted(jobId: string, employerId: string, title: string): Promise<void> {\n    await this.log({\n      userId: employerId,\n      entityType: \"job\",\n      entityId: jobId,\n      action: \"deleted\",\n      description: `Job deleted: ${title}`,\n      metadata: { title },\n    });\n  },\n\n  async logApplicationSubmitted(applicationId: string, seekerId: string, jobTitle: string): Promise<void> {\n    await this.log({\n      userId: seekerId,\n      entityType: \"application\",\n      entityId: applicationId,\n      action: \"created\",\n      description: `Application submitted for: ${jobTitle}`,\n      metadata: { jobTitle },\n    });\n  },\n\n  async logApplicationStatusChanged(applicationId: string, actorId: string, oldStatus: string, newStatus: string): Promise<void> {\n    await this.log({\n      userId: actorId,\n      entityType: \"application\",\n      entityId: applicationId,\n      action: \"updated\",\n      description: `Application status changed from ${oldStatus} to ${newStatus}`,\n      metadata: { oldStatus, newStatus },\n    });\n  },\n\n  async logProfileUpdated(profileId: string, userId: string, profileType: \"job_seeker\" | \"employer\"): Promise<void> {\n    await this.log({\n      userId,\n      entityType: \"profile\",\n      entityId: profileId,\n      action: \"updated\",\n      description: `${profileType === \"job_seeker\" ? \"Job seeker\" : \"Employer\"} profile updated`,\n      metadata: { profileType },\n    });\n  },\n\n  async logFraudAlertCreated(alertId: string, entityType: string, entityId: string): Promise<void> {\n    await this.log({\n      userId: null,\n      entityType: \"fraud_alert\",\n      entityId: alertId,\n      action: \"created\",\n      description: `AI fraud alert generated for ${entityType}: ${entityId}`,\n      metadata: { alertEntityType: entityType, alertEntityId: entityId },\n    });\n  },\n\n  async logFraudAlertReviewed(alertId: string, reviewerId: string, status: string): Promise<void> {\n    await this.log({\n      userId: reviewerId,\n      entityType: \"fraud_alert\",\n      entityId: alertId,\n      action: \"updated\",\n      description: `Fraud alert reviewed: ${status}`,\n      metadata: { status },\n    });\n  },\n\n  async logSystemEvent(description: string, metadata?: any): Promise<void> {\n    await this.log({\n      userId: null,\n      entityType: \"system\",\n      entityId: null,\n      action: \"system\",\n      description,\n      metadata,\n    });\n  },\n};\n","path":null,"size_bytes":4258,"size_tokens":null},"server/routes/admin.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { insertContactMessageSchema, insertUserSchema } from \"@shared/schema\";\nimport { ActivityLogger } from \"../logger\";\nimport { z } from \"zod\";\nimport bcrypt from \"bcrypt\";\n\nexport function createAdminRouter() {\n  const router = Router();\n\n  // Activity Logs\n  router.get(\"/activity\", async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 50;\n      const logs = await storage.getRecentActivityLogs(Math.min(limit, 200)); // Max 200\n      res.json(logs);\n    } catch (error: any) {\n      console.error(\"Get activity logs error:\", error);\n      res.status(500).json({ message: \"Failed to fetch activity logs\" });\n    }\n  });\n\n  // Contact Messages - List all with optional status filter\n  router.get(\"/contacts\", async (req, res) => {\n    try {\n      const status = req.query.status as string;\n      \n      let messages;\n      if (status && ['new', 'read', 'replied', 'archived'].includes(status)) {\n        messages = await storage.getContactMessagesByStatus(status);\n      } else {\n        messages = await storage.getAllContactMessages();\n      }\n      \n      res.json(messages);\n    } catch (error: any) {\n      console.error(\"Get contact messages error:\", error);\n      res.status(500).json({ message: \"Failed to fetch contact messages\" });\n    }\n  });\n\n  // Contact Messages - Update message (reply, change status, etc.)\n  router.put(\"/contacts/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const updateSchema = z.object({\n        status: z.enum(['new', 'read', 'replied', 'archived']).optional(),\n        priority: z.enum(['low', 'normal', 'high', 'urgent']).optional(),\n        replyMessage: z.string().optional(),\n      });\n\n      const validatedData = updateSchema.parse(req.body);\n      \n      // Validate that 'replied' status requires a reply message\n      if (validatedData.status === 'replied' && !validatedData.replyMessage) {\n        return res.status(400).json({ message: \"Reply message is required when setting status to 'replied'\" });\n      }\n      \n      // Add handledAt timestamp and repliedBy when reply is provided\n      const updateData: any = { ...validatedData };\n      if (validatedData.status === 'replied' && validatedData.replyMessage) {\n        updateData.handledAt = new Date();\n        // Use the logged-in admin user's ID\n        updateData.repliedBy = (req as any).session?.userId;\n      }\n      \n      const updated = await storage.updateContactMessage(id, updateData);\n      \n      res.json(updated);\n    } catch (error: any) {\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Update contact message error:\", error);\n      res.status(500).json({ message: \"Failed to update contact message\" });\n    }\n  });\n\n  // Flag/Unflag Job\n  router.put(\"/jobs/:id/flag\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { flagged } = req.body;\n      \n      const job = await storage.getJob(id);\n      if (!job) {\n        return res.status(404).json({ message: \"Job not found\" });\n      }\n\n      const updated = await storage.updateJob(id, { isFlagged: flagged });\n      \n      // Log the action\n      const adminEmail = (req as any).session?.userEmail || 'admin';\n      await ActivityLogger.log({\n        action: flagged ? 'flag' : 'unflag',\n        description: `Job \"${job.title}\" ${flagged ? 'flagged' : 'unflagged'} by ${adminEmail}`,\n        entityType: 'job',\n        entityId: id,\n      });\n      \n      res.json(updated);\n    } catch (error: any) {\n      console.error(\"Flag job error:\", error);\n      res.status(500).json({ message: \"Failed to update job\" });\n    }\n  });\n\n  // Global Search - Search across users, jobs, applications\n  router.get(\"/search\", async (req, res) => {\n    try {\n      const query = req.query.q as string;\n      const type = (req.query.type as string) || 'all';\n      \n      if (!query || query.trim().length < 2) {\n        return res.status(400).json({ message: \"Search query must be at least 2 characters\" });\n      }\n\n      const results: any = {\n        users: [],\n        jobs: [],\n      };\n\n      // Search users (if type is 'user' or 'all')\n      if (type === 'user' || type === 'all') {\n        const allUsers = await storage.getAllUsers();\n        results.users = allUsers.filter(user => \n          user.email?.toLowerCase().includes(query.toLowerCase()) ||\n          user.firstName?.toLowerCase().includes(query.toLowerCase()) ||\n          user.lastName?.toLowerCase().includes(query.toLowerCase())\n        ).slice(0, 20); // Limit to 20 results\n      }\n\n      // Search jobs (if type is 'job' or 'all')\n      if (type === 'job' || type === 'all') {\n        const allJobs = await storage.getAllJobs();\n        results.jobs = allJobs.filter(job => \n          job.title?.toLowerCase().includes(query.toLowerCase()) ||\n          job.description?.toLowerCase().includes(query.toLowerCase()) ||\n          job.location?.toLowerCase().includes(query.toLowerCase())\n        ).slice(0, 20); // Limit to 20 results\n      }\n\n      res.json({\n        query,\n        type,\n        results,\n        totalResults: results.users.length + results.jobs.length,\n      });\n    } catch (error: any) {\n      console.error(\"Global search error:\", error);\n      res.status(500).json({ message: \"Search failed\" });\n    }\n  });\n\n  // Delete User\n  router.delete(\"/users/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      \n      const user = await storage.getUser(id);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Prevent deleting yourself\n      const currentUserId = (req as any).session?.userId;\n      if (currentUserId === id) {\n        return res.status(400).json({ message: \"Cannot delete your own account\" });\n      }\n\n      await storage.deleteUser(id);\n      \n      // Log the action\n      const adminEmail = (req as any).session?.userEmail || 'admin';\n      await ActivityLogger.log({\n        action: 'delete',\n        description: `User ${user.email} deleted by ${adminEmail}`,\n        entityType: 'user',\n        entityId: id,\n      });\n      \n      res.json({ message: \"User deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Delete user error:\", error);\n      res.status(500).json({ message: error.message || \"Failed to delete user\" });\n    }\n  });\n\n  // Create Admin Account\n  router.post(\"/users/admin\", async (req, res) => {\n    try {\n      const createAdminSchema = z.object({\n        email: z.string().email(),\n        password: z.string().min(8),\n        firstName: z.string().min(1),\n        lastName: z.string().min(1),\n      });\n\n      const validatedData = createAdminSchema.parse(req.body);\n      \n      // Check if user already exists\n      const existingUser = await storage.getUserByEmail(validatedData.email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"User with this email already exists\" });\n      }\n\n      // Hash password\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n      \n      // Create admin user with all necessary fields\n      const newAdmin = await storage.createUser({\n        email: validatedData.email,\n        password: hashedPassword,\n        firstName: validatedData.firstName,\n        lastName: validatedData.lastName,\n        role: 'admin',\n      });\n      \n      // Update to mark email as verified (admin accounts don't need verification)\n      await storage.updateUser(newAdmin.id, { isEmailVerified: true });\n      \n      // Log the action\n      const adminEmail = (req as any).session?.userEmail || 'admin';\n      await ActivityLogger.log({\n        action: 'create',\n        description: `Admin account created for ${validatedData.email} by ${adminEmail}`,\n        entityType: 'user',\n        entityId: newAdmin.id,\n      });\n      \n      // Return user without password\n      const { password, ...safeUser } = newAdmin;\n      res.status(201).json(safeUser);\n    } catch (error: any) {\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Create admin error:\", error);\n      res.status(500).json({ message: \"Failed to create admin account\" });\n    }\n  });\n\n  return router;\n}\n","path":null,"size_bytes":8425,"size_tokens":null},"client/src/pages/post-job.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { useState } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Briefcase, MapPin, Users, Clock, ArrowLeft, Upload, FileText, X } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nconst jobSchema = z.object({\n  title: z.string().min(3, \"Job title must be at least 3 characters\"),\n  description: z.string().min(50, \"Description must be at least 50 characters\"),\n  location: z.string().min(1, \"Location is required\"),\n  jobType: z.enum([\"full_time\", \"part_time\", \"contract\", \"remote\", \"hybrid\"]),\n  salaryMin: z.string().optional(),\n  salaryMax: z.string().optional(),\n  category: z.string().optional(),\n  requirements: z.string().optional(),\n  responsibilities: z.string().optional(),\n  benefits: z.string().optional(),\n  skills: z.string().optional(),\n});\n\ntype JobForm = z.infer<typeof jobSchema>;\n\nexport default function PostJob() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [isUploadingDocument, setIsUploadingDocument] = useState(false);\n  const [requirementDocumentUrl, setRequirementDocumentUrl] = useState<string | null>(null);\n\n  const form = useForm<JobForm>({\n    resolver: zodResolver(jobSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      location: \"\",\n      jobType: \"full_time\",\n      salaryMin: undefined,\n      salaryMax: undefined,\n      category: \"\",\n      requirements: \"\",\n      responsibilities: \"\",\n      benefits: \"\",\n      skills: \"\",\n    },\n  });\n\n  const handleDocumentUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Client-side validation\n    const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB\n    const ALLOWED_TYPES = [\n      'application/pdf',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n    ];\n\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      toast({ \n        title: \"Invalid file type\", \n        description: \"Only PDF, DOC, and DOCX files are allowed\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    if (file.size > MAX_FILE_SIZE) {\n      toast({ \n        title: \"File too large\", \n        description: \"Document must be under 10MB\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    try {\n      setIsUploadingDocument(true);\n      \n      // Get upload URL from backend\n      const response: any = await apiRequest(\"POST\", \"/api/objects/upload-document\", {\n        contentType: file.type,\n        fileSize: file.size,\n      });\n\n      const { uploadURL, objectPath } = response;\n\n      // Upload file directly to cloud storage\n      const uploadResponse = await fetch(uploadURL, {\n        method: \"PUT\",\n        body: file,\n        headers: { \"Content-Type\": file.type },\n      });\n\n      // GCS returns 2xx status codes for successful uploads (200 or 204)\n      if (uploadResponse.status < 200 || uploadResponse.status >= 300) {\n        const errorText = await uploadResponse.text().catch(() => 'Unknown error');\n        console.error(\"GCS document upload failed:\", uploadResponse.status, errorText);\n        throw new Error(\"Failed to upload document to storage\");\n      }\n\n      // Store the object path for later use\n      setRequirementDocumentUrl(objectPath);\n      toast({ title: \"Document uploaded successfully!\" });\n    } catch (error: any) {\n      console.error(\"Document upload error:\", error);\n      toast({ \n        title: \"Upload failed\", \n        description: error.message || \"Failed to upload document\", \n        variant: \"destructive\" \n      });\n    } finally {\n      setIsUploadingDocument(false);\n    }\n  };\n\n  const createJobMutation = useMutation({\n    mutationFn: async (data: JobForm) => {\n      const payload = {\n        ...data,\n        // Convert salary strings to numbers or undefined\n        salaryMin: data.salaryMin && data.salaryMin !== \"\" ? Number(data.salaryMin) : undefined,\n        salaryMax: data.salaryMax && data.salaryMax !== \"\" ? Number(data.salaryMax) : undefined,\n        requirements: data.requirements ? data.requirements.split(\"\\n\").filter(Boolean) : [],\n        responsibilities: data.responsibilities ? data.responsibilities.split(\"\\n\").filter(Boolean) : [],\n        benefits: data.benefits ? data.benefits.split(\"\\n\").filter(Boolean) : [],\n        skills: data.skills ? data.skills.split(\",\").map(s => s.trim()).filter(Boolean) : [],\n        requirementDocumentUrl: requirementDocumentUrl || undefined,\n      };\n      return await apiRequest(\"POST\", \"/api/jobs\", payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/employer/jobs\"] });\n      toast({ title: \"Job posted successfully!\" });\n      setLocation(\"/employer/dashboard\");\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error posting job\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-4\">\n        <Link href=\"/employer/dashboard\">\n          <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-back\">\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\n            Back to Dashboard\n          </Button>\n        </Link>\n      </div>\n\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Post a New Job</h1>\n        <p className=\"text-muted-foreground\">Fill out the details below to create a job posting</p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Briefcase className=\"h-5 w-5\" />\n            Job Details\n          </CardTitle>\n          <CardDescription>Basic information about the position</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit((data) => createJobMutation.mutate(data))} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Job Title</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"e.g. Senior Software Engineer\" data-testid=\"input-title\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Job Description</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        {...field} \n                        placeholder=\"Describe the role, company culture, and what makes this opportunity unique...\" \n                        rows={6}\n                        data-testid=\"input-description\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <FormField\n                  control={form.control}\n                  name=\"location\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Location</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <MapPin className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                          <Input {...field} placeholder=\"City, Country or Remote\" className=\"pl-10\" data-testid=\"input-location\" />\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <FormControl>\n                        <Input {...field} placeholder=\"e.g. Technology, Marketing\" data-testid=\"input-category\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"jobType\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Job Type</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-job-type\">\n                          <SelectValue placeholder=\"Select job type\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"full_time\">Full-time</SelectItem>\n                        <SelectItem value=\"part_time\">Part-time</SelectItem>\n                        <SelectItem value=\"contract\">Contract</SelectItem>\n                        <SelectItem value=\"remote\">Remote</SelectItem>\n                        <SelectItem value=\"hybrid\">Hybrid</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <FormField\n                  control={form.control}\n                  name=\"salaryMin\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Minimum Salary (PHP, optional)</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground font-semibold\">₱</span>\n                          <Input \n                            {...field} \n                            type=\"number\" \n                            placeholder=\"25000\"\n                            className=\"pl-10\"\n                            value={field.value === \"\" ? \"\" : field.value || \"\"}\n                            data-testid=\"input-salary-min\"\n                          />\n                        </div>\n                      </FormControl>\n                      <FormDescription>Monthly salary in Philippine Peso</FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"salaryMax\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Maximum Salary (PHP, optional)</FormLabel>\n                      <FormControl>\n                        <div className=\"relative\">\n                          <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground font-semibold\">₱</span>\n                          <Input \n                            {...field} \n                            type=\"number\" \n                            placeholder=\"50000\"\n                            className=\"pl-10\"\n                            value={field.value === \"\" ? \"\" : field.value || \"\"}\n                            data-testid=\"input-salary-max\"\n                          />\n                        </div>\n                      </FormControl>\n                      <FormDescription>Monthly salary in Philippine Peso</FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"skills\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Required Skills</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"JavaScript, React, Node.js, Python\" data-testid=\"input-skills\" />\n                    </FormControl>\n                    <FormDescription>Separate skills with commas</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"requirements\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Requirements</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        {...field} \n                        placeholder=\"List the job requirements (one per line)&#10;e.g.&#10;5+ years of experience&#10;Bachelor's degree in Computer Science\"\n                        rows={5}\n                        data-testid=\"input-requirements\"\n                      />\n                    </FormControl>\n                    <FormDescription>One requirement per line</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"responsibilities\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Responsibilities</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        {...field} \n                        placeholder=\"List the key responsibilities (one per line)\"\n                        rows={5}\n                        data-testid=\"input-responsibilities\"\n                      />\n                    </FormControl>\n                    <FormDescription>One responsibility per line</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"benefits\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Benefits</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        {...field} \n                        placeholder=\"List the benefits (one per line)&#10;e.g.&#10;Health insurance&#10;Remote work options\"\n                        rows={4}\n                        data-testid=\"input-benefits\"\n                      />\n                    </FormControl>\n                    <FormDescription>One benefit per line</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">\n                  Requirement Document (Optional)\n                </label>\n                <p className=\"text-sm text-muted-foreground\">\n                  Upload additional requirements document (PDF, DOC, DOCX - Max 10MB)\n                </p>\n                {requirementDocumentUrl ? (\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-md\">\n                    <FileText className=\"h-5 w-5 text-primary\" />\n                    <span className=\"text-sm flex-1\">Document uploaded</span>\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setRequirementDocumentUrl(null)}\n                      data-testid=\"button-remove-document\"\n                    >\n                      <X className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"relative\">\n                    <Input\n                      type=\"file\"\n                      accept=\".pdf,.doc,.docx\"\n                      onChange={handleDocumentUpload}\n                      disabled={isUploadingDocument}\n                      className=\"cursor-pointer\"\n                      data-testid=\"input-requirement-document\"\n                    />\n                    {isUploadingDocument && (\n                      <div className=\"absolute inset-0 flex items-center justify-center bg-background/50\">\n                        <span className=\"text-sm\">Uploading...</span>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex gap-4\">\n                <Button \n                  type=\"submit\" \n                  disabled={createJobMutation.isPending}\n                  data-testid=\"button-submit\"\n                >\n                  {createJobMutation.isPending ? \"Posting...\" : \"Post Job\"}\n                </Button>\n                <Link href=\"/employer/dashboard\">\n                  <Button type=\"button\" variant=\"outline\">\n                    Cancel\n                  </Button>\n                </Link>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":18002,"size_tokens":null},"client/src/pages/admin-contacts.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { useState, memo } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Briefcase, Mail, AlertCircle, CheckCircle, Archive } from \"lucide-react\";\nimport type { ContactMessage } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { formatDistance } from \"date-fns\";\n\ninterface MessageCardProps {\n  message: ContactMessage;\n  replyingTo: string | null;\n  replyMessages: Record<string, string>;\n  onSetReplyingTo: (id: string | null) => void;\n  onSetReplyMessages: (updater: (prev: Record<string, string>) => Record<string, string>) => void;\n  onUpdateMessage: (params: { id: string; status: string; replyMessage?: string; repliedBy?: string }) => void;\n  isPending: boolean;\n}\n\nconst MessageCard = memo(({ \n  message, \n  replyingTo, \n  replyMessages, \n  onSetReplyingTo, \n  onSetReplyMessages, \n  onUpdateMessage,\n  isPending \n}: MessageCardProps) => (\n  <Card key={message.id} className=\"hover-elevate\" data-testid={`card-message-${message.id}`}>\n    <CardHeader>\n      <div className=\"flex items-start justify-between gap-4\">\n        <div className=\"flex-1\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <CardTitle className=\"text-lg\">{message.name}</CardTitle>\n            <Badge variant={\n              message.priority === 'urgent' ? 'destructive' :\n              message.priority === 'high' ? 'default' : 'secondary'\n            }>\n              {message.priority}\n            </Badge>\n            <Badge variant=\"outline\">{message.status}</Badge>\n          </div>\n          <CardDescription>\n            {message.email} • {formatDistance(new Date(message.createdAt), new Date(), { addSuffix: true })}\n          </CardDescription>\n        </div>\n      </div>\n      {message.subject && (\n        <p className=\"font-medium text-sm mt-2\">Subject: {message.subject}</p>\n      )}\n    </CardHeader>\n    <CardContent>\n      <p className=\"text-sm text-muted-foreground mb-4\">{message.message}</p>\n      \n      {message.replyMessage && (\n        <div className=\"bg-muted p-3 rounded-md mb-4\">\n          <p className=\"text-xs font-medium mb-1\">Admin Reply:</p>\n          <p className=\"text-sm\">{message.replyMessage}</p>\n        </div>\n      )}\n\n      {replyingTo === message.id ? (\n        <div className=\"space-y-3\">\n          <Textarea\n            placeholder=\"Type your reply...\"\n            value={replyMessages[message.id] || \"\"}\n            onChange={(e) => onSetReplyMessages(prev => ({ ...prev, [message.id]: e.target.value }))}\n            rows={4}\n            data-testid={`textarea-reply-${message.id}`}\n          />\n          <div className=\"flex gap-2\">\n            <Button\n              size=\"sm\"\n              onClick={() => onUpdateMessage({\n                id: message.id,\n                status: 'replied',\n                replyMessage: replyMessages[message.id] || \"\"\n              })}\n              disabled={!(replyMessages[message.id] || \"\").trim() || isPending}\n              data-testid={`button-send-reply-${message.id}`}\n            >\n              Send Reply\n            </Button>\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => {\n                onSetReplyingTo(null);\n                onSetReplyMessages(prev => {\n                  const newMessages = { ...prev };\n                  delete newMessages[message.id];\n                  return newMessages;\n                });\n              }}\n              data-testid={`button-cancel-reply-${message.id}`}\n            >\n              Cancel\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <div className=\"flex gap-2\">\n          {message.status !== 'replied' && (\n            <Button\n              size=\"sm\"\n              onClick={() => {\n                onSetReplyingTo(message.id);\n                if (!replyMessages[message.id]) {\n                  onSetReplyMessages(prev => ({ ...prev, [message.id]: \"\" }));\n                }\n              }}\n              data-testid={`button-reply-${message.id}`}\n            >\n              <Mail className=\"h-4 w-4 mr-2\" />\n              Reply\n            </Button>\n          )}\n          {message.status !== 'read' && message.status !== 'replied' && (\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => onUpdateMessage({ id: message.id, status: 'read' })}\n              data-testid={`button-mark-read-${message.id}`}\n            >\n              <CheckCircle className=\"h-4 w-4 mr-2\" />\n              Mark Read\n            </Button>\n          )}\n          {message.status !== 'archived' && (\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => onUpdateMessage({ id: message.id, status: 'archived' })}\n              data-testid={`button-archive-${message.id}`}\n            >\n              <Archive className=\"h-4 w-4 mr-2\" />\n              Archive\n            </Button>\n          )}\n        </div>\n      )}\n    </CardContent>\n  </Card>\n));\n\nMessageCard.displayName = 'MessageCard';\n\nexport default function AdminContacts() {\n  const { toast } = useToast();\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const [replyMessages, setReplyMessages] = useState<Record<string, string>>({});\n\n  const { data: messages, isLoading, isError } = useQuery<ContactMessage[]>({\n    queryKey: [\"/api/admin/contacts\"],\n  });\n\n  const updateMessageMutation = useMutation({\n    mutationFn: async ({ id, status, replyMessage, repliedBy }: any) => {\n      return await apiRequest(\"PUT\", `/api/admin/contacts/${id}`, { \n        status, \n        replyMessage, \n        repliedBy \n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/contacts\"] });\n      setReplyingTo(null);\n      setReplyMessages({});\n      toast({ title: \"Message updated\", description: \"Contact message updated successfully\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const newMessages = messages?.filter(m => m.status === 'new' || m.status === 'read') || [];\n  const repliedMessages = messages?.filter(m => m.status === 'replied') || [];\n  const archivedMessages = messages?.filter(m => m.status === 'archived') || [];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Contact Messages</h1>\n        <p className=\"text-muted-foreground\">Manage user inquiries and support requests</p>\n      </div>\n      {/* Fix applied: Per-message reply state */}\n\n        <Tabs defaultValue=\"new\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"new\" data-testid=\"tab-new\">\n              New ({newMessages.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"replied\" data-testid=\"tab-replied\">\n              Replied ({repliedMessages.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"archived\" data-testid=\"tab-archived\">\n              Archived ({archivedMessages.length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"new\" className=\"space-y-4 mt-6\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"py-8 text-center text-muted-foreground\">\n                  Loading messages...\n                </CardContent>\n              </Card>\n            ) : isError ? (\n              <Card>\n                <CardContent className=\"py-8 text-center text-destructive\">\n                  Failed to load messages\n                </CardContent>\n              </Card>\n            ) : newMessages.length > 0 ? (\n              newMessages.map(message => (\n                <MessageCard \n                  key={message.id} \n                  message={message}\n                  replyingTo={replyingTo}\n                  replyMessages={replyMessages}\n                  onSetReplyingTo={setReplyingTo}\n                  onSetReplyMessages={setReplyMessages}\n                  onUpdateMessage={updateMessageMutation.mutate}\n                  isPending={updateMessageMutation.isPending}\n                />\n              ))\n            ) : (\n              <Card>\n                <CardContent className=\"py-8 text-center text-muted-foreground\">\n                  No new messages\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"replied\" className=\"space-y-4 mt-6\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"py-8 text-center text-muted-foreground\">\n                  Loading messages...\n                </CardContent>\n              </Card>\n            ) : repliedMessages.length > 0 ? (\n              repliedMessages.map(message => (\n                <MessageCard \n                  key={message.id} \n                  message={message}\n                  replyingTo={replyingTo}\n                  replyMessages={replyMessages}\n                  onSetReplyingTo={setReplyingTo}\n                  onSetReplyMessages={setReplyMessages}\n                  onUpdateMessage={updateMessageMutation.mutate}\n                  isPending={updateMessageMutation.isPending}\n                />\n              ))\n            ) : (\n              <Card>\n                <CardContent className=\"py-8 text-center text-muted-foreground\">\n                  No replied messages\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"archived\" className=\"space-y-4 mt-6\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"py-8 text-center text-muted-foreground\">\n                  Loading messages...\n                </CardContent>\n              </Card>\n            ) : archivedMessages.length > 0 ? (\n              archivedMessages.map(message => (\n                <MessageCard \n                  key={message.id} \n                  message={message}\n                  replyingTo={replyingTo}\n                  replyMessages={replyMessages}\n                  onSetReplyingTo={setReplyingTo}\n                  onSetReplyMessages={setReplyMessages}\n                  onUpdateMessage={updateMessageMutation.mutate}\n                  isPending={updateMessageMutation.isPending}\n                />\n              ))\n            ) : (\n              <Card>\n                <CardContent className=\"py-8 text-center text-muted-foreground\">\n                  No archived messages\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n        </Tabs>\n    </div>\n  );\n}\n","path":null,"size_bytes":11112,"size_tokens":null},"client/src/pages/admin-admins.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Search, Shield, Mail, CheckCircle } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\nexport default function AdminManagement() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: users, isLoading, isError } = useQuery<any[]>({\n    queryKey: [\"/api/admin/users\"],\n  });\n\n  const adminUsers = users?.filter(u => u.role === 'admin') || [];\n  \n  const filteredAdmins = adminUsers.filter(u =>\n    u.email.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    u.firstName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    u.lastName?.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Admin Management</h1>\n        <p className=\"text-muted-foreground\">Manage platform administrators</p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Search Admins</CardTitle>\n          <CardDescription>Find administrators by name or email</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search admins...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search-admins\"\n            />\n          </div>\n        </CardContent>\n      </Card>\n\n      {isLoading ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-muted-foreground\">\n            Loading administrators...\n          </CardContent>\n        </Card>\n      ) : isError ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-destructive\">\n            Failed to load administrators\n          </CardContent>\n        </Card>\n      ) : (\n        <Card>\n          <CardHeader>\n            <CardTitle>Platform Administrators ({filteredAdmins.length})</CardTitle>\n            <CardDescription>Users with admin privileges</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {filteredAdmins.map((admin) => (\n                <div\n                  key={admin.id}\n                  className=\"flex items-center justify-between p-4 rounded-md border hover-elevate\"\n                  data-testid={`admin-row-${admin.id}`}\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <Shield className=\"h-4 w-4 text-destructive\" />\n                      <p className=\"font-medium\">{admin.firstName} {admin.lastName}</p>\n                      <Badge variant=\"destructive\" className=\"text-xs\">\n                        Admin\n                      </Badge>\n                      {admin.isEmailVerified && (\n                        <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                      )}\n                    </div>\n                    <div className=\"flex items-center gap-2 mt-1\">\n                      <Mail className=\"h-3 w-3 text-muted-foreground\" />\n                      <p className=\"text-sm text-muted-foreground\">{admin.email}</p>\n                    </div>\n                  </div>\n                </div>\n              ))}\n              {filteredAdmins.length === 0 && (\n                <p className=\"text-center py-8 text-muted-foreground\">No administrators found</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Admin Privileges</CardTitle>\n          <CardDescription>Capabilities of admin users</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <ul className=\"space-y-2 text-sm\">\n            <li className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n              <span>View and manage all users</span>\n            </li>\n            <li className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n              <span>Monitor and flag job postings</span>\n            </li>\n            <li className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n              <span>Review fraud alerts</span>\n            </li>\n            <li className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n              <span>Access platform analytics</span>\n            </li>\n            <li className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n              <span>Manage contact messages</span>\n            </li>\n          </ul>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":5290,"size_tokens":null},"client/src/pages/job-management.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRoute, Link, useLocation } from \"wouter\";\nimport { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, Users, Mail, Phone, FileText, Sparkles, MapPin, Briefcase, Download, User, Eye, Edit, Trash2, ToggleLeft, ToggleRight } from \"lucide-react\";\nimport type { Job, Application } from \"@shared/schema\";\n\nconst jobEditSchema = z.object({\n  title: z.string().min(3, \"Job title must be at least 3 characters\"),\n  description: z.string().min(50, \"Description must be at least 50 characters\"),\n  location: z.string().min(1, \"Location is required\"),\n  jobType: z.enum([\"full_time\", \"part_time\", \"contract\", \"remote\", \"hybrid\"]),\n  salaryMin: z.string().optional(),\n  salaryMax: z.string().optional(),\n  category: z.string().optional(),\n  requirements: z.string().optional(),\n  responsibilities: z.string().optional(),\n  skills: z.string().optional(),\n});\n\ntype JobEditForm = z.infer<typeof jobEditSchema>;\n\nexport default function JobManagement() {\n  const [, params] = useRoute(\"/employer/jobs/:id\");\n  const jobId = params?.id;\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const [editDialogOpen, setEditDialogOpen] = useState(false);\n\n  const { data: job, isLoading: jobLoading } = useQuery<Job>({\n    queryKey: [\"/api/jobs\", jobId],\n    enabled: !!jobId,\n  });\n\n  const { data: applications, isLoading: applicationsLoading } = useQuery<Application[]>({\n    queryKey: [\"/api/employer/jobs\", jobId, \"applications\"],\n    enabled: !!jobId,\n  });\n\n  const form = useForm<JobEditForm>({\n    resolver: zodResolver(jobEditSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      location: \"\",\n      jobType: \"full_time\",\n      salaryMin: \"\",\n      salaryMax: \"\",\n      category: \"\",\n      requirements: \"\",\n      responsibilities: \"\",\n      skills: \"\",\n    },\n  });\n\n  // Update form when job data loads\n  useEffect(() => {\n    if (job) {\n      form.reset({\n        title: job.title,\n        description: job.description,\n        location: job.location,\n        jobType: job.jobType,\n        salaryMin: job.salaryMin?.toString() || \"\",\n        salaryMax: job.salaryMax?.toString() || \"\",\n        category: job.category || \"\",\n        requirements: job.requirements?.join(\"\\n\") || \"\",\n        responsibilities: job.responsibilities?.join(\"\\n\") || \"\",\n        skills: job.skills?.join(\", \") || \"\",\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [job]);\n\n  const updateJobMutation = useMutation({\n    mutationFn: async (data: JobEditForm) => {\n      const payload = {\n        ...data,\n        salaryMin: data.salaryMin && data.salaryMin !== \"\" ? Number(data.salaryMin) : undefined,\n        salaryMax: data.salaryMax && data.salaryMax !== \"\" ? Number(data.salaryMax) : undefined,\n        requirements: data.requirements ? data.requirements.split(\"\\n\").filter(Boolean) : [],\n        responsibilities: data.responsibilities ? data.responsibilities.split(\"\\n\").filter(Boolean) : [],\n        skills: data.skills ? data.skills.split(\",\").map(s => s.trim()).filter(Boolean) : [],\n      };\n      return await apiRequest(\"PUT\", `/api/jobs/${jobId}`, payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/jobs\", jobId] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/employer/jobs\"] });\n      toast({ title: \"Job updated successfully!\" });\n      setEditDialogOpen(false);\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error updating job\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const toggleActiveMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"PUT\", `/api/jobs/${jobId}`, { isActive: !job?.isActive });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/jobs\", jobId] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/employer/jobs\"] });\n      toast({ title: job?.isActive ? \"Job deactivated\" : \"Job activated\" });\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error toggling job status\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const deleteJobMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"DELETE\", `/api/jobs/${jobId}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/employer/jobs\"] });\n      toast({ title: \"Job deleted successfully\" });\n      navigate(\"/employer/dashboard\");\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error deleting job\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const updateApplicationStatusMutation = useMutation({\n    mutationFn: async ({ applicationId, status }: { applicationId: string; status: string }) => {\n      return await apiRequest(\"PUT\", `/api/applications/${applicationId}`, { status });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/employer/jobs\", jobId, \"applications\"] });\n      toast({ title: \"Application status updated successfully!\" });\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error updating application status\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  if (jobLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-10 w-full\" />\n        <Skeleton className=\"h-64 w-full\" />\n      </div>\n    );\n  }\n\n  if (!job) {\n    return (\n      <div className=\"p-8 text-center\">\n        <p className=\"text-muted-foreground\">Job not found</p>\n        <Link href=\"/employer/dashboard\">\n          <Button className=\"mt-4\">Back to Dashboard</Button>\n        </Link>\n      </div>\n    );\n  }\n\n  const pendingApps = applications?.filter(a => a.status === \"applied\") || [];\n  const reviewingApps = applications?.filter(a => a.status === \"reviewing\") || [];\n  const acceptedApps = applications?.filter(a => a.status === \"accepted\") || [];\n  const rejectedApps = applications?.filter(a => a.status === \"rejected\") || [];\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-4\">\n        <Link href=\"/employer/dashboard\">\n          <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-back\">\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\n            Back to Dashboard\n          </Button>\n        </Link>\n      </div>\n\n      {/* Job Details */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-start justify-between\">\n            <div>\n              <CardTitle className=\"text-2xl\">{job.title}</CardTitle>\n              <CardDescription className=\"flex items-center gap-2 mt-2\">\n                <MapPin className=\"h-4 w-4\" />\n                {job.location} • {job.jobType}\n              </CardDescription>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge variant={job.isActive ? \"default\" : \"secondary\"} data-testid=\"badge-job-status\">\n                {job.isActive ? \"Active\" : \"Inactive\"}\n              </Badge>\n              \n              {/* Action Buttons */}\n              <Dialog open={editDialogOpen} onOpenChange={setEditDialogOpen}>\n                <DialogTrigger asChild>\n                  <Button variant=\"outline\" size=\"sm\" data-testid=\"button-edit-job\">\n                    <Edit className=\"h-4 w-4 mr-2\" />\n                    Edit\n                  </Button>\n                </DialogTrigger>\n                <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n                  <DialogHeader>\n                    <DialogTitle>Edit Job Posting</DialogTitle>\n                    <DialogDescription>Update the job details below</DialogDescription>\n                  </DialogHeader>\n                  <EditJobForm \n                    form={form} \n                    onSubmit={(data) => updateJobMutation.mutate(data)} \n                    isPending={updateJobMutation.isPending}\n                  />\n                </DialogContent>\n              </Dialog>\n\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={() => toggleActiveMutation.mutate()}\n                disabled={toggleActiveMutation.isPending}\n                data-testid=\"button-toggle-active\"\n              >\n                {job.isActive ? <ToggleRight className=\"h-4 w-4 mr-2\" /> : <ToggleLeft className=\"h-4 w-4 mr-2\" />}\n                {job.isActive ? \"Deactivate\" : \"Activate\"}\n              </Button>\n\n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button variant=\"destructive\" size=\"sm\" data-testid=\"button-delete-job\">\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    Delete\n                  </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                  <AlertDialogHeader>\n                    <AlertDialogTitle>Delete Job Posting</AlertDialogTitle>\n                    <AlertDialogDescription>\n                      Are you sure you want to delete this job posting? This action cannot be undone.\n                      All applications for this job will also be affected.\n                    </AlertDialogDescription>\n                  </AlertDialogHeader>\n                  <AlertDialogFooter>\n                    <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n                    <AlertDialogAction\n                      onClick={() => deleteJobMutation.mutate()}\n                      className=\"bg-destructive hover:bg-destructive/90\"\n                      data-testid=\"button-confirm-delete\"\n                    >\n                      {deleteJobMutation.isPending ? \"Deleting...\" : \"Delete\"}\n                    </AlertDialogAction>\n                  </AlertDialogFooter>\n                </AlertDialogContent>\n              </AlertDialog>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <h3 className=\"font-semibold mb-2\">Description</h3>\n            <p className=\"text-sm text-muted-foreground\">{job.description}</p>\n          </div>\n\n          {job.skills && job.skills.length > 0 && (\n            <div>\n              <h3 className=\"font-semibold mb-2\">Required Skills</h3>\n              <div className=\"flex flex-wrap gap-2\">\n                {job.skills.map((skill, idx) => (\n                  <Badge key={idx} variant=\"outline\">{skill}</Badge>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Users className=\"h-4 w-4 text-muted-foreground\" />\n              <span>{applications?.length || 0} Applications</span>\n            </div>\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Briefcase className=\"h-4 w-4 text-muted-foreground\" />\n              <span>{job.jobType}</span>\n            </div>\n            {job.salaryMin && job.salaryMax && (\n              <div className=\"flex items-center gap-2 text-sm\">\n                <span className=\"font-medium\">\n                  ${job.salaryMin.toLocaleString()} - ${job.salaryMax.toLocaleString()}\n                </span>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Applications */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Users className=\"h-5 w-5\" />\n            Applications\n          </CardTitle>\n          <CardDescription>Review and manage candidate applications</CardDescription>\n        </CardHeader>\n        <CardContent>\n          {applicationsLoading ? (\n            <div className=\"space-y-4\">\n              <Skeleton className=\"h-24 w-full\" />\n              <Skeleton className=\"h-24 w-full\" />\n            </div>\n          ) : applications && applications.length > 0 ? (\n            <Tabs defaultValue=\"pending\" className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"pending\" data-testid=\"tab-pending\">\n                  Pending ({pendingApps.length})\n                </TabsTrigger>\n                <TabsTrigger value=\"reviewing\" data-testid=\"tab-reviewing\">\n                  Reviewing ({reviewingApps.length})\n                </TabsTrigger>\n                <TabsTrigger value=\"accepted\" data-testid=\"tab-accepted\">\n                  Accepted ({acceptedApps.length})\n                </TabsTrigger>\n                <TabsTrigger value=\"rejected\" data-testid=\"tab-rejected\">\n                  Rejected ({rejectedApps.length})\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"pending\" className=\"space-y-4 mt-6\">\n                {pendingApps.length > 0 ? (\n                  pendingApps.map((app) => (\n                    <ApplicationCard \n                      key={app.id} \n                      application={app} \n                      onUpdateStatus={(status) => updateApplicationStatusMutation.mutate({ applicationId: app.id, status })}\n                      isPending={updateApplicationStatusMutation.isPending}\n                    />\n                  ))\n                ) : (\n                  <p className=\"text-sm text-muted-foreground text-center py-8\">No pending applications</p>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"reviewing\" className=\"space-y-4 mt-6\">\n                {reviewingApps.length > 0 ? (\n                  reviewingApps.map((app) => (\n                    <ApplicationCard \n                      key={app.id} \n                      application={app} \n                      onUpdateStatus={(status) => updateApplicationStatusMutation.mutate({ applicationId: app.id, status })}\n                      isPending={updateApplicationStatusMutation.isPending}\n                    />\n                  ))\n                ) : (\n                  <p className=\"text-sm text-muted-foreground text-center py-8\">No applications under review</p>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"accepted\" className=\"space-y-4 mt-6\">\n                {acceptedApps.length > 0 ? (\n                  acceptedApps.map((app) => (\n                    <ApplicationCard \n                      key={app.id} \n                      application={app} \n                      onUpdateStatus={(status) => updateApplicationStatusMutation.mutate({ applicationId: app.id, status })}\n                      isPending={updateApplicationStatusMutation.isPending}\n                    />\n                  ))\n                ) : (\n                  <p className=\"text-sm text-muted-foreground text-center py-8\">No accepted applications</p>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"rejected\" className=\"space-y-4 mt-6\">\n                {rejectedApps.length > 0 ? (\n                  rejectedApps.map((app) => (\n                    <ApplicationCard \n                      key={app.id} \n                      application={app} \n                      onUpdateStatus={(status) => updateApplicationStatusMutation.mutate({ applicationId: app.id, status })}\n                      isPending={updateApplicationStatusMutation.isPending}\n                    />\n                  ))\n                ) : (\n                  <p className=\"text-sm text-muted-foreground text-center py-8\">No rejected applications</p>\n                )}\n              </TabsContent>\n            </Tabs>\n          ) : (\n            <div className=\"flex min-h-[300px] flex-col items-center justify-center text-center p-8\">\n              <Users className=\"h-12 w-12 text-muted-foreground/50 mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No applications yet</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Applications will appear here once candidates apply\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nfunction ApplicationCard({ \n  application, \n  onUpdateStatus,\n  isPending \n}: { \n  application: any;\n  onUpdateStatus: (status: string) => void;\n  isPending: boolean;\n}) {\n  const applicant = application.applicant || {};\n  const fullName = applicant.firstName && applicant.lastName \n    ? `${applicant.firstName} ${applicant.lastName}`\n    : \"Anonymous Applicant\";\n\n  return (\n    <Card data-testid={`application-${application.id}`}>\n      <CardHeader>\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <Avatar className=\"h-12 w-12\">\n              {applicant.profileImage && (\n                <AvatarImage \n                  src={`/objects${applicant.profileImage}`}\n                  alt={fullName}\n                />\n              )}\n              <AvatarFallback>\n                <User className=\"h-6 w-6\" />\n              </AvatarFallback>\n            </Avatar>\n            <div>\n              <CardTitle className=\"text-lg\">{fullName}</CardTitle>\n              <CardDescription className=\"flex flex-col gap-1 mt-1\">\n                <span>{applicant.headline || \"Job Seeker\"}</span>\n                <span className=\"flex items-center gap-2 flex-wrap\">\n                  {applicant.location && (\n                    <span className=\"flex items-center gap-1\">\n                      <MapPin className=\"h-3 w-3\" />\n                      {applicant.location}\n                    </span>\n                  )}\n                  {application.aiMatchScore && (\n                    <>\n                      <span>•</span>\n                      <span className=\"flex items-center gap-1\">\n                        <Sparkles className=\"h-3 w-3 text-primary\" />\n                        {application.aiMatchScore}% match\n                      </span>\n                    </>\n                  )}\n                </span>\n              </CardDescription>\n            </div>\n          </div>\n          <Badge\n            variant={\n              application.status === \"accepted\" ? \"default\" :\n              application.status === \"rejected\" ? \"destructive\" :\n              application.status === \"reviewing\" ? \"secondary\" :\n              \"outline\"\n            }\n            data-testid={`badge-status-${application.id}`}\n          >\n            {application.status}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Contact Information */}\n        <div className=\"grid gap-3 md:grid-cols-2\">\n          {applicant.email && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Mail className=\"h-4 w-4 text-muted-foreground\" />\n              <a href={`mailto:${applicant.email}`} className=\"text-primary hover:underline\">\n                {applicant.email}\n              </a>\n            </div>\n          )}\n          {applicant.phoneNumber && (\n            <div className=\"flex items-center gap-2 text-sm\">\n              <Phone className=\"h-4 w-4 text-muted-foreground\" />\n              <span>{applicant.phoneNumber}</span>\n            </div>\n          )}\n        </div>\n\n        {/* Skills */}\n        {applicant.skills && applicant.skills.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-semibold mb-2\">Skills</h4>\n            <div className=\"flex flex-wrap gap-2\">\n              {applicant.skills.slice(0, 6).map((skill: string, idx: number) => (\n                <Badge key={idx} variant=\"outline\">{skill}</Badge>\n              ))}\n              {applicant.skills.length > 6 && (\n                <Badge variant=\"outline\">+{applicant.skills.length - 6} more</Badge>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Work Experience */}\n        {applicant.workExperience && applicant.workExperience.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-semibold mb-2\">Work Experience</h4>\n            <div className=\"space-y-2\">\n              {applicant.workExperience.slice(0, 3).map((exp: any, idx: number) => (\n                <div key={idx} className=\"text-sm\">\n                  <p className=\"font-medium\">{exp.jobTitle}</p>\n                  <p className=\"text-muted-foreground\">{exp.company}</p>\n                </div>\n              ))}\n              {applicant.workExperience.length > 3 && (\n                <p className=\"text-xs text-muted-foreground\">\n                  +{applicant.workExperience.length - 3} more position{applicant.workExperience.length - 3 > 1 ? 's' : ''}\n                </p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Education */}\n        {applicant.education && applicant.education.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-semibold mb-2\">Education</h4>\n            <div className=\"space-y-2\">\n              {applicant.education.slice(0, 2).map((edu: any, idx: number) => (\n                <div key={idx} className=\"text-sm\">\n                  <p className=\"font-medium\">{edu.degree}</p>\n                  <p className=\"text-muted-foreground\">{edu.institution}</p>\n                </div>\n              ))}\n              {applicant.education.length > 2 && (\n                <p className=\"text-xs text-muted-foreground\">\n                  +{applicant.education.length - 2} more degree{applicant.education.length - 2 > 1 ? 's' : ''}\n                </p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Resume Download */}\n        {applicant.resumeUrl && (\n          <div>\n            <a \n              href={`/objects${applicant.resumeUrl}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              data-testid={`link-resume-${application.id}`}\n            >\n              <Button variant=\"outline\" size=\"sm\" className=\"w-full sm:w-auto\">\n                <Download className=\"h-4 w-4 mr-2\" />\n                Download Resume\n              </Button>\n            </a>\n          </div>\n        )}\n\n        {/* Cover Letter */}\n        {application.coverLetter && (\n          <div className=\"space-y-2\">\n            <h4 className=\"text-sm font-semibold flex items-center gap-2\">\n              <FileText className=\"h-4 w-4\" />\n              Cover Letter\n            </h4>\n            <p className=\"text-sm text-muted-foreground\">{application.coverLetter}</p>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-wrap gap-2 pt-2\">\n          <Link href={`/employer/applicant/${applicant.id}`}>\n            <Button size=\"sm\" variant=\"secondary\" data-testid={`button-view-portfolio-${application.id}`}>\n              <Eye className=\"h-4 w-4 mr-2\" />\n              View Portfolio\n            </Button>\n          </Link>\n          <Button \n            size=\"sm\" \n            onClick={() => onUpdateStatus(\"accepted\")}\n            disabled={isPending || application.status === \"accepted\"}\n            data-testid={`button-accept-${application.id}`}\n          >\n            Accept\n          </Button>\n          <Button \n            size=\"sm\" \n            variant=\"outline\"\n            onClick={() => onUpdateStatus(\"reviewing\")}\n            disabled={isPending || application.status === \"reviewing\"}\n            data-testid={`button-review-${application.id}`}\n          >\n            Review\n          </Button>\n          <Button \n            size=\"sm\" \n            variant=\"destructive\"\n            onClick={() => onUpdateStatus(\"rejected\")}\n            disabled={isPending || application.status === \"rejected\"}\n            data-testid={`button-reject-${application.id}`}\n          >\n            Reject\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction EditJobForm({ form, onSubmit, isPending }: { form: any; onSubmit: (data: JobEditForm) => void; isPending: boolean }) {\n  return (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n        <FormField\n          control={form.control}\n          name=\"title\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Job Title</FormLabel>\n              <FormControl>\n                <Input {...field} placeholder=\"e.g. Senior Software Engineer\" data-testid=\"input-edit-title\" />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name=\"description\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Job Description</FormLabel>\n              <FormControl>\n                <Textarea \n                  {...field} \n                  placeholder=\"Describe the role, company culture, and what makes this opportunity unique...\" \n                  rows={5}\n                  data-testid=\"input-edit-description\"\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <div className=\"grid gap-4 md:grid-cols-2\">\n          <FormField\n            control={form.control}\n            name=\"location\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Location</FormLabel>\n                <FormControl>\n                  <Input {...field} placeholder=\"City, Country or Remote\" data-testid=\"input-edit-location\" />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          <FormField\n            control={form.control}\n            name=\"jobType\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Job Type</FormLabel>\n                <Select onValueChange={field.onChange} value={field.value}>\n                  <FormControl>\n                    <SelectTrigger data-testid=\"select-edit-jobtype\">\n                      <SelectValue placeholder=\"Select job type\" />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    <SelectItem value=\"full_time\">Full Time</SelectItem>\n                    <SelectItem value=\"part_time\">Part Time</SelectItem>\n                    <SelectItem value=\"contract\">Contract</SelectItem>\n                    <SelectItem value=\"remote\">Remote</SelectItem>\n                    <SelectItem value=\"hybrid\">Hybrid</SelectItem>\n                  </SelectContent>\n                </Select>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        </div>\n\n        <div className=\"grid gap-4 md:grid-cols-2\">\n          <FormField\n            control={form.control}\n            name=\"salaryMin\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Minimum Salary (PHP)</FormLabel>\n                <FormControl>\n                  <Input {...field} type=\"number\" placeholder=\"e.g. 30000\" data-testid=\"input-edit-salary-min\" />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          <FormField\n            control={form.control}\n            name=\"salaryMax\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Maximum Salary (PHP)</FormLabel>\n                <FormControl>\n                  <Input {...field} type=\"number\" placeholder=\"e.g. 50000\" data-testid=\"input-edit-salary-max\" />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        </div>\n\n        <FormField\n          control={form.control}\n          name=\"category\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Category (Optional)</FormLabel>\n              <FormControl>\n                <Input {...field} placeholder=\"e.g. Technology, Marketing\" data-testid=\"input-edit-category\" />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name=\"skills\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Required Skills (Optional)</FormLabel>\n              <FormControl>\n                <Input {...field} placeholder=\"e.g. JavaScript, React, Node.js\" data-testid=\"input-edit-skills\" />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name=\"requirements\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Requirements (Optional, one per line)</FormLabel>\n              <FormControl>\n                <Textarea \n                  {...field} \n                  placeholder=\"3+ years experience&#10;Bachelor's degree&#10;Strong communication skills\"\n                  rows={4}\n                  data-testid=\"input-edit-requirements\"\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name=\"responsibilities\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Responsibilities (Optional, one per line)</FormLabel>\n              <FormControl>\n                <Textarea \n                  {...field} \n                  placeholder=\"Develop new features&#10;Code reviews&#10;Mentor junior developers\"\n                  rows={4}\n                  data-testid=\"input-edit-responsibilities\"\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <div className=\"flex justify-end gap-2 pt-4\">\n          <Button type=\"button\" variant=\"outline\" onClick={() => form.reset()} data-testid=\"button-reset-form\">\n            Reset\n          </Button>\n          <Button type=\"submit\" disabled={isPending} data-testid=\"button-submit-edit\">\n            {isPending ? \"Updating...\" : \"Update Job\"}\n          </Button>\n        </div>\n      </form>\n    </Form>\n  );\n}\n","path":null,"size_bytes":31551,"size_tokens":null},"client/src/pages/admin-analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { BarChart3, Download, Users, Briefcase, FileText, AlertTriangle } from \"lucide-react\";\nimport {\n  LineChart,\n  Line,\n  BarChart,\n  Bar,\n  PieChart,\n  Pie,\n  Cell,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer\n} from \"recharts\";\n\nexport default function AdminAnalytics() {\n  const { data: analytics, isLoading } = useQuery<any>({\n    queryKey: [\"/api/analytics/admin\"],\n  });\n\n  const exportToCSV = () => {\n    if (!analytics) return;\n\n    const csvData: string[] = [];\n    \n    // Overview section\n    csvData.push(\"Admin Analytics Report\");\n    csvData.push(\"\");\n    csvData.push(\"Overview\");\n    csvData.push(\"Metric,Value\");\n    csvData.push(`Total Users,${analytics.overview.totalUsers}`);\n    csvData.push(`Total Jobs,${analytics.overview.totalJobs}`);\n    csvData.push(`Total Applications,${analytics.overview.totalApplications}`);\n    csvData.push(`Total Fraud Alerts,${analytics.overview.totalFraudAlerts}`);\n    csvData.push(`Active Jobs,${analytics.overview.activeJobs}`);\n    csvData.push(`Flagged Users,${analytics.overview.flaggedUsers}`);\n    csvData.push(`Verified Users,${analytics.overview.verifiedUsers}`);\n    csvData.push(\"\");\n\n    // Users by role\n    csvData.push(\"Users by Role\");\n    csvData.push(\"Role,Count\");\n    csvData.push(`Job Seekers,${analytics.breakdown.usersByRole.job_seeker}`);\n    csvData.push(`Employers,${analytics.breakdown.usersByRole.employer}`);\n    csvData.push(`Admins,${analytics.breakdown.usersByRole.admin}`);\n    csvData.push(\"\");\n\n    // Application status\n    csvData.push(\"Applications by Status\");\n    csvData.push(\"Status,Count\");\n    Object.entries(analytics.breakdown.applicationsByStatus).forEach(([status, count]) => {\n      csvData.push(`${status},${count}`);\n    });\n    csvData.push(\"\");\n\n    // User trend\n    csvData.push(\"User Registrations (Last 30 Days)\");\n    csvData.push(\"Date,Count\");\n    analytics.trends.users.forEach((item: any) => {\n      csvData.push(`${item.date},${item.count}`);\n    });\n    csvData.push(\"\");\n\n    // Download\n    const blob = new Blob([csvData.join('\\n')], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `admin-analytics-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <BarChart3 className=\"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-pulse\" />\n          <p className=\"text-muted-foreground\">Loading analytics...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!analytics) {\n    return (\n      <div className=\"min-h-screen bg-background p-8\">\n        <p className=\"text-center text-muted-foreground\">No analytics data available</p>\n      </div>\n    );\n  }\n\n  const COLORS = ['hsl(var(--chart-1))', 'hsl(var(--chart-2))', 'hsl(var(--chart-3))', 'hsl(var(--chart-4))', 'hsl(var(--chart-5))'];\n\n  // Prepare data for pie charts\n  const userRoleData = [\n    { name: 'Job Seekers', value: analytics.breakdown.usersByRole.job_seeker },\n    { name: 'Employers', value: analytics.breakdown.usersByRole.employer },\n    { name: 'Admins', value: analytics.breakdown.usersByRole.admin }\n  ];\n\n  const applicationStatusData = Object.entries(analytics.breakdown.applicationsByStatus).map(([name, value]) => ({\n    name: name.charAt(0).toUpperCase() + name.slice(1),\n    value: value as number\n  }));\n\n  const fraudAlertStatusData = Object.entries(analytics.breakdown.fraudAlertsByStatus).map(([name, value]) => ({\n    name: name.charAt(0).toUpperCase() + name.slice(1),\n    value: value as number\n  }));\n\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 lg:p-8\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold mb-2\">Analytics Dashboard</h1>\n            <p className=\"text-muted-foreground\">Platform-wide metrics and insights</p>\n          </div>\n          <Button onClick={exportToCSV} data-testid=\"button-export-csv\">\n            <Download className=\"mr-2 h-4 w-4\" />\n            Export to CSV\n          </Button>\n        </div>\n\n        {/* Overview Stats */}\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8\">\n          <Card data-testid=\"card-stat-users\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Users</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalUsers}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Users className=\"h-3 w-3\" />\n                <span>{analytics.overview.verifiedUsers} verified</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-jobs\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Jobs</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalJobs}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Briefcase className=\"h-3 w-3\" />\n                <span>{analytics.overview.activeJobs} active</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-applications\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Applications</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalApplications}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <FileText className=\"h-3 w-3\" />\n                <span>All time</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-fraud\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Fraud Alerts</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalFraudAlerts}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <AlertTriangle className=\"h-3 w-3\" />\n                <span>{analytics.overview.flaggedUsers} flagged users</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Time-series Trends */}\n        <div className=\"grid gap-6 lg:grid-cols-2 mb-8\">\n          <Card data-testid=\"card-user-trend\">\n            <CardHeader>\n              <CardTitle>User Registrations</CardTitle>\n              <CardDescription>Last 30 days</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={analytics.trends.users}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis dataKey=\"date\" className=\"text-xs\" tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} />\n                  <YAxis className=\"text-xs\" />\n                  <Tooltip labelFormatter={(value) => new Date(value).toLocaleDateString()} />\n                  <Line type=\"monotone\" dataKey=\"count\" stroke=\"hsl(var(--primary))\" strokeWidth={2} name=\"Users\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-job-trend\">\n            <CardHeader>\n              <CardTitle>Job Postings</CardTitle>\n              <CardDescription>Last 30 days</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={analytics.trends.jobs}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis dataKey=\"date\" className=\"text-xs\" tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} />\n                  <YAxis className=\"text-xs\" />\n                  <Tooltip labelFormatter={(value) => new Date(value).toLocaleDateString()} />\n                  <Line type=\"monotone\" dataKey=\"count\" stroke=\"hsl(var(--chart-2))\" strokeWidth={2} name=\"Jobs\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-application-trend\" className=\"lg:col-span-2\">\n            <CardHeader>\n              <CardTitle>Applications Submitted</CardTitle>\n              <CardDescription>Last 30 days</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={analytics.trends.applications}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis dataKey=\"date\" className=\"text-xs\" tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} />\n                  <YAxis className=\"text-xs\" />\n                  <Tooltip labelFormatter={(value) => new Date(value).toLocaleDateString()} />\n                  <Line type=\"monotone\" dataKey=\"count\" stroke=\"hsl(var(--chart-3))\" strokeWidth={2} name=\"Applications\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Breakdown Charts */}\n        <div className=\"grid gap-6 lg:grid-cols-3 mb-8\">\n          <Card data-testid=\"card-users-by-role\">\n            <CardHeader>\n              <CardTitle>Users by Role</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <PieChart>\n                  <Pie data={userRoleData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={80} fill=\"#8884d8\" dataKey=\"value\">\n                    {userRoleData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-applications-by-status\">\n            <CardHeader>\n              <CardTitle>Application Status</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <PieChart>\n                  <Pie data={applicationStatusData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={80} fill=\"#8884d8\" dataKey=\"value\">\n                    {applicationStatusData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-fraud-alerts-by-status\">\n            <CardHeader>\n              <CardTitle>Fraud Alert Status</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <PieChart>\n                  <Pie data={fraudAlertStatusData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent}) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={80} fill=\"#8884d8\" dataKey=\"value\">\n                    {fraudAlertStatusData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Top Categories */}\n        <Card data-testid=\"card-top-categories\">\n          <CardHeader>\n            <CardTitle>Top Job Categories</CardTitle>\n            <CardDescription>Most popular job categories on the platform</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={400}>\n              <BarChart data={analytics.breakdown.topCategories}>\n                <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                <XAxis dataKey=\"category\" className=\"text-xs\" />\n                <YAxis className=\"text-xs\" />\n                <Tooltip />\n                <Legend />\n                <Bar dataKey=\"count\" fill=\"hsl(var(--primary))\" name=\"Jobs\" />\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":13547,"size_tokens":null},"client/src/pages/admin-fraud.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { AlertTriangle, CheckCircle, XCircle, User, Briefcase, Eye, MapPin, Banknote, Calendar, Mail, Shield } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { format } from \"date-fns\";\n\nexport default function AdminFraud() {\n  const { toast } = useToast();\n  const [reviewingAlert, setReviewingAlert] = useState<string | null>(null);\n  const [reviewNotes, setReviewNotes] = useState(\"\");\n  const [viewingDetails, setViewingDetails] = useState<any>(null);\n  const [detailsData, setDetailsData] = useState<any>(null);\n  const [loadingDetails, setLoadingDetails] = useState(false);\n\n  const { data: alerts, isLoading, isError } = useQuery<any[]>({\n    queryKey: [\"/api/admin/fraud-alerts\"],\n  });\n\n  const handleViewDetails = async (alert: any) => {\n    setViewingDetails(alert);\n    setLoadingDetails(true);\n    setDetailsData(null);\n    \n    try {\n      const response = await fetch(`/api/admin/fraud-alerts/${alert.id}/details`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch details');\n      }\n      const data = await response.json();\n      setDetailsData(data.details);\n    } catch (error) {\n      toast({ title: \"Error\", description: \"Failed to load details\", variant: \"destructive\" });\n    } finally {\n      setLoadingDetails(false);\n    }\n  };\n\n  const reviewAlertMutation = useMutation({\n    mutationFn: async ({ id, status, notes }: { id: string; status: string; notes?: string }) => {\n      return await apiRequest(\"PUT\", `/api/admin/fraud-alerts/${id}`, { status, reviewNotes: notes });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/fraud-alerts\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n      setReviewingAlert(null);\n      setReviewNotes(\"\");\n      toast({ title: \"Success\", description: \"Alert reviewed successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to review alert\", variant: \"destructive\" });\n    },\n  });\n\n  const pendingAlerts = alerts?.filter(a => a.status === 'pending') || [];\n  const confirmedAlerts = alerts?.filter(a => a.status === 'confirmed') || [];\n  const dismissedAlerts = alerts?.filter(a => a.status === 'dismissed') || [];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Fraud Detection</h1>\n        <p className=\"text-muted-foreground\">Monitor and review suspicious activity</p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardDescription>Pending Review</CardDescription>\n            <CardTitle className=\"text-3xl text-yellow-600\">{pendingAlerts.length}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n              <AlertTriangle className=\"h-3 w-3\" />\n              <span>Awaiting action</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardDescription>Confirmed Fraud</CardDescription>\n            <CardTitle className=\"text-3xl text-destructive\">{confirmedAlerts.length}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n              <XCircle className=\"h-3 w-3\" />\n              <span>Verified threats</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardDescription>Dismissed</CardDescription>\n            <CardTitle className=\"text-3xl text-green-600\">{dismissedAlerts.length}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n              <CheckCircle className=\"h-3 w-3\" />\n              <span>False positives</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {isLoading ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-muted-foreground\">\n            Loading fraud alerts...\n          </CardContent>\n        </Card>\n      ) : isError ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-destructive\">\n            Failed to load fraud alerts\n          </CardContent>\n        </Card>\n      ) : (\n        <>\n          {pendingAlerts.length > 0 && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Pending Review</CardTitle>\n                <CardDescription>Alerts requiring your attention</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {pendingAlerts.map((alert) => (\n                    <div\n                      key={alert.id}\n                      className=\"p-4 rounded-md border space-y-3\"\n                      data-testid={`alert-${alert.id}`}\n                    >\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-2\">\n                            {alert.alertType === 'Suspicious Profile' ? (\n                              <User className=\"h-4 w-4 text-destructive\" />\n                            ) : (\n                              <Briefcase className=\"h-4 w-4 text-destructive\" />\n                            )}\n                            <h3 className=\"font-medium\">{alert.alertType}</h3>\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              Confidence: {alert.aiConfidence}%\n                            </Badge>\n                          </div>\n                          \n                          {/* Show what was flagged */}\n                          {alert.entityInfo && (\n                            <div className=\"mb-2 p-2 rounded bg-muted/50\">\n                              <p className=\"text-xs font-semibold text-muted-foreground mb-1\">Flagged {alert.entityType}:</p>\n                              {alert.entityType === 'user' ? (\n                                <div className=\"text-sm\">\n                                  <p className=\"font-medium\">{alert.entityInfo.name}</p>\n                                  <p className=\"text-xs text-muted-foreground\">{alert.entityInfo.email}</p>\n                                  <Badge variant=\"secondary\" className=\"text-xs mt-1\">{alert.entityInfo.role}</Badge>\n                                </div>\n                              ) : (\n                                <div className=\"text-sm\">\n                                  <p className=\"font-medium\">{alert.entityInfo.title}</p>\n                                  <p className=\"text-xs text-muted-foreground\">{alert.entityInfo.company}</p>\n                                  <p className=\"text-xs text-muted-foreground\">Posted by: {alert.entityInfo.employerName}</p>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                          \n                          <p className=\"text-sm text-muted-foreground mb-2\">{alert.description}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            Detected {format(new Date(alert.createdAt), 'PPp')}\n                          </p>\n                        </div>\n                      </div>\n                      \n                      {reviewingAlert === alert.id ? (\n                        <div className=\"space-y-3 pt-3 border-t\">\n                          <Textarea\n                            placeholder=\"Add review notes...\"\n                            value={reviewNotes}\n                            onChange={(e) => setReviewNotes(e.target.value)}\n                            data-testid={`textarea-notes-${alert.id}`}\n                          />\n                          <div className=\"flex gap-2\">\n                            <Button\n                              size=\"sm\"\n                              variant=\"destructive\"\n                              onClick={() => reviewAlertMutation.mutate({ id: alert.id, status: 'confirmed', notes: reviewNotes })}\n                              disabled={reviewAlertMutation.isPending}\n                              data-testid={`button-confirm-${alert.id}`}\n                            >\n                              <XCircle className=\"h-4 w-4 mr-1\" />\n                              Confirm Fraud\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              variant=\"outline\"\n                              onClick={() => reviewAlertMutation.mutate({ id: alert.id, status: 'dismissed', notes: reviewNotes })}\n                              disabled={reviewAlertMutation.isPending}\n                              data-testid={`button-dismiss-${alert.id}`}\n                            >\n                              <CheckCircle className=\"h-4 w-4 mr-1\" />\n                              Dismiss\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              onClick={() => {\n                                setReviewingAlert(null);\n                                setReviewNotes(\"\");\n                              }}\n                            >\n                              Cancel\n                            </Button>\n                          </div>\n                        </div>\n                      ) : (\n                        <div className=\"flex gap-2\">\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => handleViewDetails(alert)}\n                            data-testid={`button-view-details-${alert.id}`}\n                          >\n                            <Eye className=\"h-4 w-4 mr-1\" />\n                            View Details\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            onClick={() => setReviewingAlert(alert.id)}\n                            data-testid={`button-review-${alert.id}`}\n                          >\n                            Review Alert\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {confirmedAlerts.length > 0 && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Confirmed Fraud</CardTitle>\n                <CardDescription>Verified fraudulent activity</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {confirmedAlerts.map((alert) => (\n                    <div\n                      key={alert.id}\n                      className=\"p-4 rounded-md border bg-destructive/5\"\n                      data-testid={`confirmed-${alert.id}`}\n                    >\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <XCircle className=\"h-4 w-4 text-destructive\" />\n                        <h3 className=\"font-medium text-destructive\">{alert.alertType}</h3>\n                      </div>\n                      \n                      {/* Show what was flagged */}\n                      {alert.entityInfo && (\n                        <div className=\"mb-2 p-2 rounded bg-muted/50\">\n                          <p className=\"text-xs font-semibold text-muted-foreground mb-1\">Flagged {alert.entityType}:</p>\n                          {alert.entityType === 'user' ? (\n                            <div className=\"text-sm\">\n                              <p className=\"font-medium\">{alert.entityInfo.name}</p>\n                              <p className=\"text-xs text-muted-foreground\">{alert.entityInfo.email}</p>\n                            </div>\n                          ) : (\n                            <div className=\"text-sm\">\n                              <p className=\"font-medium\">{alert.entityInfo.title}</p>\n                              <p className=\"text-xs text-muted-foreground\">{alert.entityInfo.company}</p>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      \n                      <p className=\"text-sm text-muted-foreground mb-1\">{alert.description}</p>\n                      \n                      {/* Show who reviewed it */}\n                      {alert.reviewerInfo && (\n                        <p className=\"text-xs text-muted-foreground mt-2 flex items-center gap-1\">\n                          <Shield className=\"h-3 w-3\" />\n                          Reviewed by: {alert.reviewerInfo.name}\n                        </p>\n                      )}\n                      \n                      {alert.reviewNotes && (\n                        <p className=\"text-sm italic mt-2\">Notes: {alert.reviewNotes}</p>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {dismissedAlerts.length > 0 && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Dismissed Alerts</CardTitle>\n                <CardDescription>False positives and cleared alerts</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {dismissedAlerts.map((alert) => (\n                    <div\n                      key={alert.id}\n                      className=\"p-4 rounded-md border bg-green-50 dark:bg-green-950/20\"\n                      data-testid={`dismissed-${alert.id}`}\n                    >\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                        <h3 className=\"font-medium text-green-700 dark:text-green-400\">{alert.alertType}</h3>\n                      </div>\n                      \n                      {/* Show what was flagged */}\n                      {alert.entityInfo && (\n                        <div className=\"mb-2 p-2 rounded bg-muted/50\">\n                          <p className=\"text-xs font-semibold text-muted-foreground mb-1\">Flagged {alert.entityType}:</p>\n                          {alert.entityType === 'user' ? (\n                            <div className=\"text-sm\">\n                              <p className=\"font-medium\">{alert.entityInfo.name}</p>\n                              <p className=\"text-xs text-muted-foreground\">{alert.entityInfo.email}</p>\n                            </div>\n                          ) : (\n                            <div className=\"text-sm\">\n                              <p className=\"font-medium\">{alert.entityInfo.title}</p>\n                              <p className=\"text-xs text-muted-foreground\">{alert.entityInfo.company}</p>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      \n                      <p className=\"text-sm text-muted-foreground mb-1\">{alert.description}</p>\n                      \n                      {/* Show who reviewed it */}\n                      {alert.reviewerInfo && (\n                        <p className=\"text-xs text-muted-foreground mt-2 flex items-center gap-1\">\n                          <Shield className=\"h-3 w-3\" />\n                          Dismissed by: {alert.reviewerInfo.name}\n                        </p>\n                      )}\n                      \n                      {alert.reviewNotes && (\n                        <p className=\"text-sm italic mt-2\">Notes: {alert.reviewNotes}</p>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </>\n      )}\n\n      <Dialog open={!!viewingDetails} onOpenChange={() => {\n        setViewingDetails(null);\n        setDetailsData(null);\n      }}>\n        <DialogContent className=\"max-w-3xl max-h-[80vh]\">\n          <DialogHeader>\n            <DialogTitle>\n              {viewingDetails?.entityType === 'user' ? 'User Profile Details' : 'Job Post Details'}\n            </DialogTitle>\n            <DialogDescription>\n              Detailed information for fraud alert investigation\n            </DialogDescription>\n          </DialogHeader>\n          \n          {viewingDetails && (\n            <div className=\"mb-4 p-4 rounded-md bg-destructive/10 border border-destructive/20\">\n              <div className=\"flex items-start gap-2\">\n                <AlertTriangle className=\"h-5 w-5 text-destructive flex-shrink-0 mt-0.5\" />\n                <div className=\"flex-1\">\n                  <p className=\"text-sm font-medium text-destructive mb-1\">Fraud Alert Reason</p>\n                  <p className=\"text-sm\">{viewingDetails.description}</p>\n                  <div className=\"flex items-center gap-2 mt-2\">\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      Confidence: {viewingDetails.aiConfidence}%\n                    </Badge>\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {viewingDetails.alertType}\n                    </Badge>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          <ScrollArea className=\"max-h-[60vh] pr-4\">\n            {loadingDetails ? (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                Loading details...\n              </div>\n            ) : !detailsData ? (\n              <div className=\"py-8 text-center text-destructive\">\n                No data found for this {viewingDetails?.entityType}\n              </div>\n            ) : viewingDetails?.entityType === 'user' ? (\n              <div className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <p className=\"text-sm font-medium text-muted-foreground\">Name</p>\n                    <p className=\"text-base\">{detailsData.firstName} {detailsData.lastName}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm font-medium text-muted-foreground\">Email</p>\n                    <div className=\"flex items-center gap-2\">\n                      <Mail className=\"h-4 w-4\" />\n                      <p className=\"text-base\">{detailsData.email}</p>\n                    </div>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <p className=\"text-sm font-medium text-muted-foreground\">Role</p>\n                    <Badge variant=\"outline\">{detailsData.role || 'Not set'}</Badge>\n                  </div>\n                  <div>\n                    <p className=\"text-sm font-medium text-muted-foreground\">Status</p>\n                    <div className=\"flex items-center gap-2\">\n                      <Shield className={detailsData.isFlagged ? \"h-4 w-4 text-destructive\" : \"h-4 w-4 text-green-600\"} />\n                      <Badge variant={detailsData.isFlagged ? \"destructive\" : \"default\"}>\n                        {detailsData.isFlagged ? 'Flagged' : 'Active'}\n                      </Badge>\n                    </div>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground mb-2\">Additional Information</p>\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                      <p>Joined: {detailsData.createdAt ? format(new Date(detailsData.createdAt), 'PPP') : 'N/A'}</p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className={detailsData.isEmailVerified ? \"h-4 w-4 text-green-600\" : \"h-4 w-4 text-muted-foreground\"} />\n                      <p>Email {detailsData.isEmailVerified ? 'Verified' : 'Not Verified'}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {detailsData.role === 'job_seeker' && (\n                  <>\n                    <Separator />\n                    <div>\n                      <p className=\"text-sm font-medium text-muted-foreground mb-2\">Profile Stats</p>\n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                        <div>\n                          <p className=\"text-muted-foreground\">Applications</p>\n                          <p className=\"text-lg font-semibold\">{detailsData.applicationCount || 0}</p>\n                        </div>\n                      </div>\n                    </div>\n                  </>\n                )}\n\n                {detailsData.role === 'employer' && (\n                  <>\n                    <Separator />\n                    <div>\n                      <p className=\"text-sm font-medium text-muted-foreground mb-2\">Employer Stats</p>\n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                        <div>\n                          <p className=\"text-muted-foreground\">Jobs Posted</p>\n                          <p className=\"text-lg font-semibold\">{detailsData.jobCount || 0}</p>\n                        </div>\n                      </div>\n                    </div>\n                  </>\n                )}\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Job Title</p>\n                  <p className=\"text-lg font-semibold\">{detailsData.title}</p>\n                </div>\n\n                <Separator />\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                      <p className=\"text-sm font-medium text-muted-foreground\">Location</p>\n                    </div>\n                    <p className=\"text-base\">{detailsData.location}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm font-medium text-muted-foreground mb-1\">Job Type</p>\n                    <Badge>{detailsData.jobType?.replace('_', ' ')}</Badge>\n                  </div>\n                </div>\n\n                <Separator />\n\n                {(detailsData.salaryMin || detailsData.salaryMax) && (\n                  <>\n                    <div>\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <Banknote className=\"h-4 w-4 text-muted-foreground\" />\n                        <p className=\"text-sm font-medium text-muted-foreground\">Salary Range</p>\n                      </div>\n                      <p className=\"text-base\">\n                        {detailsData.salaryMin ? `${detailsData.salaryCurrency || 'USD'} ${detailsData.salaryMin.toLocaleString()}` : 'N/A'}\n                        {' - '}\n                        {detailsData.salaryMax ? `${detailsData.salaryCurrency || 'USD'} ${detailsData.salaryMax.toLocaleString()}` : 'N/A'}\n                      </p>\n                    </div>\n                    <Separator />\n                  </>\n                )}\n\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground mb-2\">Description</p>\n                  <p className=\"text-sm whitespace-pre-wrap\">{detailsData.description}</p>\n                </div>\n\n                {detailsData.skills && detailsData.skills.length > 0 && (\n                  <>\n                    <Separator />\n                    <div>\n                      <p className=\"text-sm font-medium text-muted-foreground mb-2\">Required Skills</p>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {detailsData.skills.map((skill: string, index: number) => (\n                          <Badge key={index} variant=\"outline\">{skill}</Badge>\n                        ))}\n                      </div>\n                    </div>\n                  </>\n                )}\n\n                <Separator />\n\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                    <p>Posted: {detailsData.createdAt ? format(new Date(detailsData.createdAt), 'PPP') : 'N/A'}</p>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Shield className={detailsData.isFlagged ? \"h-4 w-4 text-destructive\" : \"h-4 w-4 text-green-600\"} />\n                    <Badge variant={detailsData.isFlagged ? \"destructive\" : \"default\"}>\n                      {detailsData.isFlagged ? 'Flagged' : detailsData.isActive ? 'Active' : 'Inactive'}\n                    </Badge>\n                  </div>\n                </div>\n              </div>\n            )}\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":26284,"size_tokens":null},"client/src/pages/admin-users.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Search, Flag, CheckCircle, XCircle, Shield, Trash2, UserPlus, ChevronLeft, ChevronRight, Eye } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\n\nconst USERS_PER_PAGE = 10;\n\nexport default function AdminUsers() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [currentPage, setCurrentPage] = useState(1);\n  const [createAdminDialogOpen, setCreateAdminDialogOpen] = useState(false);\n  const [newAdmin, setNewAdmin] = useState({\n    email: \"\",\n    password: \"\",\n    firstName: \"\",\n    lastName: \"\",\n  });\n\n  const { data: users, isLoading, isError } = useQuery<any[]>({\n    queryKey: [\"/api/admin/users\"],\n  });\n\n  const flagUserMutation = useMutation({\n    mutationFn: async ({ id, isFlagged }: { id: string; isFlagged: boolean }) => {\n      return await apiRequest(\"PUT\", `/api/admin/users/${id}/flag`, { isFlagged });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n      toast({ title: \"Success\", description: \"User status updated\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update user\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteUserMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/admin/users/${id}`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n      toast({ title: \"Success\", description: \"User deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to delete user\", \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const createAdminMutation = useMutation({\n    mutationFn: async (data: typeof newAdmin) => {\n      return await apiRequest(\"POST\", \"/api/admin/users/admin\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n      setCreateAdminDialogOpen(false);\n      setNewAdmin({ email: \"\", password: \"\", firstName: \"\", lastName: \"\" });\n      toast({ title: \"Success\", description: \"Admin account created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to create admin account\", \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const filteredUsers = users?.filter(u =>\n    u.email.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    u.firstName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    u.lastName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    u.role?.toLowerCase().includes(searchQuery.toLowerCase())\n  ) || [];\n\n  const totalPages = Math.ceil(filteredUsers.length / USERS_PER_PAGE);\n  const startIndex = (currentPage - 1) * USERS_PER_PAGE;\n  const endIndex = startIndex + USERS_PER_PAGE;\n  const paginatedUsers = filteredUsers.slice(startIndex, endIndex);\n\n  // Reset to page 1 when search changes\n  const handleSearchChange = (value: string) => {\n    setSearchQuery(value);\n    setCurrentPage(1);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold mb-2\">User Management</h1>\n          <p className=\"text-muted-foreground\">Manage all platform users</p>\n        </div>\n        <Dialog open={createAdminDialogOpen} onOpenChange={setCreateAdminDialogOpen}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-create-admin\">\n              <UserPlus className=\"h-4 w-4 mr-2\" />\n              Create Admin\n            </Button>\n          </DialogTrigger>\n          <DialogContent data-testid=\"dialog-create-admin\">\n            <DialogHeader>\n              <DialogTitle>Create Admin Account</DialogTitle>\n              <DialogDescription>\n                Create a new administrator account with full platform access\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"admin-email\">Email</Label>\n                <Input\n                  id=\"admin-email\"\n                  type=\"email\"\n                  placeholder=\"admin@example.com\"\n                  value={newAdmin.email}\n                  onChange={(e) => setNewAdmin({ ...newAdmin, email: e.target.value })}\n                  data-testid=\"input-admin-email\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"admin-password\">Password</Label>\n                <Input\n                  id=\"admin-password\"\n                  type=\"password\"\n                  placeholder=\"Minimum 8 characters\"\n                  value={newAdmin.password}\n                  onChange={(e) => setNewAdmin({ ...newAdmin, password: e.target.value })}\n                  data-testid=\"input-admin-password\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"admin-first-name\">First Name</Label>\n                <Input\n                  id=\"admin-first-name\"\n                  placeholder=\"John\"\n                  value={newAdmin.firstName}\n                  onChange={(e) => setNewAdmin({ ...newAdmin, firstName: e.target.value })}\n                  data-testid=\"input-admin-first-name\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"admin-last-name\">Last Name</Label>\n                <Input\n                  id=\"admin-last-name\"\n                  placeholder=\"Doe\"\n                  value={newAdmin.lastName}\n                  onChange={(e) => setNewAdmin({ ...newAdmin, lastName: e.target.value })}\n                  data-testid=\"input-admin-last-name\"\n                />\n              </div>\n            </div>\n            <DialogFooter>\n              <Button\n                variant=\"outline\"\n                onClick={() => setCreateAdminDialogOpen(false)}\n                data-testid=\"button-cancel-admin\"\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={() => createAdminMutation.mutate(newAdmin)}\n                disabled={createAdminMutation.isPending || !newAdmin.email || !newAdmin.password || !newAdmin.firstName || !newAdmin.lastName}\n                data-testid=\"button-submit-admin\"\n              >\n                {createAdminMutation.isPending ? \"Creating...\" : \"Create Admin\"}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Search Users</CardTitle>\n          <CardDescription>Find users by name, email, or role</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search users...\"\n              value={searchQuery}\n              onChange={(e) => handleSearchChange(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search-users\"\n            />\n          </div>\n        </CardContent>\n      </Card>\n\n      {isLoading ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-muted-foreground\">\n            Loading users...\n          </CardContent>\n        </Card>\n      ) : isError ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-destructive\">\n            Failed to load users\n          </CardContent>\n        </Card>\n      ) : (\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <CardTitle>All Users ({filteredUsers.length})</CardTitle>\n                <CardDescription>\n                  {filteredUsers.length > 0 \n                    ? `Showing ${startIndex + 1}-${Math.min(endIndex, filteredUsers.length)} of ${filteredUsers.length}`\n                    : 'No users found'\n                  }\n                </CardDescription>\n              </div>\n              {totalPages > 1 && (\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\n                    disabled={currentPage === 1}\n                    data-testid=\"button-previous-page\"\n                  >\n                    <ChevronLeft className=\"h-4 w-4 mr-1\" />\n                    Previous\n                  </Button>\n                  <span className=\"text-sm text-muted-foreground\">\n                    Page {currentPage} of {totalPages}\n                  </span>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\n                    disabled={currentPage === totalPages}\n                    data-testid=\"button-next-page\"\n                  >\n                    Next\n                    <ChevronRight className=\"h-4 w-4 ml-1\" />\n                  </Button>\n                </div>\n              )}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {paginatedUsers.map((user) => (\n                <div\n                  key={user.id}\n                  className=\"flex items-center justify-between p-4 rounded-md border hover-elevate\"\n                  data-testid={`user-row-${user.id}`}\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"font-medium\">{user.firstName} {user.lastName}</p>\n                      <Badge variant={user.role === 'admin' ? 'destructive' : 'secondary'} className=\"text-xs\">\n                        {user.role?.replace('_', ' ') || 'unknown'}\n                      </Badge>\n                      {user.isEmailVerified && (\n                        <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                      )}\n                      {user.flagged && (\n                        <Flag className=\"h-4 w-4 text-destructive\" />\n                      )}\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">{user.email}</p>\n                    <div className=\"flex gap-2 mt-1\">\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        {user.totalApplications || 0} applications\n                      </Badge>\n                      {user.role === 'employer' && (\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {user.totalJobs || 0} jobs\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Dialog>\n                      <DialogTrigger asChild>\n                        <Button variant=\"outline\" size=\"sm\" data-testid={`button-view-${user.id}`}>\n                          <Eye className=\"h-4 w-4 mr-1\" />\n                          View\n                        </Button>\n                      </DialogTrigger>\n                      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n                        <DialogHeader>\n                          <DialogTitle>User Details</DialogTitle>\n                          <DialogDescription>\n                            Complete information for {user.firstName} {user.lastName}\n                          </DialogDescription>\n                        </DialogHeader>\n                        <div className=\"space-y-4\">\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Full Name</h4>\n                              <p className=\"text-sm text-muted-foreground\">{user.firstName} {user.lastName}</p>\n                            </div>\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Email</h4>\n                              <p className=\"text-sm text-muted-foreground\">{user.email}</p>\n                            </div>\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Role</h4>\n                              <Badge variant={user.role === 'admin' ? 'destructive' : 'secondary'}>\n                                {user.role?.replace('_', ' ') || 'unknown'}\n                              </Badge>\n                            </div>\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Email Verified</h4>\n                              <div className=\"flex items-center gap-2\">\n                                {user.isEmailVerified ? (\n                                  <><CheckCircle className=\"h-4 w-4 text-green-600\" /> <span className=\"text-sm\">Yes</span></>\n                                ) : (\n                                  <><XCircle className=\"h-4 w-4 text-destructive\" /> <span className=\"text-sm\">No</span></>\n                                )}\n                              </div>\n                            </div>\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Account Status</h4>\n                              <Badge variant={user.flagged ? 'destructive' : 'default'}>\n                                {user.flagged ? 'Flagged' : 'Active'}\n                              </Badge>\n                            </div>\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">User ID</h4>\n                              <p className=\"text-xs text-muted-foreground font-mono\">{user.id}</p>\n                            </div>\n                          </div>\n\n                          {user.flagged && user.fraudAlertReason && (\n                            <div className=\"p-4 bg-destructive/10 border border-destructive/30 rounded-lg\" data-testid={`fraud-alert-reason-${user.id}`}>\n                              <div className=\"flex items-center gap-2 mb-2\">\n                                <Flag className=\"h-4 w-4 text-destructive\" />\n                                <h4 className=\"text-sm font-semibold text-destructive\">Fraud Alert Details</h4>\n                              </div>\n                              <div className=\"space-y-2\">\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"text-xs font-medium text-muted-foreground\">Type:</span>\n                                  <Badge variant=\"destructive\" className=\"text-xs\">{user.fraudAlertType}</Badge>\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"text-xs font-medium text-muted-foreground\">AI Confidence:</span>\n                                  <Badge variant=\"outline\" className=\"text-xs\">{user.fraudAlertConfidence}%</Badge>\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"text-xs font-medium text-muted-foreground\">Status:</span>\n                                  <Badge \n                                    variant={user.fraudAlertStatus === 'confirmed' ? 'destructive' : user.fraudAlertStatus === 'dismissed' ? 'secondary' : 'outline'} \n                                    className=\"text-xs capitalize\"\n                                  >\n                                    {user.fraudAlertStatus}\n                                  </Badge>\n                                </div>\n                                <div>\n                                  <span className=\"text-xs font-medium text-muted-foreground block mb-1\">Reason:</span>\n                                  <p className=\"text-sm text-foreground\">{user.fraudAlertReason}</p>\n                                </div>\n                              </div>\n                            </div>\n                          )}\n                          \n                          {user.location && (\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Location</h4>\n                              <p className=\"text-sm text-muted-foreground\">{user.location}</p>\n                            </div>\n                          )}\n\n                          {user.bio && (\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Bio</h4>\n                              <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{user.bio}</p>\n                            </div>\n                          )}\n\n                          {user.companyName && (\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Company</h4>\n                              <p className=\"text-sm text-muted-foreground\">{user.companyName}</p>\n                            </div>\n                          )}\n\n                          {user.phoneNumber && (\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Phone Number</h4>\n                              <p className=\"text-sm text-muted-foreground\">{user.phoneNumber}</p>\n                            </div>\n                          )}\n\n                          {user.skills && user.skills.length > 0 && (\n                            <div>\n                              <h4 className=\"text-sm font-semibold mb-1\">Skills</h4>\n                              <div className=\"flex flex-wrap gap-2\">\n                                {user.skills.map((skill: string, idx: number) => (\n                                  <Badge key={idx} variant=\"secondary\">{skill}</Badge>\n                                ))}\n                              </div>\n                            </div>\n                          )}\n\n                          {user.resumeUrl && (\n                            <div className=\"pt-4 border-t\">\n                              <h4 className=\"text-sm font-semibold mb-2\">Resume</h4>\n                              <Button\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => window.open('/objects' + user.resumeUrl, '_blank')}\n                                data-testid={`button-view-resume-${user.id}`}\n                              >\n                                <Eye className=\"h-4 w-4 mr-2\" />\n                                View Resume\n                              </Button>\n                            </div>\n                          )}\n\n                          <div className=\"pt-4 border-t\">\n                            <h4 className=\"text-sm font-semibold mb-2\">Activity</h4>\n                            <div className=\"grid grid-cols-2 gap-2\">\n                              <div className=\"flex items-center justify-between p-2 bg-muted rounded\">\n                                <span className=\"text-sm\">Applications</span>\n                                <Badge variant=\"outline\">{user.totalApplications || 0}</Badge>\n                              </div>\n                              {user.role === 'employer' && (\n                                <div className=\"flex items-center justify-between p-2 bg-muted rounded\">\n                                  <span className=\"text-sm\">Jobs Posted</span>\n                                  <Badge variant=\"outline\">{user.totalJobs || 0}</Badge>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </DialogContent>\n                    </Dialog>\n\n                    <Button\n                      variant={user.flagged ? \"destructive\" : \"outline\"}\n                      size=\"sm\"\n                      onClick={() => flagUserMutation.mutate({ id: user.id, isFlagged: !user.flagged })}\n                      disabled={flagUserMutation.isPending}\n                      data-testid={`button-flag-${user.id}`}\n                    >\n                      {user.flagged ? (\n                        <>\n                          <XCircle className=\"h-4 w-4 mr-1\" />\n                          Unflag\n                        </>\n                      ) : (\n                        <>\n                          <Flag className=\"h-4 w-4 mr-1\" />\n                          Flag\n                        </>\n                      )}\n                    </Button>\n                    <AlertDialog>\n                      <AlertDialogTrigger asChild>\n                        <Button\n                          variant=\"destructive\"\n                          size=\"sm\"\n                          data-testid={`button-delete-${user.id}`}\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-1\" />\n                          Delete\n                        </Button>\n                      </AlertDialogTrigger>\n                      <AlertDialogContent data-testid={`dialog-delete-${user.id}`}>\n                        <AlertDialogHeader>\n                          <AlertDialogTitle>Delete User</AlertDialogTitle>\n                          <AlertDialogDescription>\n                            Are you sure you want to delete {user.firstName} {user.lastName} ({user.email})? \n                            This will permanently delete their account and all associated data including:\n                            <ul className=\"list-disc list-inside mt-2 space-y-1\">\n                              <li>Profile information</li>\n                              {user.role === 'job_seeker' && <li>Applications and work history</li>}\n                              {user.role === 'employer' && <li>Job postings and applications</li>}\n                              <li>All related records</li>\n                            </ul>\n                            <strong className=\"block mt-2\">This action cannot be undone.</strong>\n                          </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                          <AlertDialogCancel data-testid={`button-cancel-delete-${user.id}`}>\n                            Cancel\n                          </AlertDialogCancel>\n                          <AlertDialogAction\n                            onClick={() => deleteUserMutation.mutate(user.id)}\n                            disabled={deleteUserMutation.isPending}\n                            className=\"bg-destructive text-destructive-foreground hover-elevate active-elevate-2\"\n                            data-testid={`button-confirm-delete-${user.id}`}\n                          >\n                            {deleteUserMutation.isPending ? \"Deleting...\" : \"Delete User\"}\n                          </AlertDialogAction>\n                        </AlertDialogFooter>\n                      </AlertDialogContent>\n                    </AlertDialog>\n                  </div>\n                </div>\n              ))}\n              {paginatedUsers.length === 0 && (\n                <p className=\"text-center py-8 text-muted-foreground\">No users found</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":24808,"size_tokens":null},"client/src/pages/admin-jobs.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Search, Flag, XCircle, MapPin, Building2, Eye, Trash2, FileText, ExternalLink } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { format } from \"date-fns\";\nimport { formatPesoRange } from \"@/lib/philippines\";\n\nexport default function AdminJobs() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: jobs, isLoading, isError } = useQuery<any[]>({\n    queryKey: [\"/api/admin/jobs\"],\n  });\n\n  const flagJobMutation = useMutation({\n    mutationFn: async ({ id, isFlagged }: { id: string; isFlagged: boolean }) => {\n      return await apiRequest(\"PUT\", `/api/admin/jobs/${id}/flag`, { isFlagged });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/jobs\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/jobs\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n      toast({ title: \"Success\", description: \"Job status updated\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update job\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteJobMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/admin/jobs/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/jobs\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/jobs\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/stats\"] });\n      toast({ title: \"Success\", description: \"Job deleted successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete job\", variant: \"destructive\" });\n    },\n  });\n\n  const filteredJobs = jobs?.filter(j =>\n    !searchQuery ||\n    j.title?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    j.location?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    j.jobType?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    j.companyName?.toLowerCase().includes(searchQuery.toLowerCase())\n  ) || [];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Job Management</h1>\n        <p className=\"text-muted-foreground\">Monitor and manage all job postings</p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Search Jobs</CardTitle>\n          <CardDescription>Find jobs by title, location, or type</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search jobs...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search-jobs\"\n            />\n          </div>\n        </CardContent>\n      </Card>\n\n      {isLoading ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-muted-foreground\">\n            Loading jobs...\n          </CardContent>\n        </Card>\n      ) : isError ? (\n        <Card>\n          <CardContent className=\"py-8 text-center text-destructive\">\n            Failed to load jobs\n          </CardContent>\n        </Card>\n      ) : (\n        <Card>\n          <CardHeader>\n            <CardTitle>All Jobs ({filteredJobs.length})</CardTitle>\n            <CardDescription>Platform job postings</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {filteredJobs.map((job) => (\n                <div\n                  key={job.id}\n                  className=\"flex items-start justify-between p-4 rounded-md border hover-elevate\"\n                  data-testid={`job-row-${job.id}`}\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <h3 className=\"font-medium text-lg\">{job.title}</h3>\n                      <Badge variant={job.status === 'active' ? 'default' : 'secondary'}>\n                        {job.status}\n                      </Badge>\n                      {job.isFlagged && (\n                        <Flag className=\"h-4 w-4 text-destructive\" />\n                      )}\n                    </div>\n                    <div className=\"flex flex-wrap gap-2 mb-2\">\n                      <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n                        <Building2 className=\"h-3 w-3\" />\n                        <span>{job.companyName || 'Unknown'}</span>\n                      </div>\n                      <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n                        <MapPin className=\"h-3 w-3\" />\n                        <span>{job.location}</span>\n                      </div>\n                      {(job.salaryMin || job.salaryMax) && (\n                        <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n                          <span>{formatPesoRange(job.salaryMin, job.salaryMax)}</span>\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        {job.jobType?.replace('_', ' ') || 'Not specified'}\n                      </Badge>\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        Posted {format(new Date(job.createdAt), 'MMM d, yyyy')}\n                      </Badge>\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2 ml-4\">\n                    <Dialog>\n                      <DialogTrigger asChild>\n                        <Button variant=\"outline\" size=\"sm\" data-testid={`button-view-job-${job.id}`}>\n                          <Eye className=\"h-4 w-4 mr-1\" />\n                          View\n                        </Button>\n                      </DialogTrigger>\n                      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n                        <DialogHeader>\n                          <DialogTitle>{job.title}</DialogTitle>\n                          <DialogDescription>\n                            {job.companyName} • {job.location}\n                          </DialogDescription>\n                        </DialogHeader>\n                        <div className=\"space-y-4\">\n                          <div>\n                            <h4 className=\"font-semibold mb-2\">Description</h4>\n                            <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{job.description}</p>\n                          </div>\n                          {job.requirements && job.requirements.length > 0 && (\n                            <div>\n                              <h4 className=\"font-semibold mb-2\">Requirements</h4>\n                              <ul className=\"list-disc list-inside text-sm text-muted-foreground space-y-1\">\n                                {job.requirements.map((req: string, idx: number) => (\n                                  <li key={idx}>{req}</li>\n                                ))}\n                              </ul>\n                            </div>\n                          )}\n                          {job.responsibilities && job.responsibilities.length > 0 && (\n                            <div>\n                              <h4 className=\"font-semibold mb-2\">Responsibilities</h4>\n                              <ul className=\"list-disc list-inside text-sm text-muted-foreground space-y-1\">\n                                {job.responsibilities.map((resp: string, idx: number) => (\n                                  <li key={idx}>{resp}</li>\n                                ))}\n                              </ul>\n                            </div>\n                          )}\n                          {job.skills && job.skills.length > 0 && (\n                            <div>\n                              <h4 className=\"font-semibold mb-2\">Required Skills</h4>\n                              <div className=\"flex flex-wrap gap-2\">\n                                {job.skills.map((skill: string, idx: number) => (\n                                  <Badge key={idx} variant=\"secondary\">{skill}</Badge>\n                                ))}\n                              </div>\n                            </div>\n                          )}\n                          {job.requirementDocumentUrl && (\n                            <div>\n                              <h4 className=\"font-semibold mb-2\">Requirement Document</h4>\n                              <Button\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => window.open('/objects' + job.requirementDocumentUrl, '_blank')}\n                                data-testid={`button-preview-document-${job.id}`}\n                              >\n                                <FileText className=\"h-4 w-4 mr-2\" />\n                                View Document\n                                <ExternalLink className=\"h-3 w-3 ml-2\" />\n                              </Button>\n                            </div>\n                          )}\n                          {job.isFlagged && job.fraudAlertReason && (\n                            <div className=\"p-4 bg-destructive/10 border border-destructive/30 rounded-lg\" data-testid={`fraud-alert-reason-${job.id}`}>\n                              <div className=\"flex items-center gap-2 mb-2\">\n                                <Flag className=\"h-4 w-4 text-destructive\" />\n                                <h4 className=\"text-sm font-semibold text-destructive\">Fraud Alert Details</h4>\n                              </div>\n                              <div className=\"space-y-2\">\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"text-xs font-medium text-muted-foreground\">Type:</span>\n                                  <Badge variant=\"destructive\" className=\"text-xs\">{job.fraudAlertType}</Badge>\n                                </div>\n                                {job.fraudAlertConfidence !== null && (\n                                  <div className=\"flex items-center gap-2\">\n                                    <span className=\"text-xs font-medium text-muted-foreground\">AI Confidence:</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">{job.fraudAlertConfidence}%</Badge>\n                                  </div>\n                                )}\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"text-xs font-medium text-muted-foreground\">Status:</span>\n                                  <Badge \n                                    variant={job.fraudAlertStatus === 'confirmed' ? 'destructive' : job.fraudAlertStatus === 'dismissed' ? 'secondary' : 'outline'} \n                                    className=\"text-xs capitalize\"\n                                  >\n                                    {job.fraudAlertStatus}\n                                  </Badge>\n                                </div>\n                                <div>\n                                  <span className=\"text-xs font-medium text-muted-foreground block mb-1\">Reason:</span>\n                                  <p className=\"text-sm text-foreground\">{job.fraudAlertReason}</p>\n                                </div>\n                              </div>\n                            </div>\n                          )}\n\n                          <div className=\"flex gap-2 pt-4 border-t\">\n                            <Badge>{job.jobType?.replace('_', ' ')}</Badge>\n                            {(job.salaryMin || job.salaryMax) && (\n                              <Badge variant=\"outline\">{formatPesoRange(job.salaryMin, job.salaryMax)}</Badge>\n                            )}\n                            <Badge variant={job.isActive ? 'default' : 'secondary'}>\n                              {job.isActive ? 'Active' : 'Inactive'}\n                            </Badge>\n                            {job.isFlagged && <Badge variant=\"destructive\">Flagged</Badge>}\n                          </div>\n                        </div>\n                      </DialogContent>\n                    </Dialog>\n\n                    {job.requirementDocumentUrl && (\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => window.open('/objects' + job.requirementDocumentUrl, '_blank')}\n                        data-testid={`button-quick-preview-${job.id}`}\n                      >\n                        <FileText className=\"h-4 w-4 mr-1\" />\n                        Document\n                      </Button>\n                    )}\n\n                    <Button\n                      variant={job.isFlagged ? \"destructive\" : \"outline\"}\n                      size=\"sm\"\n                      onClick={() => flagJobMutation.mutate({ id: job.id, isFlagged: !job.isFlagged })}\n                      disabled={flagJobMutation.isPending}\n                      data-testid={`button-flag-job-${job.id}`}\n                    >\n                      {job.isFlagged ? (\n                        <>\n                          <XCircle className=\"h-4 w-4 mr-1\" />\n                          Unflag\n                        </>\n                      ) : (\n                        <>\n                          <Flag className=\"h-4 w-4 mr-1\" />\n                          Flag\n                        </>\n                      )}\n                    </Button>\n\n                    <AlertDialog>\n                      <AlertDialogTrigger asChild>\n                        <Button variant=\"destructive\" size=\"sm\" data-testid={`button-delete-job-${job.id}`}>\n                          <Trash2 className=\"h-4 w-4 mr-1\" />\n                          Delete\n                        </Button>\n                      </AlertDialogTrigger>\n                      <AlertDialogContent>\n                        <AlertDialogHeader>\n                          <AlertDialogTitle>Delete Job Posting</AlertDialogTitle>\n                          <AlertDialogDescription>\n                            Are you sure you want to delete \"{job.title}\"? This action cannot be undone.\n                            All applications for this job will also be affected.\n                          </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                          <AlertDialogCancel>Cancel</AlertDialogCancel>\n                          <AlertDialogAction\n                            onClick={() => deleteJobMutation.mutate(job.id)}\n                            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                          >\n                            Delete\n                          </AlertDialogAction>\n                        </AlertDialogFooter>\n                      </AlertDialogContent>\n                    </AlertDialog>\n                  </div>\n                </div>\n              ))}\n              {filteredJobs.length === 0 && (\n                <p className=\"text-center py-8 text-muted-foreground\">No jobs found</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":16353,"size_tokens":null},"client/src/pages/verify-otp.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient, setAuthToken } from \"@/lib/queryClient\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\nimport { Mail, RefreshCw, CheckCircle } from \"lucide-react\";\n\nexport default function VerifyOTP() {\n  const [otp, setOtp] = useState(\"\");\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [email, setEmail] = useState(\"\");\n  const [canResend, setCanResend] = useState(false);\n  const [countdown, setCountdown] = useState(60);\n\n  useEffect(() => {\n    const savedEmail = sessionStorage.getItem(\"pendingVerificationEmail\");\n    if (!savedEmail) {\n      setLocation(\"/register\");\n      return;\n    }\n    setEmail(savedEmail);\n  }, [setLocation]);\n\n  useEffect(() => {\n    if (countdown > 0 && !canResend) {\n      const timer = setTimeout(() => setCountdown(countdown - 1), 1000);\n      return () => clearTimeout(timer);\n    } else if (countdown === 0) {\n      setCanResend(true);\n    }\n  }, [countdown, canResend]);\n\n  const verifyMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/auth/verify-otp\", { email, otp });\n      return await response.json();\n    },\n    onSuccess: async (data: any) => {\n      sessionStorage.removeItem(\"pendingVerificationEmail\");\n      \n      // Store JWT token for subsequent requests\n      if (data.token) {\n        setAuthToken(data.token);\n      }\n      \n      // Invalidate the auth query to refetch user data with new token\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n      \n      toast({\n        title: \"Email verified!\",\n        description: \"Welcome to ZambaJobs\",\n      });\n      \n      // Redirect based on user role\n      const role = data.user?.role;\n      if (role === \"job_seeker\") {\n        setLocation(\"/dashboard\");\n      } else if (role === \"employer\") {\n        setLocation(\"/employer/dashboard\");\n      } else if (role === \"admin\") {\n        setLocation(\"/admin/dashboard\");\n      } else {\n        setLocation(\"/dashboard\"); // Default fallback\n      }\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Verification failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const resendMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/auth/resend-otp\", { email });\n      return await response.json();\n    },\n    onSuccess: () => {\n      setCanResend(false);\n      setCountdown(60);\n      toast({\n        title: \"Code resent\",\n        description: \"Check your email for a new verification code\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to resend\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleOtpChange = (value: string) => {\n    setOtp(value);\n    if (value.length === 6) {\n      verifyMutation.mutate();\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center\">\n              <Mail className=\"h-8 w-8 text-primary\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl\">Verify Your Email</CardTitle>\n          <CardDescription>\n            We've sent a 6-digit code to <strong>{email}</strong>\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div className=\"flex flex-col items-center space-y-4\">\n            <InputOTP \n              maxLength={6} \n              value={otp} \n              onChange={handleOtpChange}\n              data-testid=\"input-otp\"\n            >\n              <InputOTPGroup>\n                <InputOTPSlot index={0} />\n                <InputOTPSlot index={1} />\n                <InputOTPSlot index={2} />\n                <InputOTPSlot index={3} />\n                <InputOTPSlot index={4} />\n                <InputOTPSlot index={5} />\n              </InputOTPGroup>\n            </InputOTP>\n\n            {verifyMutation.isPending && (\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <div className=\"h-4 w-4 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\n                <span>Verifying...</span>\n              </div>\n            )}\n\n            {verifyMutation.isSuccess && (\n              <div className=\"flex items-center gap-2 text-sm text-green-600\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <span>Verified successfully!</span>\n              </div>\n            )}\n          </div>\n\n          <div className=\"text-center space-y-2\">\n            <p className=\"text-sm text-muted-foreground\">Didn't receive the code?</p>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => resendMutation.mutate()}\n              disabled={!canResend || resendMutation.isPending}\n              data-testid=\"button-resend-otp\"\n            >\n              <RefreshCw className={`h-4 w-4 mr-2 ${resendMutation.isPending ? 'animate-spin' : ''}`} />\n              {canResend ? \"Resend Code\" : `Resend in ${countdown}s`}\n            </Button>\n          </div>\n\n          <div className=\"pt-4 border-t text-center text-sm text-muted-foreground\">\n            <p>Need help? Contact support@zambajobs.digital</p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":6001,"size_tokens":null},"server/resend-client.ts":{"content":"import { Resend } from 'resend';\n\nlet connectionSettings: any;\n\nasync function getCredentials() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME;\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=resend',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  if (!connectionSettings || (!connectionSettings.settings.api_key)) {\n    throw new Error('Resend not connected');\n  }\n  return {apiKey: connectionSettings.settings.api_key, fromEmail: connectionSettings.settings.from_email};\n}\n\nexport async function getUncachableResendClient() {\n  const credentials = await getCredentials();\n  return {\n    client: new Resend(credentials.apiKey),\n    fromEmail: connectionSettings.settings.from_email\n  };\n}\n","path":null,"size_bytes":1184,"size_tokens":null},"client/src/components/philippine-date-picker.tsx":{"content":"import { format } from \"date-fns\";\nimport { Calendar as CalendarIcon } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useState } from \"react\";\n\ntype DatePickerMode = \"full\" | \"month-year\" | \"year\";\n\ninterface PhilippineDatePickerProps {\n  value: string;\n  onChange: (value: string) => void;\n  mode?: DatePickerMode;\n  placeholder?: string;\n  disabled?: boolean;\n  testId?: string;\n}\n\nexport function PhilippineDatePicker({\n  value,\n  onChange,\n  mode = \"month-year\",\n  placeholder = \"Select date\",\n  disabled = false,\n  testId,\n}: PhilippineDatePickerProps) {\n  const [open, setOpen] = useState(false);\n  \n  // Parse value to Date\n  const parseValue = (): Date | undefined => {\n    if (!value) return undefined;\n    \n    if (mode === \"year\") {\n      const year = parseInt(value);\n      if (isNaN(year)) return undefined;\n      return new Date(year, 0, 1);\n    } else if (mode === \"month-year\") {\n      const [year, month] = value.split('-');\n      if (!year || !month) return undefined;\n      return new Date(parseInt(year), parseInt(month) - 1, 1);\n    } else {\n      return new Date(value);\n    }\n  };\n  \n  // Format Date to string\n  const formatValue = (date: Date | undefined): string => {\n    if (!date) return \"\";\n    \n    if (mode === \"year\") {\n      return String(date.getFullYear());\n    } else if (mode === \"month-year\") {\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      return `${year}-${month}`;\n    } else {\n      return format(date, \"yyyy-MM-dd\");\n    }\n  };\n  \n  // Get display text\n  const getDisplayText = (): string => {\n    const date = parseValue();\n    if (!date) return placeholder;\n    \n    if (mode === \"year\") {\n      return String(date.getFullYear());\n    } else if (mode === \"month-year\") {\n      return format(date, \"MMMM yyyy\");\n    } else {\n      return format(date, \"PPP\");\n    }\n  };\n  \n  // Handle date selection\n  const handleSelect = (date: Date | undefined) => {\n    if (date) {\n      onChange(formatValue(date));\n      if (mode !== \"full\") {\n        setOpen(false);\n      }\n    }\n  };\n  \n  // For year-only mode, show year selector\n  if (mode === \"year\") {\n    const currentYear = new Date().getFullYear();\n    const years = Array.from({ length: 100 }, (_, i) => currentYear - i);\n    \n    return (\n      <Select value={value} onValueChange={onChange} disabled={disabled}>\n        <SelectTrigger className={cn(\"justify-start text-left font-normal\")} data-testid={testId}>\n          <div className=\"flex items-center gap-2\">\n            <CalendarIcon className=\"h-4 w-4\" />\n            <span className={cn(!value && \"text-muted-foreground\")}>\n              {value || placeholder}\n            </span>\n          </div>\n        </SelectTrigger>\n        <SelectContent>\n          {years.map((year) => (\n            <SelectItem key={year} value={String(year)}>\n              {year}\n            </SelectItem>\n          ))}\n        </SelectContent>\n      </Select>\n    );\n  }\n  \n  // For full and month-year modes, show calendar\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          className={cn(\n            \"justify-start text-left font-normal w-full\",\n            !value && \"text-muted-foreground\"\n          )}\n          disabled={disabled}\n          data-testid={testId}\n        >\n          <CalendarIcon className=\"mr-2 h-4 w-4\" />\n          {getDisplayText()}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-auto p-0\" align=\"start\">\n        <Calendar\n          mode=\"single\"\n          selected={parseValue()}\n          onSelect={handleSelect}\n          initialFocus\n        />\n      </PopoverContent>\n    </Popover>\n  );\n}\n","path":null,"size_bytes":4048,"size_tokens":null},"client/src/lib/philippines.ts":{"content":"// Philippine localization utilities\n\n/**\n * Format a Philippine phone number to canonical form (+63XXXXXXXXXX)\n * Accepts: +63XXXXXXXXXX, 09XXXXXXXXX, 9XXXXXXXXX\n */\nexport function formatPhilippinePhone(phone: string): string {\n  if (!phone) return \"\";\n  \n  // Remove all non-digit characters\n  const digits = phone.replace(/\\D/g, \"\");\n  \n  // Handle different formats\n  if (digits.startsWith(\"63\")) {\n    return `+${digits}`;\n  } else if (digits.startsWith(\"9\") && digits.length === 10) {\n    return `+63${digits}`;\n  } else if (digits.startsWith(\"0\") && digits.length === 11) {\n    return `+63${digits.substring(1)}`;\n  }\n  \n  return phone; // Return as-is if format doesn't match\n}\n\n/**\n * Display Philippine phone number in user-friendly format\n * +63 XXX-XXXX-XXXX or 09XX-XXX-XXXX\n */\nexport function displayPhilippinePhone(phone: string): string {\n  if (!phone) return \"\";\n  \n  const canonical = formatPhilippinePhone(phone);\n  if (canonical.startsWith(\"+63\") && canonical.length === 13) {\n    const number = canonical.substring(3);\n    return `+63 ${number.substring(0, 3)}-${number.substring(3, 7)}-${number.substring(7)}`;\n  }\n  \n  return phone;\n}\n\n/**\n * Validate Philippine phone number format\n */\nexport function isValidPhilippinePhone(phone: string): boolean {\n  if (!phone) return true; // Optional field\n  \n  const phoneRegex = /^(\\+63|0)9\\d{2}-?\\d{3}-?\\d{4}$/;\n  const digitsOnly = /^(\\+63|0)?9\\d{9}$/;\n  \n  return phoneRegex.test(phone) || digitsOnly.test(phone);\n}\n\n/**\n * Format currency in Philippine Peso\n */\nexport function formatPeso(amount: number | null | undefined): string {\n  if (amount === null || amount === undefined) return \"Not specified\";\n  \n  return new Intl.NumberFormat('en-PH', {\n    style: 'currency',\n    currency: 'PHP',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  }).format(amount);\n}\n\n/**\n * Format salary range in Philippine Peso\n */\nexport function formatPesoRange(min: number | null, max: number | null): string {\n  if (!min && !max) return \"Not specified\";\n  if (min && max) {\n    return `${formatPeso(min)} - ${formatPeso(max)}`;\n  }\n  if (min) return `From ${formatPeso(min)}`;\n  if (max) return `Up to ${formatPeso(max)}`;\n  return \"Not specified\";\n}\n\n/**\n * Parse date to YYYY-MM format\n */\nexport function formatYearMonth(date: Date | undefined): string {\n  if (!date) return \"\";\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  return `${year}-${month}`;\n}\n\n/**\n * Parse date to YYYY format\n */\nexport function formatYear(date: Date | undefined): string {\n  if (!date) return \"\";\n  return String(date.getFullYear());\n}\n\n/**\n * Parse YYYY-MM string to Date\n */\nexport function parseYearMonth(yearMonth: string): Date | undefined {\n  if (!yearMonth) return undefined;\n  const [year, month] = yearMonth.split('-');\n  if (!year || !month) return undefined;\n  return new Date(parseInt(year), parseInt(month) - 1, 1);\n}\n\n/**\n * Parse YYYY string to Date\n */\nexport function parseYear(year: string): Date | undefined {\n  if (!year) return undefined;\n  const yearNum = parseInt(year);\n  if (isNaN(yearNum)) return undefined;\n  return new Date(yearNum, 0, 1);\n}\n","path":null,"size_bytes":3177,"size_tokens":null},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax',\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(claims: any) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, async (err: any, user: any) => {\n      if (err || !user) {\n        return res.redirect(\"/api/login\");\n      }\n      \n      req.logIn(user, async (loginErr) => {\n        if (loginErr) {\n          return res.redirect(\"/api/login\");\n        }\n        \n        // Check if user needs to complete onboarding (no role set)\n        const dbUser = await storage.getUser(user.claims.sub);\n        if (dbUser && !dbUser.role) {\n          return res.redirect(\"/onboarding\");\n        }\n        \n        // Redirect based on role\n        if (dbUser?.role === \"employer\") {\n          return res.redirect(\"/employer/dashboard\");\n        } else if (dbUser?.role === \"admin\") {\n          return res.redirect(\"/admin/dashboard\");\n        } else {\n          return res.redirect(\"/dashboard\");\n        }\n      });\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","path":null,"size_bytes":5206,"size_tokens":null},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\n\nexport function useAuth() {\n  const { data: user, isLoading, isFetching, error } = useQuery<any>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  return {\n    user,\n    isLoading,\n    isFetching,\n    error,\n    isAuthenticated: !!user,\n    needsOnboarding: user && !user.role,\n  };\n}\n","path":null,"size_bytes":392,"size_tokens":null},"server/sendgrid-client.ts":{"content":"import sgMail from '@sendgrid/mail';\n\nlet connectionSettings: any;\n\nasync function getCredentials() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=sendgrid',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  if (!connectionSettings || (!connectionSettings.settings.api_key || !connectionSettings.settings.from_email)) {\n    throw new Error('SendGrid not connected');\n  }\n  return {apiKey: connectionSettings.settings.api_key, email: connectionSettings.settings.from_email};\n}\n\nexport async function getUncachableSendGridClient() {\n  const {apiKey, email} = await getCredentials();\n  sgMail.setApiKey(apiKey);\n  return {\n    client: sgMail,\n    fromEmail: email\n  };\n}\n","path":null,"size_bytes":1207,"size_tokens":null},"client/src/pages/onboarding.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Briefcase, User } from \"lucide-react\";\n\nexport default function Onboarding() {\n  const [selectedRole, setSelectedRole] = useState<string>(\"\");\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { user, isLoading: authLoading } = useAuth();\n\n  // Redirect if already has role\n  useEffect(() => {\n    if (!authLoading && user && user.role) {\n      if (user.role === \"employer\") {\n        setLocation(\"/employer/dashboard\");\n      } else if (user.role === \"admin\") {\n        setLocation(\"/admin/dashboard\");\n      } else {\n        setLocation(\"/dashboard\");\n      }\n    }\n  }, [authLoading, user, setLocation]);\n\n  const completeMutation = useMutation({\n    mutationFn: async (role: string) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/complete-onboarding\", { role });\n      return await response.json();\n    },\n    onSuccess: async (data) => {\n      // Refetch auth data - the useEffect will handle redirect\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      await queryClient.refetchQueries({ queryKey: [\"/api/auth/user\"] });\n      \n      toast({\n        title: \"Welcome to ZambaJobs!\",\n        description: \"Your account is ready to use.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = () => {\n    if (!selectedRole) {\n      toast({\n        title: \"Role required\",\n        description: \"Please select a role to continue\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    completeMutation.mutate(selectedRole);\n  };\n\n  if (authLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <p>Loading...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader>\n          <CardTitle>Complete Your Profile</CardTitle>\n          <CardDescription>\n            Choose how you'll use ZambaJobs to get started\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <RadioGroup value={selectedRole} onValueChange={setSelectedRole}>\n            <div className=\"space-y-4\">\n              <Label\n                htmlFor=\"job_seeker\"\n                className=\"flex items-start gap-4 p-4 border rounded-lg cursor-pointer hover-elevate active-elevate-2\"\n                data-testid=\"label-role-job-seeker\"\n              >\n                <RadioGroupItem value=\"job_seeker\" id=\"job_seeker\" data-testid=\"radio-job-seeker\" />\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 font-semibold\">\n                    <User className=\"w-5 h-5\" />\n                    <span>Job Seeker</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    Find jobs, apply to positions, and manage your career\n                  </p>\n                </div>\n              </Label>\n\n              <Label\n                htmlFor=\"employer\"\n                className=\"flex items-start gap-4 p-4 border rounded-lg cursor-pointer hover-elevate active-elevate-2\"\n                data-testid=\"label-role-employer\"\n              >\n                <RadioGroupItem value=\"employer\" id=\"employer\" data-testid=\"radio-employer\" />\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 font-semibold\">\n                    <Briefcase className=\"w-5 h-5\" />\n                    <span>Employer</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    Post jobs, find candidates, and grow your team\n                  </p>\n                </div>\n              </Label>\n            </div>\n          </RadioGroup>\n\n          <Button\n            className=\"w-full mt-6\"\n            onClick={handleSubmit}\n            disabled={!selectedRole || completeMutation.isPending}\n            data-testid=\"button-complete-onboarding\"\n          >\n            {completeMutation.isPending ? \"Setting up...\" : \"Continue\"}\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":4889,"size_tokens":null},"server/googleAuth.ts":{"content":"import passport from \"passport\";\nimport { Strategy as GoogleStrategy } from \"passport-google-oauth20\";\nimport type { Express } from \"express\";\nimport { storage } from \"./storage\";\n\nexport async function setupGoogleAuth(app: Express) {\n  const GOOGLE_CLIENT_ID = process.env.GOOGLE_CLIENT_ID;\n  const GOOGLE_CLIENT_SECRET = process.env.GOOGLE_CLIENT_SECRET;\n  // Use custom domain if available, otherwise fall back to Replit domain\n  const APP_URL = process.env.APP_URL || \n    (process.env.REPLIT_DEV_DOMAIN ? `https://${process.env.REPLIT_DEV_DOMAIN}` : \"http://localhost:5000\");\n\n  if (!GOOGLE_CLIENT_ID || !GOOGLE_CLIENT_SECRET) {\n    console.warn(\"⚠️  Google OAuth not configured - GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET required\");\n    return;\n  }\n\n  console.log(\"✅ Google OAuth configured\");\n  console.log(`   Callback URL: ${APP_URL}/api/auth/google/callback`);\n\n  passport.use(\n    new GoogleStrategy(\n      {\n        clientID: GOOGLE_CLIENT_ID,\n        clientSecret: GOOGLE_CLIENT_SECRET,\n        callbackURL: `${APP_URL}/api/auth/google/callback`,\n        scope: [\"profile\", \"email\"],\n        passReqToCallback: false,\n      },\n      async (accessToken, refreshToken, profile, done) => {\n        try {\n          const email = profile.emails?.[0]?.value;\n          if (!email) {\n            return done(new Error(\"No email found in Google profile\"));\n          }\n\n          // Check if user already exists by email\n          const existingUser = await storage.getUserByEmail(email);\n          \n          if (existingUser) {\n            // User exists - allow login\n            return done(null, existingUser);\n          } else {\n            // New user - redirect to signup\n            // Pass error with special code to indicate signup needed\n            const signupError: any = new Error(\"SIGNUP_REQUIRED\");\n            signupError.email = email;\n            signupError.firstName = profile.name?.givenName || profile.displayName || \"\";\n            signupError.lastName = profile.name?.familyName || \"\";\n            signupError.profileImageUrl = profile.photos?.[0]?.value;\n            return done(signupError, false);\n          }\n        } catch (error) {\n          return done(error as Error);\n        }\n      }\n    )\n  );\n\n  // Google OAuth routes\n  app.get(\n    \"/api/auth/google\",\n    (req, res, next) => {\n      const protocol = req.headers['x-forwarded-proto'] || 'https';\n      const host = req.headers['x-forwarded-host'] || req.headers.host;\n      \n      console.log(\"🔐 Google OAuth initiated\");\n      console.log(`   Host header: ${host}`);\n      console.log(`   Using callback URL: ${APP_URL}/api/auth/google/callback`);\n      next();\n    },\n    passport.authenticate(\"google\", { \n      scope: [\"profile\", \"email\"],\n      prompt: \"select_account\" // Force account selection\n    })\n  );\n\n  app.get(\n    \"/api/auth/google/callback\",\n    (req, res, next) => {\n      passport.authenticate(\"google\", (err: any, user: any) => {\n        if (err) {\n          // Check if it's a signup required error\n          if (err.message === \"SIGNUP_REQUIRED\") {\n            // Redirect to signup page with query params\n            const params = new URLSearchParams({\n              email: err.email || \"\",\n              firstName: err.firstName || \"\",\n              lastName: err.lastName || \"\",\n              fromGoogle: \"true\"\n            });\n            return res.redirect(`/register?${params.toString()}`);\n          }\n          // Other errors redirect to login\n          return res.redirect(\"/login?error=auth_failed\");\n        }\n        \n        if (!user) {\n          return res.redirect(\"/login\");\n        }\n        \n        // Log the user in\n        req.logIn(user, (loginErr) => {\n          if (loginErr) {\n            return res.redirect(\"/login\");\n          }\n          \n          // Check if user needs to complete onboarding (no role set)\n          if (!user.role) {\n            return res.redirect(\"/onboarding\");\n          }\n          \n          // Redirect based on role\n          if (user.role === \"employer\") {\n            return res.redirect(\"/employer/dashboard\");\n          } else if (user.role === \"admin\") {\n            return res.redirect(\"/admin/dashboard\");\n          } else {\n            return res.redirect(\"/dashboard\");\n          }\n        });\n      })(req, res, next);\n    }\n  );\n}\n","path":null,"size_bytes":4334,"size_tokens":null},"client/src/pages/applicant-portfolio.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useRoute, Link } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  ArrowLeft, \n  Mail, \n  Phone, \n  MapPin, \n  Globe, \n  Linkedin, \n  Briefcase, \n  GraduationCap, \n  Award,\n  Download,\n  User,\n  FileText\n} from \"lucide-react\";\n\nexport default function ApplicantPortfolio() {\n  const [, params] = useRoute(\"/employer/applicant/:userId\");\n  const userId = params?.userId;\n\n  const { data: applicant, isLoading, isError } = useQuery<any>({\n    queryKey: [\"/api/employer/applicant\", userId],\n    enabled: !!userId,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-10 w-full\" />\n        <Skeleton className=\"h-64 w-full\" />\n        <Skeleton className=\"h-64 w-full\" />\n      </div>\n    );\n  }\n\n  if (isError || !applicant) {\n    return (\n      <div className=\"p-8 text-center\">\n        <p className=\"text-muted-foreground\">Applicant not found</p>\n        <Link href=\"/employer/dashboard\">\n          <Button className=\"mt-4\" data-testid=\"button-back-error\">Back to Dashboard</Button>\n        </Link>\n      </div>\n    );\n  }\n\n  const fullName = `${applicant.firstName} ${applicant.lastName}`;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-4\">\n        <Button variant=\"ghost\" size=\"sm\" onClick={() => window.history.back()} data-testid=\"button-back\">\n          <ArrowLeft className=\"h-4 w-4 mr-2\" />\n          Back\n        </Button>\n      </div>\n\n      {/* Header Card */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"flex flex-col md:flex-row gap-6\">\n            <Avatar className=\"h-24 w-24\">\n              {applicant.profileImage && (\n                <AvatarImage \n                  src={`/objects${applicant.profileImage}`}\n                  alt={fullName}\n                />\n              )}\n              <AvatarFallback>\n                <User className=\"h-12 w-12\" />\n              </AvatarFallback>\n            </Avatar>\n            \n            <div className=\"flex-1\">\n              <h1 className=\"text-3xl font-bold mb-2\" data-testid=\"text-applicant-name\">{fullName}</h1>\n              {applicant.headline && (\n                <p className=\"text-lg text-muted-foreground mb-4\">{applicant.headline}</p>\n              )}\n              \n              <div className=\"grid gap-3 md:grid-cols-2 lg:grid-cols-3\">\n                {applicant.location && (\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                    <span>{applicant.location}</span>\n                  </div>\n                )}\n                {applicant.email && (\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Mail className=\"h-4 w-4 text-muted-foreground\" />\n                    <a href={`mailto:${applicant.email}`} className=\"text-primary hover:underline\">\n                      {applicant.email}\n                    </a>\n                  </div>\n                )}\n                {applicant.phoneNumber && (\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Phone className=\"h-4 w-4 text-muted-foreground\" />\n                    <span>{applicant.phoneNumber}</span>\n                  </div>\n                )}\n                {applicant.linkedinUrl && (\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Linkedin className=\"h-4 w-4 text-muted-foreground\" />\n                    <a \n                      href={applicant.linkedinUrl} \n                      target=\"_blank\" \n                      rel=\"noopener noreferrer\"\n                      className=\"text-primary hover:underline\"\n                    >\n                      LinkedIn Profile\n                    </a>\n                  </div>\n                )}\n                {applicant.portfolioUrl && (\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Globe className=\"h-4 w-4 text-muted-foreground\" />\n                    <a \n                      href={applicant.portfolioUrl} \n                      target=\"_blank\" \n                      rel=\"noopener noreferrer\"\n                      className=\"text-primary hover:underline\"\n                    >\n                      Portfolio Website\n                    </a>\n                  </div>\n                )}\n                {applicant.resumeUrl && (\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                    <a \n                      href={`/objects${applicant.resumeUrl}`} \n                      target=\"_blank\" \n                      rel=\"noopener noreferrer\"\n                      className=\"text-primary hover:underline\"\n                      data-testid=\"link-resume\"\n                    >\n                      <Download className=\"h-3 w-3 inline mr-1\" />\n                      View Resume\n                    </a>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Bio */}\n      {applicant.bio && (\n        <Card>\n          <CardHeader>\n            <CardTitle>About</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground whitespace-pre-wrap\">{applicant.bio}</p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Skills */}\n      {applicant.skills && applicant.skills.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Skills</CardTitle>\n            <CardDescription>Professional expertise and capabilities</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-wrap gap-2\">\n              {applicant.skills.map((skill: string, idx: number) => (\n                <Badge key={idx} variant=\"secondary\">{skill}</Badge>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Work Experience */}\n      {applicant.workExperience && applicant.workExperience.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Briefcase className=\"h-5 w-5\" />\n              Work Experience\n            </CardTitle>\n            <CardDescription>Professional work history</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-6\">\n              {applicant.workExperience.map((exp: any, idx: number) => (\n                <div key={exp.id || idx} data-testid={`work-experience-${idx}`}>\n                  {idx > 0 && <Separator className=\"my-6\" />}\n                  <div>\n                    <h3 className=\"font-semibold text-lg\">{exp.jobTitle}</h3>\n                    <p className=\"text-muted-foreground\">{exp.companyName}</p>\n                    <p className=\"text-sm text-muted-foreground mt-1\">\n                      {new Date(exp.startDate).toLocaleDateString('en-US', { \n                        month: 'short', \n                        year: 'numeric' \n                      })} - {exp.endDate \n                        ? new Date(exp.endDate).toLocaleDateString('en-US', { \n                            month: 'short', \n                            year: 'numeric' \n                          })\n                        : 'Present'}\n                    </p>\n                    {exp.description && (\n                      <p className=\"mt-3 text-sm text-muted-foreground whitespace-pre-wrap\">\n                        {exp.description}\n                      </p>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Education */}\n      {applicant.education && applicant.education.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <GraduationCap className=\"h-5 w-5\" />\n              Education\n            </CardTitle>\n            <CardDescription>Academic background</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-6\">\n              {applicant.education.map((edu: any, idx: number) => (\n                <div key={edu.id || idx} data-testid={`education-${idx}`}>\n                  {idx > 0 && <Separator className=\"my-6\" />}\n                  <div>\n                    <h3 className=\"font-semibold text-lg\">{edu.degree}</h3>\n                    <p className=\"text-muted-foreground\">{edu.institution}</p>\n                    {edu.fieldOfStudy && (\n                      <p className=\"text-sm text-muted-foreground\">Field of Study: {edu.fieldOfStudy}</p>\n                    )}\n                    <p className=\"text-sm text-muted-foreground mt-1\">\n                      {new Date(edu.startDate).toLocaleDateString('en-US', { \n                        month: 'short', \n                        year: 'numeric' \n                      })} - {edu.endDate \n                        ? new Date(edu.endDate).toLocaleDateString('en-US', { \n                            month: 'short', \n                            year: 'numeric' \n                          })\n                        : 'Present'}\n                    </p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Certifications */}\n      {applicant.certifications && applicant.certifications.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Award className=\"h-5 w-5\" />\n              Certifications\n            </CardTitle>\n            <CardDescription>Professional certifications and licenses</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {applicant.certifications.map((cert: any, idx: number) => (\n                <div \n                  key={cert.id || idx} \n                  className=\"flex items-start justify-between p-4 rounded-md border\"\n                  data-testid={`certification-${idx}`}\n                >\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-semibold\">{cert.name}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{cert.issuingOrganization}</p>\n                    <p className=\"text-sm text-muted-foreground mt-1\">\n                      Issued: {new Date(cert.issueDate).toLocaleDateString('en-US', { \n                        month: 'short', \n                        year: 'numeric' \n                      })}\n                      {cert.expiryDate && (\n                        <> • Expires: {new Date(cert.expiryDate).toLocaleDateString('en-US', { \n                          month: 'short', \n                          year: 'numeric' \n                        })}</>\n                      )}\n                    </p>\n                    {cert.credentialUrl && (\n                      <a \n                        href={cert.credentialUrl} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"text-sm text-primary hover:underline mt-2 inline-block\"\n                      >\n                        View Credential\n                      </a>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":11988,"size_tokens":null},"client/src/pages/employer-analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Download, Briefcase, FileText, TrendingUp, Target } from \"lucide-react\";\nimport {\n  LineChart,\n  Line,\n  BarChart,\n  Bar,\n  PieChart,\n  Pie,\n  Cell,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer\n} from \"recharts\";\n\nexport default function EmployerAnalytics() {\n  const { data: analytics, isLoading } = useQuery<any>({\n    queryKey: [\"/api/analytics/employer\"],\n  });\n\n  const exportToCSV = () => {\n    if (!analytics) return;\n\n    const csvData: string[] = [];\n    \n    csvData.push(\"Employer Analytics Report\");\n    csvData.push(\"\");\n    csvData.push(\"Overview\");\n    csvData.push(\"Metric,Value\");\n    csvData.push(`Total Jobs Posted,${analytics.overview.totalJobs}`);\n    csvData.push(`Active Jobs,${analytics.overview.activeJobs}`);\n    csvData.push(`Total Applications,${analytics.overview.totalApplications}`);\n    csvData.push(`Average Match Score,${analytics.overview.avgMatchScore}%`);\n    csvData.push(\"\");\n\n    csvData.push(\"Applications by Job\");\n    csvData.push(\"Job Title,Applications,Avg Match Score\");\n    analytics.breakdown.applicationsByJob.forEach((item: any) => {\n      csvData.push(`${item.jobTitle},${item.count},${item.avgMatchScore}%`);\n    });\n    csvData.push(\"\");\n\n    csvData.push(\"Application Status\");\n    csvData.push(\"Status,Count\");\n    Object.entries(analytics.breakdown.applicationsByStatus).forEach(([status, count]) => {\n      csvData.push(`${status},${count}`);\n    });\n    csvData.push(\"\");\n\n    const blob = new Blob([csvData.join('\\n')], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `employer-analytics-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <TrendingUp className=\"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-pulse\" />\n          <p className=\"text-muted-foreground\">Loading analytics...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!analytics) {\n    return (\n      <div className=\"min-h-screen bg-background p-8\">\n        <p className=\"text-center text-muted-foreground\">No analytics data available</p>\n      </div>\n    );\n  }\n\n  const COLORS = ['hsl(var(--chart-1))', 'hsl(var(--chart-2))', 'hsl(var(--chart-3))', 'hsl(var(--chart-4))', 'hsl(var(--chart-5))'];\n\n  const applicationStatusData = Object.entries(analytics.breakdown.applicationsByStatus).map(([name, value]) => ({\n    name: name.charAt(0).toUpperCase() + name.slice(1),\n    value: value as number\n  }));\n\n  const matchScoreData = Object.entries(analytics.breakdown.matchScoreRanges).map(([name, value]) => ({\n    name,\n    value: value as number\n  }));\n\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 lg:p-8\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold mb-2\">Job Performance Analytics</h1>\n            <p className=\"text-muted-foreground\">Track your hiring success</p>\n          </div>\n          <Button onClick={exportToCSV} data-testid=\"button-export-csv\">\n            <Download className=\"mr-2 h-4 w-4\" />\n            Export to CSV\n          </Button>\n        </div>\n\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8\">\n          <Card data-testid=\"card-stat-jobs\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Jobs Posted</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalJobs}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Briefcase className=\"h-3 w-3\" />\n                <span>{analytics.overview.activeJobs} active</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-applications\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Applications</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalApplications}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <FileText className=\"h-3 w-3\" />\n                <span>Across all jobs</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-match-score\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Avg Match Score</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.avgMatchScore}%</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Target className=\"h-3 w-3\" />\n                <span>AI-calculated</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-rate\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Applications per Job</CardDescription>\n              <CardTitle className=\"text-3xl\">\n                {analytics.overview.totalJobs > 0 \n                  ? Math.round(analytics.overview.totalApplications / analytics.overview.totalJobs)\n                  : 0}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <TrendingUp className=\"h-3 w-3\" />\n                <span>Average</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid gap-6 lg:grid-cols-2 mb-8\">\n          <Card data-testid=\"card-application-trend\" className=\"lg:col-span-2\">\n            <CardHeader>\n              <CardTitle>Applications Received</CardTitle>\n              <CardDescription>Last 30 days</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={analytics.trends.applications}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis dataKey=\"date\" className=\"text-xs\" tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} />\n                  <YAxis className=\"text-xs\" />\n                  <Tooltip labelFormatter={(value) => new Date(value).toLocaleDateString()} />\n                  <Line type=\"monotone\" dataKey=\"count\" stroke=\"hsl(var(--primary))\" strokeWidth={2} name=\"Applications\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-applications-by-status\">\n            <CardHeader>\n              <CardTitle>Application Status</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <PieChart>\n                  <Pie data={applicationStatusData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={90} fill=\"#8884d8\" dataKey=\"value\">\n                    {applicationStatusData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-match-score-distribution\">\n            <CardHeader>\n              <CardTitle>Match Score Distribution</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <PieChart>\n                  <Pie data={matchScoreData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={90} fill=\"#8884d8\" dataKey=\"value\">\n                    {matchScoreData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card data-testid=\"card-top-jobs\">\n          <CardHeader>\n            <CardTitle>Top Performing Jobs</CardTitle>\n            <CardDescription>Jobs with most applications</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={400}>\n              <BarChart data={analytics.breakdown.applicationsByJob}>\n                <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                <XAxis dataKey=\"jobTitle\" className=\"text-xs\" angle={-45} textAnchor=\"end\" height={100} />\n                <YAxis className=\"text-xs\" />\n                <Tooltip />\n                <Legend />\n                <Bar dataKey=\"count\" fill=\"hsl(var(--primary))\" name=\"Applications\" />\n                <Bar dataKey=\"avgMatchScore\" fill=\"hsl(var(--chart-2))\" name=\"Avg Match Score (%)\" />\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9882,"size_tokens":null},"client/src/pages/job-seeker-analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Download, FileText, TrendingUp, Target, BarChart3 } from \"lucide-react\";\nimport {\n  LineChart,\n  Line,\n  PieChart,\n  Pie,\n  Cell,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer\n} from \"recharts\";\n\nexport default function JobSeekerAnalytics() {\n  const { data: analytics, isLoading } = useQuery<any>({\n    queryKey: [\"/api/analytics/job-seeker\"],\n  });\n\n  const exportToCSV = () => {\n    if (!analytics) return;\n\n    const csvData: string[] = [];\n    \n    csvData.push(\"Job Seeker Analytics Report\");\n    csvData.push(\"\");\n    csvData.push(\"Overview\");\n    csvData.push(\"Metric,Value\");\n    csvData.push(`Total Applications,${analytics.overview.totalApplications}`);\n    csvData.push(`Average Match Score,${analytics.overview.avgMatchScore}%`);\n    csvData.push(`Response Rate,${analytics.overview.responseRate}%`);\n    csvData.push(\"\");\n\n    csvData.push(\"Application Status\");\n    csvData.push(\"Status,Count\");\n    Object.entries(analytics.breakdown.applicationsByStatus).forEach(([status, count]) => {\n      csvData.push(`${status},${count}`);\n    });\n    csvData.push(\"\");\n\n    csvData.push(\"Top Applications\");\n    csvData.push(\"Job Title,Company,Match Score,Status,Applied At\");\n    analytics.breakdown.topApplications.forEach((app: any) => {\n      csvData.push(`${app.jobTitle},${app.company},${app.matchScore}%,${app.status},${new Date(app.appliedAt).toLocaleDateString()}`);\n    });\n    csvData.push(\"\");\n\n    const blob = new Blob([csvData.join('\\n')], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `job-seeker-analytics-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <BarChart3 className=\"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-pulse\" />\n          <p className=\"text-muted-foreground\">Loading analytics...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!analytics) {\n    return (\n      <div className=\"min-h-screen bg-background p-8\">\n        <p className=\"text-center text-muted-foreground\">No analytics data available</p>\n      </div>\n    );\n  }\n\n  const COLORS = ['hsl(var(--chart-1))', 'hsl(var(--chart-2))', 'hsl(var(--chart-3))', 'hsl(var(--chart-4))', 'hsl(var(--chart-5))'];\n\n  const applicationStatusData = Object.entries(analytics.breakdown.applicationsByStatus).map(([name, value]) => ({\n    name: name.charAt(0).toUpperCase() + name.slice(1),\n    value: value as number\n  }));\n\n  const matchScoreData = Object.entries(analytics.breakdown.matchScoreRanges).map(([name, value]) => ({\n    name,\n    value: value as number\n  }));\n\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 lg:p-8\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold mb-2\">Application Analytics</h1>\n            <p className=\"text-muted-foreground\">Track your job search progress</p>\n          </div>\n          <Button onClick={exportToCSV} data-testid=\"button-export-csv\">\n            <Download className=\"mr-2 h-4 w-4\" />\n            Export to CSV\n          </Button>\n        </div>\n\n        <div className=\"grid gap-4 md:grid-cols-3 mb-8\">\n          <Card data-testid=\"card-stat-applications\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Total Applications</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.totalApplications}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <FileText className=\"h-3 w-3\" />\n                <span>Submitted</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-match-score\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Avg Match Score</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.avgMatchScore}%</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Target className=\"h-3 w-3\" />\n                <span>AI-calculated</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-stat-response-rate\">\n            <CardHeader className=\"pb-3\">\n              <CardDescription>Response Rate</CardDescription>\n              <CardTitle className=\"text-3xl\">{analytics.overview.responseRate}%</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <TrendingUp className=\"h-3 w-3\" />\n                <span>Reviewed/Responded</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid gap-6 lg:grid-cols-2 mb-8\">\n          <Card data-testid=\"card-application-trend\" className=\"lg:col-span-2\">\n            <CardHeader>\n              <CardTitle>Applications Sent</CardTitle>\n              <CardDescription>Last 30 days</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={analytics.trends.applications}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                  <XAxis dataKey=\"date\" className=\"text-xs\" tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} />\n                  <YAxis className=\"text-xs\" />\n                  <Tooltip labelFormatter={(value) => new Date(value).toLocaleDateString()} />\n                  <Line type=\"monotone\" dataKey=\"count\" stroke=\"hsl(var(--primary))\" strokeWidth={2} name=\"Applications\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-applications-by-status\">\n            <CardHeader>\n              <CardTitle>Application Status</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <PieChart>\n                  <Pie data={applicationStatusData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={90} fill=\"#8884d8\" dataKey=\"value\">\n                    {applicationStatusData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-match-score-distribution\">\n            <CardHeader>\n              <CardTitle>Match Score Distribution</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <PieChart>\n                  <Pie data={matchScoreData} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`} outerRadius={90} fill=\"#8884d8\" dataKey=\"value\">\n                    {matchScoreData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card data-testid=\"card-top-applications\">\n          <CardHeader>\n            <CardTitle>Your Best Matches</CardTitle>\n            <CardDescription>Top 10 applications by match score</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {analytics.breakdown.topApplications.map((app: any, index: number) => (\n                <div key={index} className=\"flex items-center justify-between p-4 border rounded-md hover-elevate\" data-testid={`application-${index}`}>\n                  <div className=\"flex-1\">\n                    <h4 className=\"font-semibold\">{app.jobTitle}</h4>\n                    <p className=\"text-sm text-muted-foreground\">{app.company}</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Applied {new Date(app.appliedAt).toLocaleDateString()}\n                    </p>\n                  </div>\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"text-center\">\n                      <div className=\"text-2xl font-bold text-primary\">{app.matchScore}%</div>\n                      <div className=\"text-xs text-muted-foreground\">Match</div>\n                    </div>\n                    <Badge variant={\n                      app.status === 'accepted' ? 'default' : \n                      app.status === 'rejected' ? 'destructive' : \n                      'secondary'\n                    }>\n                      {app.status.charAt(0).toUpperCase() + app.status.slice(1)}\n                    </Badge>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9917,"size_tokens":null},"ARCHITECTURE.md":{"content":"# ZambaJobs System Architecture\n\n## System Block Diagram\n\n```mermaid\ngraph TB\n    subgraph \"Client Layer\"\n        A[Web Browser<br/>React + TypeScript + Vite]\n    end\n    \n    subgraph \"Frontend Components\"\n        A --> B[Authentication Pages<br/>Login, Register, OTP]\n        A --> C[Job Seeker Dashboard<br/>Profile, Applications, Recommendations]\n        A --> D[Employer Dashboard<br/>Job Posting, Applicant Management]\n        A --> E[Admin Dashboard<br/>User/Job/Fraud Management]\n    end\n    \n    subgraph \"Backend Layer - Express.js API\"\n        B --> F[Auth Routes<br/>/api/auth/*]\n        C --> G[Profile Routes<br/>/api/profile]\n        C --> H[Jobs Routes<br/>/api/jobs]\n        D --> I[Employer Routes<br/>/api/employer/*]\n        E --> J[Admin Routes<br/>/api/admin/*]\n        \n        F --> K[Session Middleware<br/>Passport.js]\n        G --> K\n        H --> K\n        I --> K\n        J --> K\n    end\n    \n    subgraph \"Authentication Services\"\n        K --> L[Email/Password Auth<br/>Bcrypt + JWT]\n        K --> M[Google OAuth 2.0<br/>passport-google-oauth20]\n        K --> N[OTP Verification<br/>10-min expiry]\n    end\n    \n    subgraph \"Data Layer\"\n        F --> O[Storage Interface<br/>IStorage]\n        G --> O\n        H --> O\n        I --> O\n        J --> O\n        \n        O --> P[(PostgreSQL Database<br/>Neon Serverless)]\n        \n        subgraph \"Database Schema\"\n            P --> P1[Users Table<br/>role-based access]\n            P --> P2[JobSeekerProfiles]\n            P --> P3[EmployerProfiles]\n            P --> P4[Jobs Table]\n            P --> P5[Applications]\n            P --> P6[FraudAlerts]\n            P --> P7[WorkExperience]\n            P --> P8[Education]\n            P --> P9[Certifications]\n            P --> P10[Sessions]\n        end\n    end\n    \n    subgraph \"AI Services\"\n        O --> Q[OpenAI GPT-5 API]\n        Q --> Q1[Fraud Detection<br/>Profile & Job Analysis]\n        Q --> Q2[Smart Job Matching<br/>Candidate Scoring]\n    end\n    \n    subgraph \"File Storage\"\n        G --> R[Google Cloud Storage]\n        R --> R1[Profile Pictures<br/>Public Access]\n        R --> R2[Resume/CV Files<br/>Private Access]\n    end\n    \n    subgraph \"Email Services\"\n        F --> S[Resend Email API]\n        S --> S1[OTP Verification Emails]\n        S --> S2[Password Reset Links]\n        S --> S3[Application Notifications]\n        S --> S4[Fraud Alert Notifications]\n    end\n    \n    subgraph \"External Authentication\"\n        M --> T[Google OAuth Provider<br/>Google Cloud Console]\n    end\n    \n    style A fill:#3b82f6,color:#fff\n    style P fill:#10b981,color:#fff\n    style Q fill:#8b5cf6,color:#fff\n    style R fill:#f59e0b,color:#fff\n    style S fill:#ef4444,color:#fff\n    style T fill:#06b6d4,color:#fff\n```\n\n## Data Flow Diagrams\n\n### 1. User Registration & Authentication Flow\n\n```mermaid\nsequenceDiagram\n    participant U as User\n    participant FE as Frontend\n    participant BE as Backend API\n    participant DB as PostgreSQL\n    participant Email as Resend\n    participant Google as Google OAuth\n    \n    alt Email/Password Registration\n        U->>FE: Enter email, password, role\n        FE->>BE: POST /api/auth/register\n        BE->>DB: Create user (unverified)\n        BE->>Email: Send OTP code\n        Email->>U: Verification email\n        U->>FE: Enter OTP\n        FE->>BE: POST /api/auth/verify-otp\n        BE->>DB: Mark user as verified\n        BE->>FE: Success + Session\n        FE->>U: Redirect to onboarding/dashboard\n    else Google OAuth\n        U->>FE: Click \"Continue with Google\"\n        FE->>BE: GET /api/auth/google\n        BE->>Google: OAuth request\n        Google->>U: Account selection\n        U->>Google: Select account\n        Google->>BE: OAuth callback with profile\n        alt New User\n            BE->>FE: Redirect to /register?email=...\n            U->>FE: Complete registration\n            FE->>BE: POST /api/auth/register\n            BE->>DB: Create user\n        else Existing User\n            BE->>DB: Find user by email\n            BE->>FE: Create session + redirect\n        end\n    end\n```\n\n### 2. Job Application Flow\n\n```mermaid\nsequenceDiagram\n    participant JS as Job Seeker\n    participant FE as Frontend\n    participant BE as Backend API\n    participant DB as PostgreSQL\n    participant AI as OpenAI API\n    participant Email as Resend\n    participant Emp as Employer\n    \n    JS->>FE: Browse jobs\n    FE->>BE: GET /api/jobs\n    BE->>DB: Fetch active jobs\n    DB->>BE: Jobs list\n    BE->>FE: Jobs data\n    FE->>JS: Display jobs\n    \n    JS->>FE: Apply to job\n    FE->>BE: POST /api/applications\n    BE->>DB: Create application\n    BE->>Email: Notify employer\n    Email->>Emp: New application email\n    BE->>FE: Success\n    FE->>JS: Application submitted\n```\n\n### 3. AI Fraud Detection Flow\n\n```mermaid\nsequenceDiagram\n    participant User as User/Employer\n    participant FE as Frontend\n    participant BE as Backend API\n    participant AI as OpenAI GPT-5\n    participant DB as PostgreSQL\n    participant Email as Resend\n    participant Admin as Admin\n    \n    User->>FE: Create profile/job posting\n    FE->>BE: POST /api/profile or /api/jobs\n    BE->>AI: Analyze for fraud patterns\n    AI->>BE: Fraud analysis result\n    alt Suspicious Activity Detected\n        BE->>DB: Create fraud alert\n        BE->>Email: Send fraud alert to admin\n        Email->>Admin: Fraud notification email\n        BE->>DB: Save user/job data\n        BE->>FE: Success (user unaware)\n    else No Fraud Detected\n        BE->>DB: Save user/job data\n        BE->>FE: Success\n    end\n```\n\n### 4. AI Job Matching Flow\n\n```mermaid\nsequenceDiagram\n    participant JS as Job Seeker\n    participant FE as Frontend\n    participant BE as Backend API\n    participant DB as PostgreSQL\n    participant AI as OpenAI GPT-5\n    \n    JS->>FE: View job recommendations\n    FE->>BE: GET /api/recommendations\n    BE->>DB: Fetch job seeker profile\n    BE->>DB: Fetch active jobs\n    BE->>AI: Calculate job matches\n    Note over AI: Analyzes: Skills, Experience,<br/>Education, Location,<br/>Certifications\n    AI->>BE: Ranked job matches with scores\n    BE->>FE: Recommended jobs\n    FE->>JS: Display matches with reasoning\n```\n\n## Technology Stack\n\n### Frontend\n- **Framework**: React 18 with TypeScript\n- **Build Tool**: Vite\n- **Routing**: Wouter\n- **State Management**: TanStack Query (React Query v5)\n- **Forms**: React Hook Form + Zod validation\n- **UI Components**: Shadcn/ui + Radix UI primitives\n- **Styling**: Tailwind CSS\n- **Icons**: Lucide React\n\n### Backend\n- **Runtime**: Node.js 20\n- **Framework**: Express.js\n- **Language**: TypeScript\n- **ORM**: Drizzle ORM\n- **Authentication**: Passport.js (Local + Google OAuth)\n- **Session**: express-session with PostgreSQL store\n- **Password Hashing**: Bcrypt\n- **Tokens**: JWT\n\n### Database\n- **Database**: PostgreSQL (Neon Serverless)\n- **Schema Management**: Drizzle Kit\n\n### External Services\n- **AI**: OpenAI GPT-5 API\n- **Storage**: Google Cloud Storage\n- **Email**: Resend API\n- **OAuth**: Google OAuth 2.0\n\n### DevOps\n- **Hosting**: Replit\n- **Domain**: zambajobs.digital\n- **Environment**: Development & Production\n\n## Security Features\n\n1. **Authentication**\n   - Multi-factor with OTP (10-min expiry, 5-attempt lockout)\n   - Password hashing with Bcrypt\n   - JWT tokens for stateless auth\n   - Session management with PostgreSQL\n   - Rate limiting on auth endpoints\n\n2. **Authorization**\n   - Role-based access control (job_seeker, employer, admin)\n   - Route-level middleware protection\n   - Resource ownership validation\n\n3. **Data Protection**\n   - SQL injection prevention (parameterized queries)\n   - XSS protection\n   - CORS configuration\n   - Secure file uploads with validation\n   - Private file access control\n\n4. **AI-Powered Fraud Detection**\n   - Automated profile analysis\n   - Job posting validation\n   - Confidence scoring system\n   - Admin notification system\n\n## Key Features\n\n### For Job Seekers\n- Profile management with work experience, education, certifications\n- Resume/CV upload\n- AI-powered job recommendations\n- Application tracking\n- Personal analytics dashboard\n\n### For Employers\n- Job posting management\n- Applicant portfolio viewer\n- Application filtering\n- Job performance analytics\n\n### For Admins\n- User management (view, delete, create admins)\n- Job management (view, flag, delete)\n- Fraud alert monitoring with detailed views\n- Platform-wide analytics\n- CSV export functionality\n\n## Deployment Architecture\n\n```mermaid\ngraph LR\n    A[zambajobs.digital] --> B[Replit Production]\n    B --> C[Express Server :5000]\n    C --> D[Vite Frontend]\n    C --> E[API Routes]\n    E --> F[(Neon PostgreSQL)]\n    E --> G[Google Cloud Storage]\n    E --> H[OpenAI API]\n    E --> I[Resend Email]\n    E --> J[Google OAuth]\n    \n    style A fill:#3b82f6,color:#fff\n    style F fill:#10b981,color:#fff\n    style G fill:#f59e0b,color:#fff\n    style H fill:#8b5cf6,color:#fff\n    style I fill:#ef4444,color:#fff\n    style J fill:#06b6d4,color:#fff\n```\n\n---\n\n**Last Updated**: November 19, 2025\n","path":null,"size_bytes":9019,"size_tokens":null},"BLOCK_DIAGRAM.md":{"content":"# ZambaJobs System Architecture - Block Diagram\n\n![ZambaJobs Architecture Diagram](attached_assets/generated_images/ZambaJobs_system_architecture_diagram_4aa08144.png)\n\n---\n\n## Architecture Overview\n\n```\n┌─────────────────────────────────────────────────────────────────┐\n│                   User Interface (Browser)                       │\n│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │\n│  │   👤 Job     │  │   🏢 Employer │  │   🛡️ Admin   │          │\n│  │    Seeker    │  │    Portal     │  │    Panel     │          │\n│  │   Dashboard  │  │               │  │              │          │\n│  │              │  │               │  │              │          │\n│  │ • Profile    │  │ • Post Jobs   │  │ • User Mgmt  │          │\n│  │ • Job Search │  │ • Applicants  │  │ • Job Mgmt   │          │\n│  │ • Apply      │  │ • Analytics   │  │ • Fraud Det  │          │\n│  │ • Analytics  │  │               │  │ • Analytics  │          │\n│  └──────────────┘  └──────────────┘  └──────────────┘          │\n└────────────────────────────┬────────────────────────────────────┘\n                             │\n                             ▼\n┌─────────────────────────────────────────────────────────────────┐\n│                    Express.js Web Server                         │\n│                                                                   │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │                  Routes/Controllers                       │  │\n│  │  /api/auth  /api/jobs  /api/profile  /api/employer       │  │\n│  │  /api/applications  /api/admin  /api/recommendations     │  │\n│  └──────────────────────────────────────────────────────────┘  │\n│                             │                                    │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │         Authentication (Passport.js)                      │  │\n│  │  • Email/Password (Bcrypt + JWT)                          │  │\n│  │  • Google OAuth 2.0                                       │  │\n│  │  • OTP Verification (10-min expiry)                       │  │\n│  │  • Session Management (PostgreSQL)                        │  │\n│  └──────────────────────────────────────────────────────────┘  │\n│                             │                                    │\n│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │\n│  │  AI Services │  │ File Storage │  │ Forms/Valid. │         │\n│  │  • Fraud Det │  │ • Profiles   │  │ • Zod Schema │         │\n│  │  • Matching  │  │ • Resumes    │  │ • Validation │         │\n│  └──────────────┘  └──────────────┘  └──────────────┘         │\n└────────────────────────────┬────────────────────────────────────┘\n                             │\n                             ▼\n┌─────────────────────────────────────────────────────────────────┐\n│                    PostgreSQL Database                           │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │                     Core Tables                           │  │\n│  │                                                            │  │\n│  │  • Users                    • Sessions                    │  │\n│  │    - id, email, password    - sid, sess, expire           │  │\n│  │    - role, verified         - user_id                     │  │\n│  │                                                            │  │\n│  │  • JobSeekerProfiles        • EmployerProfiles            │  │\n│  │    - userId, headline       - userId, companyName         │  │\n│  │    - bio, skills, location  - description, industry       │  │\n│  │                                                            │  │\n│  │  • Jobs                     • Applications                │  │\n│  │    - employerId, title      - jobId, jobSeekerId          │  │\n│  │    - description, salary    - status, coverLetter         │  │\n│  │                                                            │  │\n│  │  • WorkExperience           • Education                   │  │\n│  │  • Certifications           • FraudAlerts                 │  │\n│  └──────────────────────────────────────────────────────────┘  │\n└─────────────────────────────────────────────────────────────────┘\n                             │\n                             │\n┌─────────────────────────────────────────────────────────────────┐\n│                      External Services                           │\n│                                                                   │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │  🌐 OpenAI GPT-5 API                                      │  │\n│  │     • Fraud Detection Analysis                            │  │\n│  │     • Smart Job Matching (0-100 score)                    │  │\n│  │     • Candidate Recommendations                           │  │\n│  └──────────────────────────────────────────────────────────┘  │\n│                                                                   │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │  ☁️ Google Cloud Storage (GCS)                            │  │\n│  │     • Profile Pictures (Public)                           │  │\n│  │     • Resume/CV Files (Private)                           │  │\n│  │     • ACL-based Access Control                            │  │\n│  └──────────────────────────────────────────────────────────┘  │\n│                                                                   │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │  📧 Resend Email API                                      │  │\n│  │     • OTP Verification Codes                              │  │\n│  │     • Password Reset Links                                │  │\n│  │     • Application Notifications                           │  │\n│  │     • Fraud Alert Emails                                  │  │\n│  └──────────────────────────────────────────────────────────┘  │\n│                                                                   │\n│  ┌──────────────────────────────────────────────────────────┐  │\n│  │  🔐 Google OAuth 2.0                                      │  │\n│  │     • Account Selection                                   │  │\n│  │     • Profile Information                                 │  │\n│  │     • Secure Authentication                               │  │\n│  └──────────────────────────────────────────────────────────┘  │\n└─────────────────────────────────────────────────────────────────┘\n```\n\n## Component Details\n\n### User Interface Layer\n**Technology**: React 18 + TypeScript, Vite, TanStack Query, Shadcn UI\n\n1. **Job Seeker Dashboard**\n   - Profile management (work experience, education, certifications)\n   - Job search and filtering\n   - AI-powered job recommendations\n   - Application tracking\n   - Personal analytics\n\n2. **Employer Portal**\n   - Job posting creation and management\n   - Applicant portfolio viewer\n   - Application filtering and sorting\n   - Job performance analytics\n   - CSV export\n\n3. **Admin Panel**\n   - User management (view, delete, create admins)\n   - Job management (view, flag, delete)\n   - Fraud alert monitoring\n   - Platform-wide analytics\n   - System oversight\n\n### Backend Layer\n**Technology**: Express.js, TypeScript, Passport.js, Drizzle ORM\n\n**Routes/Controllers**\n- `/api/auth/*` - Authentication and authorization\n- `/api/jobs` - Job listings and search\n- `/api/profile` - Profile management\n- `/api/employer/*` - Employer operations\n- `/api/applications` - Job applications\n- `/api/admin/*` - Administrative functions\n- `/api/recommendations` - AI job matching\n\n**Authentication (Passport.js)**\n- Email/Password with Bcrypt hashing\n- JWT token generation\n- Google OAuth 2.0 integration\n- OTP verification (10-minute expiry, 5-attempt lockout)\n- Session management with PostgreSQL store\n\n**Additional Services**\n- AI fraud detection and job matching\n- File upload and storage management\n- Form validation with Zod schemas\n\n### Database Layer\n**Technology**: PostgreSQL (Neon Serverless), Drizzle ORM\n\n**Core Tables**\n- `users` - User accounts with role-based access\n- `job_seeker_profiles` - Job seeker information\n- `employer_profiles` - Employer company details\n- `jobs` - Job postings\n- `applications` - Job applications\n- `work_experience` - Employment history\n- `education` - Educational background\n- `certifications` - Professional certifications\n- `fraud_alerts` - AI-detected suspicious activity\n- `sessions` - User session management\n\n### External Services\n\n**OpenAI GPT-5 API**\n- Analyzes user profiles for fraudulent patterns\n- Validates job postings for scams\n- Provides intelligent job-to-candidate matching\n- Generates match scores (0-100) with reasoning\n\n**Google Cloud Storage**\n- Stores profile pictures (public access)\n- Stores resume/CV files (private, owner-only access)\n- Implements ACL-based permissions\n- Integrated with Replit sidecar\n\n**Resend Email API**\n- Sends OTP verification codes\n- Delivers password reset links\n- Notifies employers of new applications\n- Alerts admins of fraud detection\n\n**Google OAuth 2.0**\n- Enables \"Continue with Google\" login\n- Provides secure authentication\n- Auto-fills registration forms for new users\n- Seamless account linking\n\n## Data Flow\n\n1. **User Request** → Browser sends request to Express.js server\n2. **Authentication** → Passport.js validates session/token\n3. **Authorization** → Route middleware checks user role and permissions\n4. **Business Logic** → Controllers process request\n5. **Database Operations** → Drizzle ORM queries PostgreSQL\n6. **External Services** → AI analysis, file storage, email sending\n7. **Response** → JSON data returned to browser\n8. **UI Update** → React components re-render with new data\n\n## Security Layers\n\n- **Input Validation**: Zod schemas on all forms\n- **SQL Injection Protection**: Parameterized queries via Drizzle ORM\n- **Authentication**: Multi-factor with OTP + session management\n- **Authorization**: Role-based access control (RBAC)\n- **File Security**: Type validation, size limits, private access\n- **AI Monitoring**: Automated fraud detection on profiles and jobs\n- **Rate Limiting**: Protection against brute force attacks\n\n---\n\n**Domain**: zambajobs.digital  \n**Hosting**: Replit  \n**Last Updated**: November 19, 2025\n","path":null,"size_bytes":14122,"size_tokens":null},"client/src/pages/job-seeker-contact.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Mail, Send, CheckCircle } from \"lucide-react\";\nimport { useAuth } from \"@/contexts/auth-context\";\n\nconst contactSchema = z.object({\n  subject: z.string().min(5, \"Subject must be at least 5 characters\"),\n  message: z.string().min(20, \"Message must be at least 20 characters\"),\n  priority: z.enum([\"low\", \"normal\", \"high\", \"urgent\"]),\n});\n\ntype ContactForm = z.infer<typeof contactSchema>;\n\nexport default function JobSeekerContact() {\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const [submitted, setSubmitted] = useState(false);\n\n  const form = useForm<ContactForm>({\n    resolver: zodResolver(contactSchema),\n    defaultValues: {\n      subject: \"\",\n      message: \"\",\n      priority: \"normal\",\n    },\n  });\n\n  const contactMutation = useMutation({\n    mutationFn: async (data: ContactForm) => {\n      const fullName = user?.firstName && user?.lastName \n        ? `${user.firstName} ${user.lastName}` \n        : user?.firstName || user?.lastName || \"Unknown\";\n      \n      return await apiRequest(\"POST\", \"/api/contact\", {\n        userId: user?.id,\n        name: fullName,\n        email: user?.email || \"\",\n        subject: data.subject,\n        message: data.message,\n        priority: data.priority,\n      });\n    },\n    onSuccess: () => {\n      toast({ \n        title: \"Message sent successfully!\", \n        description: \"Our support team will get back to you soon.\" \n      });\n      form.reset();\n      setSubmitted(true);\n      setTimeout(() => setSubmitted(false), 5000);\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error sending message\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const handleSubmit = (data: ContactForm) => {\n    contactMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"container max-w-4xl mx-auto p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Contact Support</h1>\n        <p className=\"text-muted-foreground\">\n          Have a question or need assistance? Send us a message and our support team will help you.\n        </p>\n      </div>\n\n      {submitted && (\n        <Card className=\"border-green-500 bg-green-50 dark:bg-green-950\">\n          <CardContent className=\"flex items-center gap-3 pt-6\">\n            <CheckCircle className=\"h-6 w-6 text-green-600\" />\n            <div>\n              <p className=\"font-semibold text-green-900 dark:text-green-100\">Message Sent Successfully!</p>\n              <p className=\"text-sm text-green-700 dark:text-green-300\">We'll respond to your inquiry as soon as possible.</p>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Mail className=\"h-5 w-5\" />\n            Send a Message\n          </CardTitle>\n          <CardDescription>\n            Fill out the form below to contact our support team. We typically respond within 24 hours.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"subject\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Subject</FormLabel>\n                    <FormControl>\n                      <Input \n                        {...field} \n                        placeholder=\"Brief description of your inquiry\"\n                        data-testid=\"input-contact-subject\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"priority\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Priority</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-contact-priority\">\n                          <SelectValue placeholder=\"Select priority\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"low\">Low - General inquiry</SelectItem>\n                        <SelectItem value=\"normal\">Normal - Standard support</SelectItem>\n                        <SelectItem value=\"high\">High - Important issue</SelectItem>\n                        <SelectItem value=\"urgent\">Urgent - Critical problem</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"message\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Message</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        {...field} \n                        placeholder=\"Describe your question or issue in detail...\"\n                        rows={8}\n                        data-testid=\"input-contact-message\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"flex justify-end gap-3\">\n                <Button \n                  type=\"button\" \n                  variant=\"outline\" \n                  onClick={() => form.reset()}\n                  disabled={contactMutation.isPending}\n                  data-testid=\"button-reset-contact\"\n                >\n                  Clear\n                </Button>\n                <Button \n                  type=\"submit\" \n                  disabled={contactMutation.isPending}\n                  data-testid=\"button-submit-contact\"\n                >\n                  <Send className=\"h-4 w-4 mr-2\" />\n                  {contactMutation.isPending ? \"Sending...\" : \"Send Message\"}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Other Ways to Reach Us</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-semibold mb-1\">Email</h4>\n            <p className=\"text-sm text-muted-foreground\">support@zambajobs.com</p>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-1\">Response Time</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              We aim to respond to all inquiries within 24 hours during business days.\n              Urgent issues are prioritized and typically receive a response within 4-8 hours.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":7858,"size_tokens":null},"client/src/pages/employer-contact.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Mail, Send, CheckCircle } from \"lucide-react\";\nimport { useAuth } from \"@/contexts/auth-context\";\n\nconst contactSchema = z.object({\n  subject: z.string().min(5, \"Subject must be at least 5 characters\"),\n  message: z.string().min(20, \"Message must be at least 20 characters\"),\n  priority: z.enum([\"low\", \"normal\", \"high\", \"urgent\"]),\n});\n\ntype ContactForm = z.infer<typeof contactSchema>;\n\nexport default function EmployerContact() {\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const [submitted, setSubmitted] = useState(false);\n\n  const form = useForm<ContactForm>({\n    resolver: zodResolver(contactSchema),\n    defaultValues: {\n      subject: \"\",\n      message: \"\",\n      priority: \"normal\",\n    },\n  });\n\n  const contactMutation = useMutation({\n    mutationFn: async (data: ContactForm) => {\n      const fullName = user?.firstName && user?.lastName \n        ? `${user.firstName} ${user.lastName}` \n        : user?.firstName || user?.lastName || \"Unknown\";\n      \n      return await apiRequest(\"POST\", \"/api/contact\", {\n        userId: user?.id,\n        name: fullName,\n        email: user?.email || \"\",\n        subject: data.subject,\n        message: data.message,\n        priority: data.priority,\n      });\n    },\n    onSuccess: () => {\n      toast({ \n        title: \"Message sent successfully!\", \n        description: \"Our support team will get back to you soon.\" \n      });\n      form.reset();\n      setSubmitted(true);\n      setTimeout(() => setSubmitted(false), 5000);\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Error sending message\", \n        description: error.message, \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const handleSubmit = (data: ContactForm) => {\n    contactMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"container max-w-4xl mx-auto p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold mb-2\">Contact Support</h1>\n        <p className=\"text-muted-foreground\">\n          Have a question or need assistance? Send us a message and our support team will help you.\n        </p>\n      </div>\n\n      {submitted && (\n        <Card className=\"border-green-500 bg-green-50 dark:bg-green-950\">\n          <CardContent className=\"flex items-center gap-3 pt-6\">\n            <CheckCircle className=\"h-6 w-6 text-green-600\" />\n            <div>\n              <p className=\"font-semibold text-green-900 dark:text-green-100\">Message Sent Successfully!</p>\n              <p className=\"text-sm text-green-700 dark:text-green-300\">We'll respond to your inquiry as soon as possible.</p>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Mail className=\"h-5 w-5\" />\n            Send a Message\n          </CardTitle>\n          <CardDescription>\n            Fill out the form below to contact our support team. We typically respond within 24 hours.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"subject\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Subject</FormLabel>\n                    <FormControl>\n                      <Input \n                        {...field} \n                        placeholder=\"Brief description of your inquiry\"\n                        data-testid=\"input-contact-subject\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"priority\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Priority</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-contact-priority\">\n                          <SelectValue placeholder=\"Select priority\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"low\">Low - General inquiry</SelectItem>\n                        <SelectItem value=\"normal\">Normal - Standard support</SelectItem>\n                        <SelectItem value=\"high\">High - Important issue</SelectItem>\n                        <SelectItem value=\"urgent\">Urgent - Critical problem</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"message\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Message</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        {...field} \n                        placeholder=\"Describe your question or issue in detail...\"\n                        rows={8}\n                        data-testid=\"input-contact-message\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"flex justify-end gap-3\">\n                <Button \n                  type=\"button\" \n                  variant=\"outline\" \n                  onClick={() => form.reset()}\n                  disabled={contactMutation.isPending}\n                  data-testid=\"button-reset-contact\"\n                >\n                  Clear\n                </Button>\n                <Button \n                  type=\"submit\" \n                  disabled={contactMutation.isPending}\n                  data-testid=\"button-submit-contact\"\n                >\n                  <Send className=\"h-4 w-4 mr-2\" />\n                  {contactMutation.isPending ? \"Sending...\" : \"Send Message\"}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Other Ways to Reach Us</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-semibold mb-1\">Email</h4>\n            <p className=\"text-sm text-muted-foreground\">support@zambajobs.com</p>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-1\">Response Time</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              We aim to respond to all inquiries within 24 hours during business days.\n              Urgent issues are prioritized and typically receive a response within 4-8 hours.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":7857,"size_tokens":null},"AI_JOB_MATCHING_EXAMPLE.md":{"content":"# AI Job Matching Example\n\nThis document demonstrates how ZambaJobs' AI-powered job matching system works with real examples.\n\n## Overview\n\nThe AI matching system uses **OpenAI's GPT-5 model** to intelligently analyze job seeker profiles against job postings. The AI considers multiple factors and provides a holistic match score from 0-100.\n\n### How It Works\n\n1. **AI-Driven Analysis**: GPT-5 evaluates the entire candidate profile (skills, experience, education, certifications, portfolio) against the job requirements\n2. **Intelligent Scoring**: The AI provides context-aware reasoning for each match, considering both explicit requirements and implicit fit\n3. **Philippine Market Context**: The AI is specifically trained to understand the Philippine job market, including local salary ranges, educational institutions, and career progression patterns\n4. **Automatic Filtering**: Only jobs with match scores above 50 are shown to job seekers\n5. **Limited Evaluation**: The system evaluates up to 10 active, unflagged jobs to balance quality and API costs\n\n### Match Score Ranges\n\n- **90-100**: Excellent match - Strong alignment across all factors\n- **70-89**: Good match - Solid fit with minor gaps\n- **51-69**: Moderate match - Some alignment but notable differences\n- **50 and below**: Poor fit - Automatically filtered out and not shown\n\n### Factors the AI Considers\n\nWhile GPT-5 makes the final determination, it typically evaluates:\n- Skills alignment with job requirements\n- Relevant work experience in similar roles/industries  \n- Educational background matching job needs\n- Professional certifications\n- Portfolio/resume presence (shows professionalism)\n- Location compatibility\n- Career progression and growth potential\n\n**Note:** These factors don't have fixed weights. The AI dynamically weighs them based on the specific job and candidate context.\n\n---\n\n## Example 1: High Match Score (85-95)\n\n### Job Seeker Profile\n\n**Basic Information:**\n- Name: Maria Santos\n- Location: Manila, Philippines\n- Headline: \"Full Stack Developer with 5 years experience in React and Node.js\"\n- Bio: \"Experienced full stack developer specializing in React, Node.js, and PostgreSQL. Strong background in building scalable web applications for fintech and e-commerce.\"\n\n**Skills:**\n- React\n- Node.js\n- TypeScript\n- PostgreSQL\n- Express.js\n- REST APIs\n- Git\n- AWS\n\n**Work Experience:**\n1. **Senior Full Stack Developer** at Tech Solutions Inc. (2020-Present)\n   - Led development of enterprise web applications using React and Node.js\n   - Implemented microservices architecture with Express.js and PostgreSQL\n   - Mentored junior developers on TypeScript best practices\n\n2. **Full Stack Developer** at Digital Innovations Corp. (2018-2020)\n   - Built responsive web applications using React and Node.js\n   - Developed RESTful APIs serving 100k+ daily active users\n   - Optimized database queries reducing response times by 40%\n\n**Education:**\n- Bachelor of Science in Computer Science\n- University of the Philippines, 2018\n\n**Certifications:**\n- AWS Certified Developer - Associate (2022)\n- MongoDB Certified Developer (2021)\n\n**Additional:**\n- Has Resume: ✓\n- Portfolio: https://mariasantos.dev\n- LinkedIn: https://linkedin.com/in/mariasantos\n\n---\n\n### Job Posting\n\n**Title:** Full Stack Developer\n\n**Company:** StartupHub Philippines\n\n**Location:** Makati, Metro Manila\n\n**Job Type:** Full-time\n\n**Salary Range:** ₱80,000 - ₱120,000/month\n\n**Description:**\nWe are seeking an experienced Full Stack Developer to join our growing team. You will work on cutting-edge web applications using modern technologies, collaborate with cross-functional teams, and help shape our technical direction.\n\n**Requirements:**\n- 5+ years of experience with React and Node.js\n- Strong TypeScript skills\n- Experience with PostgreSQL or similar relational databases\n- Knowledge of REST API design and implementation\n- Experience with cloud platforms (AWS, GCP, or Azure)\n- Strong problem-solving and communication skills\n- Bachelor's degree in Computer Science or related field\n\n**Responsibilities:**\n- Design and develop scalable web applications\n- Write clean, maintainable code following best practices\n- Collaborate with product team on feature development\n- Participate in code reviews and mentoring\n- Optimize application performance and scalability\n\n**Skills Required:**\n- React\n- Node.js\n- TypeScript\n- PostgreSQL\n- REST APIs\n- Git\n\n---\n\n### AI Match Analysis\n\n**Match Score:** 92/100 (Excellent Match)\n\n**AI Reasoning:**\n\n\"This is an excellent match between the candidate and the job posting. Here's why:\n\n**Skills Alignment (95%):** The candidate's skillset perfectly aligns with the job requirements. They have strong expertise in React, Node.js, TypeScript, PostgreSQL, Express.js, and REST APIs - all of which are explicitly required or mentioned in the job posting.\n\n**Work Experience (90%):** With 5+ years of full stack development experience, the candidate meets the experience requirement. Their current role as Senior Full Stack Developer at Tech Solutions Inc. demonstrates relevant experience building enterprise web applications with the exact tech stack mentioned in the job posting. Previous role shows progression and scaling experience.\n\n**Education (100%):** Bachelor's degree in Computer Science from University of the Philippines fully meets the educational requirement.\n\n**Certifications (80%):** AWS Certified Developer certification shows cloud platform expertise, which is listed as a requirement. The MongoDB certification, while not directly required, demonstrates commitment to continuous learning.\n\n**Portfolio & Professional Presence (95%):** Having a portfolio website and resume demonstrates professionalism and provides tangible evidence of work quality. The LinkedIn profile adds credibility.\n\n**Location Compatibility (100%):** Candidate is based in Manila, and the job is in Makati (Metro Manila area), making this a perfect location match with minimal commute.\n\n**Career Growth Alignment (90%):** The candidate's progression from Full Stack Developer to Senior Full Stack Developer shows career growth. This role at a startup would provide leadership opportunities and align with their experience level.\n\n**Overall Assessment:** This candidate is exceptionally well-suited for this position. Their technical expertise, experience level, educational background, and professional certifications all strongly align with the job requirements. The location match is ideal, and they demonstrate professionalism through their portfolio and certifications. I would highly recommend proceeding with this candidate.\"\n\n---\n\n## Example 2: Moderate Match Score (55-65)\n\n### Job Seeker Profile\n\n**Basic Information:**\n- Name: Juan Reyes\n- Location: Cebu City, Philippines\n- Headline: \"Junior Web Developer\"\n- Bio: \"Recent computer science graduate passionate about web development. Completed several personal projects using HTML, CSS, JavaScript, and PHP.\"\n\n**Skills:**\n- HTML\n- CSS\n- JavaScript\n- PHP\n- MySQL\n- jQuery\n- Bootstrap\n\n**Work Experience:**\n1. **Web Developer Intern** at Local Web Agency (2023, 6 months)\n   - Assisted in developing WordPress websites\n   - Fixed bugs and implemented minor features\n   - Learned basic version control with Git\n\n**Education:**\n- Bachelor of Science in Computer Science\n- University of San Carlos, 2023\n\n**Certifications:**\n- None\n\n**Additional:**\n- Has Resume: ✓\n- No Portfolio\n- No LinkedIn\n\n---\n\n### Job Posting\n(Same Full Stack Developer position as Example 1)\n\n---\n\n### AI Match Analysis\n\n**Match Score:** 58/100 (Moderate Match)\n\n**AI Reasoning:**\n\n\"This is a moderate match with significant gaps:\n\n**Skills Alignment (40%):** Limited alignment. The candidate knows JavaScript, which is foundational, but lacks experience with React, Node.js, TypeScript, and PostgreSQL - all core requirements. Their PHP and MySQL experience shows database understanding but not with the required stack.\n\n**Work Experience (30%):** The candidate has only 6 months of internship experience, far below the 5+ years requirement. The WordPress focus is different from the enterprise web application development mentioned in the job posting.\n\n**Education (100%):** Computer Science degree meets the educational requirement.\n\n**Certifications (0%):** No relevant certifications. Missing the AWS or cloud platform certifications that would strengthen the application.\n\n**Portfolio & Professional Presence (40%):** Has a resume but lacks portfolio and LinkedIn presence, which reduces ability to demonstrate capabilities.\n\n**Location Compatibility (60%):** Cebu City to Makati requires relocation. While both are in the Philippines, this represents a significant life change.\n\n**Career Growth Alignment (50%):** The candidate shows potential and has the foundational education. However, the experience gap is substantial. This would be a very large step up from an internship role.\n\n**Overall Assessment:** While this candidate has the educational foundation and some basic web development skills, they lack the required experience level and specific technical expertise. This position requires 5+ years with the React/Node.js stack, and the candidate is just starting their career. They would be better suited for a junior developer position focused on learning these technologies, rather than this senior-level role. Not recommended for this specific position, but could be considered for a junior role.\"\n\n---\n\n**Note on Filtered Matches:** Job seekers will never see recommendations with match scores of 50 or below. Only jobs with scores above 50 are shown, ensuring that only relevant opportunities are presented.\n\n## How the Matching Works\n\n### API Endpoint\n\n**GET /api/jobs/recommended**\n- Requires: Job Seeker authentication\n- Returns: Array of jobs with AI match scores\n- Filters: Only jobs with score > 50 (above 50)\n- Sorting: Descending by match score\n\n### Response Format\n\n```json\n[\n  {\n    \"id\": \"job-123\",\n    \"title\": \"Full Stack Developer\",\n    \"company\": \"StartupHub Philippines\",\n    \"location\": \"Makati, Metro Manila\",\n    \"description\": \"...\",\n    \"requirements\": [\"5+ years experience...\", \"...\"],\n    \"skills\": [\"React\", \"Node.js\", \"TypeScript\", \"PostgreSQL\"],\n    \"jobType\": \"Full-time\",\n    \"salaryMin\": 80000,\n    \"salaryMax\": 120000,\n    \"aiMatchScore\": 92,\n    \"isActive\": true,\n    \"createdAt\": \"2025-01-15T10:30:00Z\"\n  },\n  {\n    \"id\": \"job-456\",\n    \"title\": \"Backend Node.js Developer\",\n    \"company\": \"Tech Corp\",\n    \"location\": \"Quezon City\",\n    \"aiMatchScore\": 78,\n    ...\n  }\n]\n```\n\n### What the AI Evaluates\n\nThe GPT-5 model intelligently evaluates multiple factors and provides holistic, context-aware scoring. While it doesn't use fixed weights, it typically considers:\n\n1. **Skills & Technical Expertise**\n   - Exact skill matches with job requirements\n   - Related and transferable skills\n   - Depth of technical knowledge\n\n2. **Work Experience**\n   - Years of relevant experience\n   - Similar roles and responsibilities\n   - Industry alignment\n   - Career progression patterns\n\n3. **Educational Background**\n   - Degree level and field of study\n   - Institution relevance\n   - Alignment with job requirements\n\n4. **Professional Certifications**\n   - Industry-recognized credentials\n   - Technology-specific certifications\n   - Recency and relevance\n\n5. **Professional Presence**\n   - Resume availability (signals professionalism)\n   - Portfolio quality\n   - LinkedIn profile completeness\n\n6. **Location Factors**\n   - Geographic compatibility\n   - Commute feasibility\n   - Remote work considerations\n\n7. **Career Fit & Growth**\n   - Natural career progression\n   - Learning opportunity alignment\n   - Long-term fit potential\n\n**Important:** The AI dynamically weighs these factors based on each specific job's requirements and context, rather than using predetermined fixed weights. This allows for more nuanced and accurate matching.\n\n---\n\n## Testing the Matching System\n\n### Manual Test via API\n\n1. Create a complete job seeker profile (see Example 1)\n2. Create a job posting (see Example 1)\n3. Authenticate as the job seeker\n4. Call: `GET /api/jobs/recommended`\n5. Verify the created job appears with a high match score (> 70)\n\n### Expected Behavior\n\n- **Job Evaluation Limit**: The system evaluates up to 10 active, unflagged jobs to balance match quality with API costs\n- **Automatic Filtering**: Only jobs with match scores above 50 are returned (scores of 50 or below are filtered out)\n- **Intelligent Sorting**: Results are sorted by match score in descending order (highest matches first)\n- **Match Quality Distribution**:\n  - High-quality matches (70-100) appear at the top\n  - Moderate matches (51-69) appear below\n  - Poor matches (50 and below) are completely filtered out\n\n**Note:** If there are more than 10 active jobs in the system, only the first 10 are evaluated. This ensures fast response times while still providing quality recommendations.\n\n---\n\n## Philippine Job Market Context\n\nThe AI is specifically trained for the Philippine job market and considers:\n\n- Local salary ranges (in Philippine Pesos)\n- Philippine educational institutions\n- Regional location preferences (Metro Manila, Cebu, Davao, etc.)\n- Common job titles and industry terminology used in the Philippines\n- Work culture and career progression patterns\n- Remote work trends in the Philippine tech industry\n\nThis context ensures more accurate and relevant matching for Filipino job seekers and employers.\n","path":null,"size_bytes":13480,"size_tokens":null}},"version":2}